{"ast":null,"code":"import \"core-js/modules/web.url\";\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _typeof from '@babel/runtime/helpers/typeof';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { v4 } from 'uuid';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport dayjs from 'dayjs';\nimport en from 'dayjs/locale/en';\nimport { equals, clone, indexBy, prop, pipe, map, filter, reduce, minBy, maxBy, flatten, fromPairs, pluck, mergeDeepLeft, mergeAll, uniq, dropLast, groupBy, unnest as unnest$1 } from 'ramda';\nimport fetch from 'cross-fetch';\nimport 'url-search-params-polyfill';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _wrapNativeSuper from '@babel/runtime/helpers/wrapNativeSuper';\nvar _excluded$2 = [\"query\"];\n\nfunction ownKeys$3(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$3(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$3(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$3(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar DEFAULT_GRANULARITY = 'day';\nvar GRANULARITIES = [{\n  name: undefined,\n  title: 'w/o grouping'\n}, {\n  name: 'second',\n  title: 'Second'\n}, {\n  name: 'minute',\n  title: 'Minute'\n}, {\n  name: 'hour',\n  title: 'Hour'\n}, {\n  name: 'day',\n  title: 'Day'\n}, {\n  name: 'week',\n  title: 'Week'\n}, {\n  name: 'month',\n  title: 'Month'\n}, {\n  name: 'year',\n  title: 'Year'\n}];\n\nfunction areQueriesEqual() {\n  var query1 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var query2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return equals(Object.entries(query1 && query1.order || {}), Object.entries(query2 && query2.order || {})) && equals(query1, query2);\n}\n\nfunction defaultOrder(query) {\n  var granularity = (query.timeDimensions || []).find(function (d) {\n    return d.granularity;\n  });\n\n  if (granularity) {\n    return _defineProperty({}, granularity.dimension, 'asc');\n  } else if ((query.measures || []).length > 0 && (query.dimensions || []).length > 0) {\n    return _defineProperty({}, query.measures[0], 'desc');\n  } else if ((query.dimensions || []).length > 0) {\n    return _defineProperty({}, query.dimensions[0], 'asc');\n  }\n\n  return {};\n}\n\nfunction defaultHeuristics(newState) {\n  var oldQuery = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var options = arguments.length > 2 ? arguments[2] : undefined;\n\n  var _clone = clone(newState),\n      query = _clone.query,\n      props = _objectWithoutProperties(_clone, _excluded$2);\n\n  var meta = options.meta,\n      sessionGranularity = options.sessionGranularity;\n  var granularity = sessionGranularity || DEFAULT_GRANULARITY;\n\n  var state = _objectSpread$3({\n    query: query\n  }, props);\n\n  var newQuery = null;\n\n  if (!areQueriesEqual(query, oldQuery)) {\n    newQuery = query;\n  }\n\n  if (Array.isArray(newQuery) || Array.isArray(oldQuery)) {\n    return newState;\n  }\n\n  if (newQuery) {\n    if ((oldQuery.timeDimensions || []).length === 1 && (newQuery.timeDimensions || []).length === 1 && newQuery.timeDimensions[0].granularity && oldQuery.timeDimensions[0].granularity !== newQuery.timeDimensions[0].granularity) {\n      state = _objectSpread$3(_objectSpread$3({}, state), {}, {\n        sessionGranularity: newQuery.timeDimensions[0].granularity\n      });\n    }\n\n    if ((oldQuery.measures || []).length === 0 && (newQuery.measures || []).length > 0 || (oldQuery.measures || []).length === 1 && (newQuery.measures || []).length === 1 && oldQuery.measures[0] !== newQuery.measures[0]) {\n      var _ref4 = newQuery.timeDimensions || [],\n          _ref5 = _slicedToArray(_ref4, 1),\n          td = _ref5[0];\n\n      var defaultTimeDimension = meta.defaultTimeDimensionNameFor(newQuery.measures[0]);\n      newQuery = _objectSpread$3(_objectSpread$3({}, newQuery), {}, {\n        timeDimensions: defaultTimeDimension ? [{\n          dimension: defaultTimeDimension,\n          granularity: td && td.granularity || granularity,\n          dateRange: td && td.dateRange\n        }] : []\n      });\n      return _objectSpread$3(_objectSpread$3({}, state), {}, {\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        chartType: defaultTimeDimension ? 'line' : 'number'\n      });\n    }\n\n    if ((oldQuery.dimensions || []).length === 0 && (newQuery.dimensions || []).length > 0) {\n      newQuery = _objectSpread$3(_objectSpread$3({}, newQuery), {}, {\n        timeDimensions: (newQuery.timeDimensions || []).map(function (td) {\n          return _objectSpread$3(_objectSpread$3({}, td), {}, {\n            granularity: undefined\n          });\n        })\n      });\n      return _objectSpread$3(_objectSpread$3({}, state), {}, {\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        chartType: 'table'\n      });\n    }\n\n    if ((oldQuery.dimensions || []).length > 0 && (newQuery.dimensions || []).length === 0) {\n      newQuery = _objectSpread$3(_objectSpread$3({}, newQuery), {}, {\n        timeDimensions: (newQuery.timeDimensions || []).map(function (td) {\n          return _objectSpread$3(_objectSpread$3({}, td), {}, {\n            granularity: td.granularity || granularity\n          });\n        })\n      });\n      return _objectSpread$3(_objectSpread$3({}, state), {}, {\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        chartType: (newQuery.timeDimensions || []).length ? 'line' : 'number'\n      });\n    }\n\n    if (((oldQuery.dimensions || []).length > 0 || (oldQuery.measures || []).length > 0) && (newQuery.dimensions || []).length === 0 && (newQuery.measures || []).length === 0) {\n      newQuery = _objectSpread$3(_objectSpread$3({}, newQuery), {}, {\n        timeDimensions: [],\n        filters: []\n      });\n      return _objectSpread$3(_objectSpread$3({}, state), {}, {\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        sessionGranularity: null\n      });\n    }\n\n    return state;\n  }\n\n  if (state.chartType) {\n    var newChartType = state.chartType;\n\n    if ((newChartType === 'line' || newChartType === 'area') && (oldQuery.timeDimensions || []).length === 1 && !oldQuery.timeDimensions[0].granularity) {\n      var _oldQuery$timeDimensi = _slicedToArray(oldQuery.timeDimensions, 1),\n          _td = _oldQuery$timeDimensi[0];\n\n      return _objectSpread$3(_objectSpread$3({}, state), {}, {\n        pivotConfig: null,\n        query: _objectSpread$3(_objectSpread$3({}, oldQuery), {}, {\n          timeDimensions: [_objectSpread$3(_objectSpread$3({}, _td), {}, {\n            granularity: granularity\n          })]\n        })\n      });\n    }\n\n    if ((newChartType === 'pie' || newChartType === 'table' || newChartType === 'number') && (oldQuery.timeDimensions || []).length === 1 && oldQuery.timeDimensions[0].granularity) {\n      var _oldQuery$timeDimensi2 = _slicedToArray(oldQuery.timeDimensions, 1),\n          _td2 = _oldQuery$timeDimensi2[0];\n\n      return _objectSpread$3(_objectSpread$3({}, state), {}, {\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: _objectSpread$3(_objectSpread$3({}, oldQuery), {}, {\n          timeDimensions: [_objectSpread$3(_objectSpread$3({}, _td2), {}, {\n            granularity: undefined\n          })]\n        })\n      });\n    }\n  }\n\n  return state;\n}\n\nfunction isQueryPresent(query) {\n  if (!query) {\n    return false;\n  }\n\n  return (Array.isArray(query) ? query : [query]).every(function (q) {\n    return q.measures && q.measures.length || q.dimensions && q.dimensions.length || q.timeDimensions && q.timeDimensions.length;\n  });\n}\n\nfunction movePivotItem(pivotConfig, sourceIndex, destinationIndex, sourceAxis, destinationAxis) {\n  var nextPivotConfig = _objectSpread$3(_objectSpread$3({}, pivotConfig), {}, {\n    x: _toConsumableArray(pivotConfig.x),\n    y: _toConsumableArray(pivotConfig.y)\n  });\n\n  var id = pivotConfig[sourceAxis][sourceIndex];\n  var lastIndex = nextPivotConfig[destinationAxis].length - 1;\n\n  if (id === 'measures') {\n    destinationIndex = lastIndex + 1;\n  } else if (destinationIndex >= lastIndex && nextPivotConfig[destinationAxis][lastIndex] === 'measures') {\n    destinationIndex = lastIndex - 1;\n  }\n\n  nextPivotConfig[sourceAxis].splice(sourceIndex, 1);\n  nextPivotConfig[destinationAxis].splice(destinationIndex, 0, id);\n  return nextPivotConfig;\n}\n\nfunction moveItemInArray(list, sourceIndex, destinationIndex) {\n  var result = _toConsumableArray(list);\n\n  var _result$splice = result.splice(sourceIndex, 1),\n      _result$splice2 = _slicedToArray(_result$splice, 1),\n      removed = _result$splice2[0];\n\n  result.splice(destinationIndex, 0, removed);\n  return result;\n}\n\nfunction flattenFilters() {\n  var filters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  return filters.reduce(function (memo, filter) {\n    if (filter.or || filter.and) {\n      return [].concat(_toConsumableArray(memo), _toConsumableArray(flattenFilters(filter.or || filter.and)));\n    }\n\n    return [].concat(_toConsumableArray(memo), [filter]);\n  }, []);\n}\n\nfunction getQueryMembers() {\n  var query = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var keys = ['measures', 'dimensions', 'segments'];\n  var members = new Set();\n  keys.forEach(function (key) {\n    return (query[key] || []).forEach(function (member) {\n      return members.add(member);\n    });\n  });\n  (query.timeDimensions || []).forEach(function (td) {\n    return members.add(td.dimension);\n  });\n  flattenFilters(query.filters).forEach(function (filter) {\n    return members.add(filter.dimension || filter.member);\n  });\n  return _toConsumableArray(members);\n}\n\nfunction getOrderMembersFromOrder(orderMembers, order) {\n  var ids = new Set();\n  var indexedOrderMembers = indexBy(prop('id'), orderMembers);\n  var entries = Array.isArray(order) ? order : Object.entries(order || {});\n  var nextOrderMembers = [];\n  entries.forEach(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        memberId = _ref7[0],\n        currentOrder = _ref7[1];\n\n    if (currentOrder !== 'none' && indexedOrderMembers[memberId]) {\n      ids.add(memberId);\n      nextOrderMembers.push(_objectSpread$3(_objectSpread$3({}, indexedOrderMembers[memberId]), {}, {\n        order: currentOrder\n      }));\n    }\n  });\n  orderMembers.forEach(function (member) {\n    if (!ids.has(member.id)) {\n      nextOrderMembers.push(_objectSpread$3(_objectSpread$3({}, member), {}, {\n        order: member.order || 'none'\n      }));\n    }\n  });\n  return nextOrderMembers;\n}\n\nfunction aliasSeries(values, index, pivotConfig, duplicateMeasures) {\n  var nonNullValues = values.filter(function (value) {\n    return value != null;\n  });\n\n  if (pivotConfig && pivotConfig.aliasSeries && pivotConfig.aliasSeries[index]) {\n    return [pivotConfig.aliasSeries[index]].concat(_toConsumableArray(nonNullValues));\n  } else if (duplicateMeasures.has(nonNullValues[0])) {\n    return [index].concat(_toConsumableArray(nonNullValues));\n  }\n\n  return nonNullValues;\n}\n\nvar _excluded$1 = [\"x\"],\n    _excluded2 = [\"key\"],\n    _excluded3 = [\"title\", \"shortTitle\"];\n\nfunction ownKeys$2(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$2(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$2(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\ndayjs.locale(_objectSpread$2(_objectSpread$2({}, en), {}, {\n  weekStart: 1\n}));\nvar TIME_SERIES = {\n  day: function day(range) {\n    return range.by('d').map(function (d) {\n      return d.format('YYYY-MM-DDT00:00:00.000');\n    });\n  },\n  month: function month(range) {\n    return range.snapTo('month').by('M').map(function (d) {\n      return d.format('YYYY-MM-01T00:00:00.000');\n    });\n  },\n  year: function year(range) {\n    return range.snapTo('year').by('y').map(function (d) {\n      return d.format('YYYY-01-01T00:00:00.000');\n    });\n  },\n  hour: function hour(range) {\n    return range.by('h').map(function (d) {\n      return d.format('YYYY-MM-DDTHH:00:00.000');\n    });\n  },\n  minute: function minute(range) {\n    return range.by('m').map(function (d) {\n      return d.format('YYYY-MM-DDTHH:mm:00.000');\n    });\n  },\n  second: function second(range) {\n    return range.by('s').map(function (d) {\n      return d.format('YYYY-MM-DDTHH:mm:ss.000');\n    });\n  },\n  week: function week(range) {\n    return range.snapTo('week').by('w').map(function (d) {\n      return d.startOf('week').format('YYYY-MM-DDT00:00:00.000');\n    });\n  }\n};\nvar DateRegex = /^\\d\\d\\d\\d-\\d\\d-\\d\\d$/;\nvar LocalDateRegex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}Z?$/;\n\nvar groupByToPairs = function groupByToPairs(keyFn) {\n  var acc = new Map();\n  return function (data) {\n    data.forEach(function (row) {\n      var key = keyFn(row);\n\n      if (!acc.has(key)) {\n        acc.set(key, []);\n      }\n\n      acc.get(key).push(row);\n    });\n    return Array.from(acc.entries());\n  };\n};\n\nvar unnest = function unnest(arr) {\n  var res = [];\n  arr.forEach(function (subArr) {\n    subArr.forEach(function (element) {\n      return res.push(element);\n    });\n  });\n  return res;\n};\n\nvar dayRange = function dayRange(from, to) {\n  return {\n    by: function by(value) {\n      var results = [];\n      var start = dayjs(from);\n      var end = dayjs(to);\n\n      while (start.isBefore(end) || start.isSame(end)) {\n        results.push(start);\n        start = start.add(1, value);\n      }\n\n      return results;\n    },\n    snapTo: function snapTo(value) {\n      return dayRange(dayjs(from).startOf(value), dayjs(to).endOf(value));\n    },\n    start: dayjs(from),\n    end: dayjs(to)\n  };\n};\n\nvar QUERY_TYPE = {\n  REGULAR_QUERY: 'regularQuery',\n  COMPARE_DATE_RANGE_QUERY: 'compareDateRangeQuery',\n  BLENDING_QUERY: 'blendingQuery'\n};\n\nvar ResultSet = /*#__PURE__*/function () {\n  function ResultSet(loadResponse) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, ResultSet);\n\n    this.loadResponse = loadResponse;\n\n    if (this.loadResponse.queryType != null) {\n      this.queryType = loadResponse.queryType;\n      this.loadResponses = loadResponse.results;\n    } else {\n      this.queryType = QUERY_TYPE.REGULAR_QUERY;\n      this.loadResponse.pivotQuery = _objectSpread$2(_objectSpread$2({}, loadResponse.query), {}, {\n        queryType: this.queryType\n      });\n      this.loadResponses = [loadResponse];\n    }\n\n    if (!Object.values(QUERY_TYPE).includes(this.queryType)) {\n      throw new Error('Unknown query type');\n    }\n\n    this.parseDateMeasures = options.parseDateMeasures;\n    this.options = options;\n    this.backwardCompatibleData = [];\n  }\n\n  _createClass(ResultSet, [{\n    key: \"drillDown\",\n    value: function drillDown(drillDownLocator, pivotConfig) {\n      if (this.queryType === QUERY_TYPE.COMPARE_DATE_RANGE_QUERY) {\n        throw new Error('compareDateRange drillDown query is not currently supported');\n      }\n\n      if (this.queryType === QUERY_TYPE.BLENDING_QUERY) {\n        throw new Error('Data blending drillDown query is not currently supported');\n      }\n\n      var _drillDownLocator$xVa = drillDownLocator.xValues,\n          xValues = _drillDownLocator$xVa === void 0 ? [] : _drillDownLocator$xVa,\n          _drillDownLocator$yVa = drillDownLocator.yValues,\n          yValues = _drillDownLocator$yVa === void 0 ? [] : _drillDownLocator$yVa;\n      var normalizedPivotConfig = this.normalizePivotConfig(pivotConfig);\n      var values = [];\n      normalizedPivotConfig.x.forEach(function (member, currentIndex) {\n        return values.push([member, xValues[currentIndex]]);\n      });\n      normalizedPivotConfig.y.forEach(function (member, currentIndex) {\n        return values.push([member, yValues[currentIndex]]);\n      });\n\n      var _this$query = this.query(),\n          _this$query$filters = _this$query.filters,\n          parentFilters = _this$query$filters === void 0 ? [] : _this$query$filters,\n          _this$query$segments = _this$query.segments,\n          segments = _this$query$segments === void 0 ? [] : _this$query$segments;\n\n      var measures = this.loadResponses[0].annotation.measures;\n\n      var _ref = values.find(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 1),\n            member = _ref4[0];\n\n        return member === 'measures';\n      }) || [],\n          _ref2 = _slicedToArray(_ref, 2),\n          measureName = _ref2[1];\n\n      if (measureName === undefined) {\n        var _Object$keys = Object.keys(measures);\n\n        var _Object$keys2 = _slicedToArray(_Object$keys, 1);\n\n        measureName = _Object$keys2[0];\n      }\n\n      if (!(measures[measureName] && measures[measureName].drillMembers || []).length) {\n        return null;\n      }\n\n      var filters = [{\n        member: measureName,\n        operator: 'measureFilter'\n      }].concat(_toConsumableArray(parentFilters));\n      var timeDimensions = [];\n      values.filter(function (_ref5) {\n        var _ref6 = _slicedToArray(_ref5, 1),\n            member = _ref6[0];\n\n        return member !== 'measures';\n      }).forEach(function (_ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n            member = _ref8[0],\n            value = _ref8[1];\n\n        var _member$split = member.split('.'),\n            _member$split2 = _slicedToArray(_member$split, 3),\n            cubeName = _member$split2[0],\n            dimension = _member$split2[1],\n            granularity = _member$split2[2];\n\n        if (granularity !== undefined) {\n          var range = dayRange(value, value).snapTo(granularity);\n          timeDimensions.push({\n            dimension: [cubeName, dimension].join('.'),\n            dateRange: [range.start, range.end].map(function (dt) {\n              return dt.format('YYYY-MM-DDTHH:mm:ss.SSS');\n            })\n          });\n        } else if (value == null) {\n          filters.push({\n            member: member,\n            operator: 'notSet'\n          });\n        } else {\n          filters.push({\n            member: member,\n            operator: 'equals',\n            values: [value.toString()]\n          });\n        }\n      });\n      var query = this.loadResponses[0].query;\n\n      if (timeDimensions.length === 0 && query.timeDimensions.length > 0 && query.timeDimensions[0].granularity == null) {\n        timeDimensions.push(query.timeDimensions[0]);\n      }\n\n      return _objectSpread$2(_objectSpread$2(_objectSpread$2({}, measures[measureName].drillMembersGrouped), {}, {\n        filters: filters\n      }, segments.length > 0 ? {\n        segments: segments\n      } : {}), {}, {\n        timeDimensions: timeDimensions,\n        segments: segments,\n        timezone: query.timezone\n      });\n    }\n  }, {\n    key: \"series\",\n    value: function series(pivotConfig) {\n      var _this = this;\n\n      return this.seriesNames(pivotConfig).map(function (_ref9) {\n        var title = _ref9.title,\n            key = _ref9.key;\n        return {\n          title: title,\n          key: key,\n          series: _this.chartPivot(pivotConfig).map(function (_ref10) {\n            var x = _ref10.x,\n                obj = _objectWithoutProperties(_ref10, _excluded$1);\n\n            return {\n              value: obj[key],\n              x: x\n            };\n          })\n        };\n      });\n    }\n  }, {\n    key: \"axisValues\",\n    value: function axisValues(axis) {\n      var resultIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var query = this.loadResponses[resultIndex].query;\n      return function (row) {\n        var value = function value(measure) {\n          return axis.filter(function (d) {\n            return d !== 'measures';\n          }).map(function (d) {\n            return row[d] != null ? row[d] : null;\n          }).concat(measure ? [measure] : []);\n        };\n\n        if (axis.find(function (d) {\n          return d === 'measures';\n        }) && (query.measures || []).length) {\n          return query.measures.map(value);\n        }\n\n        return [value()];\n      };\n    }\n  }, {\n    key: \"axisValuesString\",\n    value: function axisValuesString(axisValues, delimiter) {\n      var formatValue = function formatValue(v) {\n        if (v == null) {\n          return '∅';\n        } else if (v === '') {\n          return '[Empty string]';\n        } else {\n          return v;\n        }\n      };\n\n      return axisValues.map(formatValue).join(delimiter || ', ');\n    }\n  }, {\n    key: \"normalizePivotConfig\",\n    value: function normalizePivotConfig(pivotConfig) {\n      return ResultSet.getNormalizedPivotConfig(this.loadResponse.pivotQuery, pivotConfig);\n    }\n  }, {\n    key: \"timeSeries\",\n    value: function timeSeries(timeDimension, resultIndex) {\n      if (!timeDimension.granularity) {\n        return null;\n      }\n\n      var dateRange = timeDimension.dateRange;\n\n      if (!dateRange) {\n        var member = ResultSet.timeDimensionMember(timeDimension);\n        var dates = pipe(map(function (row) {\n          return row[member] && dayjs(row[member]);\n        }), filter(Boolean))(this.timeDimensionBackwardCompatibleData(resultIndex));\n        dateRange = dates.length && [reduce(minBy(function (d) {\n          return d.toDate();\n        }), dates[0], dates), reduce(maxBy(function (d) {\n          return d.toDate();\n        }), dates[0], dates)] || null;\n      }\n\n      if (!dateRange) {\n        return null;\n      }\n\n      var padToDay = timeDimension.dateRange ? timeDimension.dateRange.find(function (d) {\n        return d.match(DateRegex);\n      }) : !['hour', 'minute', 'second'].includes(timeDimension.granularity);\n\n      var _dateRange = dateRange,\n          _dateRange2 = _slicedToArray(_dateRange, 2),\n          start = _dateRange2[0],\n          end = _dateRange2[1];\n\n      var range = dayRange(start, end);\n\n      if (!TIME_SERIES[timeDimension.granularity]) {\n        throw new Error(\"Unsupported time granularity: \".concat(timeDimension.granularity));\n      }\n\n      return TIME_SERIES[timeDimension.granularity](padToDay ? range.snapTo('d') : range);\n    }\n  }, {\n    key: \"pivot\",\n    value: function pivot(pivotConfig) {\n      var _this2 = this;\n\n      pivotConfig = this.normalizePivotConfig(pivotConfig);\n      var query = this.loadResponse.pivotQuery;\n\n      var pivotImpl = function pivotImpl() {\n        var resultIndex = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        var groupByXAxis = groupByToPairs(function (_ref11) {\n          var xValues = _ref11.xValues;\n          return _this2.axisValuesString(xValues);\n        });\n\n        var measureValue = function measureValue(row, measure) {\n          return row[measure];\n        };\n\n        if (pivotConfig.fillMissingDates && pivotConfig.x.length === 1 && equals(pivotConfig.x, (query.timeDimensions || []).filter(function (td) {\n          return Boolean(td.granularity);\n        }).map(function (td) {\n          return ResultSet.timeDimensionMember(td);\n        }))) {\n          var series = _this2.loadResponses.map(function (loadResponse) {\n            return _this2.timeSeries(loadResponse.query.timeDimensions[0], resultIndex);\n          });\n\n          if (series[0]) {\n            groupByXAxis = function groupByXAxis(rows) {\n              var byXValues = groupBy(function (_ref12) {\n                var xValues = _ref12.xValues;\n                return xValues[0];\n              }, rows);\n              return series[resultIndex].map(function (d) {\n                return [d, byXValues[d] || [{\n                  xValues: [d],\n                  row: {}\n                }]];\n              });\n            };\n\n            measureValue = function measureValue(row, measure) {\n              return row[measure] || 0;\n            };\n          }\n        }\n\n        var xGrouped = pipe(map(function (row) {\n          return _this2.axisValues(pivotConfig.x, resultIndex)(row).map(function (xValues) {\n            return {\n              xValues: xValues,\n              row: row\n            };\n          });\n        }), unnest, groupByXAxis)(_this2.timeDimensionBackwardCompatibleData(resultIndex));\n        var yValuesMap = {};\n        xGrouped.forEach(function (_ref13) {\n          var _ref14 = _slicedToArray(_ref13, 2),\n              rows = _ref14[1];\n\n          rows.forEach(function (_ref15) {\n            var row = _ref15.row;\n\n            _this2.axisValues(pivotConfig.y, resultIndex)(row).forEach(function (values) {\n              if (Object.keys(row).length > 0) {\n                yValuesMap[values.join()] = values;\n              }\n            });\n          });\n        });\n        var allYValues = Object.values(yValuesMap);\n        var measureOnX = Boolean(pivotConfig.x.find(function (d) {\n          return d === 'measures';\n        }));\n        return xGrouped.map(function (_ref16) {\n          var _ref17 = _slicedToArray(_ref16, 2),\n              rows = _ref17[1];\n\n          var xValues = rows[0].xValues;\n          var yGrouped = {};\n          rows.forEach(function (_ref18) {\n            var row = _ref18.row;\n\n            var arr = _this2.axisValues(pivotConfig.y, resultIndex)(row).map(function (yValues) {\n              return {\n                yValues: yValues,\n                row: row\n              };\n            });\n\n            arr.forEach(function (res) {\n              yGrouped[_this2.axisValuesString(res.yValues)] = res;\n            });\n          });\n          return {\n            xValues: xValues,\n            yValuesArray: unnest(allYValues.map(function (yValues) {\n              var measure = measureOnX ? ResultSet.measureFromAxis(xValues) : ResultSet.measureFromAxis(yValues);\n              return [[yValues, measureValue((yGrouped[_this2.axisValuesString(yValues)] || {\n                row: {}\n              }).row, measure)]];\n            }))\n          };\n        });\n      };\n\n      var pivots = this.loadResponses.length > 1 ? this.loadResponses.map(function (_, index) {\n        return pivotImpl(index);\n      }) : [];\n      return pivots.length ? this.mergePivots(pivots, pivotConfig.joinDateRange) : pivotImpl();\n    }\n  }, {\n    key: \"mergePivots\",\n    value: function mergePivots(pivots, joinDateRange) {\n      var minLengthPivot = pivots.reduce(function (memo, current) {\n        return memo != null && current.length >= memo.length ? memo : current;\n      }, null);\n      return minLengthPivot.map(function (_, index) {\n        var xValues = joinDateRange ? [pivots.map(function (pivot) {\n          return pivot[index] && pivot[index].xValues || [];\n        }).join(', ')] : minLengthPivot[index].xValues;\n        return {\n          xValues: xValues,\n          yValuesArray: unnest(pivots.map(function (pivot) {\n            return pivot[index].yValuesArray;\n          }))\n        };\n      });\n    }\n  }, {\n    key: \"pivotedRows\",\n    value: function pivotedRows(pivotConfig) {\n      // TODO\n      return this.chartPivot(pivotConfig);\n    }\n  }, {\n    key: \"chartPivot\",\n    value: function chartPivot(pivotConfig) {\n      var _this3 = this;\n\n      var validate = function validate(value) {\n        if (_this3.parseDateMeasures && LocalDateRegex.test(value)) {\n          return new Date(value);\n        } else if (!Number.isNaN(Number.parseFloat(value))) {\n          return Number.parseFloat(value);\n        }\n\n        return value;\n      };\n\n      var duplicateMeasures = new Set();\n\n      if (this.queryType === QUERY_TYPE.BLENDING_QUERY) {\n        var allMeasures = flatten(this.loadResponses.map(function (_ref19) {\n          var query = _ref19.query;\n          return query.measures;\n        }));\n        allMeasures.filter(function (e, i, a) {\n          return a.indexOf(e) !== i;\n        }).forEach(function (m) {\n          return duplicateMeasures.add(m);\n        });\n      }\n\n      return this.pivot(pivotConfig).map(function (_ref20) {\n        var xValues = _ref20.xValues,\n            yValuesArray = _ref20.yValuesArray;\n        var yValuesMap = {};\n        yValuesArray.forEach(function (_ref21, i) {\n          var _ref22 = _slicedToArray(_ref21, 2),\n              yValues = _ref22[0],\n              m = _ref22[1];\n\n          yValuesMap[_this3.axisValuesString(aliasSeries(yValues, i, pivotConfig, duplicateMeasures), ',')] = m && validate(m);\n        });\n        return _objectSpread$2({\n          x: _this3.axisValuesString(xValues, ','),\n          xValues: xValues\n        }, yValuesMap);\n      });\n    }\n  }, {\n    key: \"tablePivot\",\n    value: function tablePivot(pivotConfig) {\n      var normalizedPivotConfig = this.normalizePivotConfig(pivotConfig || {});\n      var isMeasuresPresent = normalizedPivotConfig.x.concat(normalizedPivotConfig.y).includes('measures');\n      return this.pivot(normalizedPivotConfig).map(function (_ref23) {\n        var xValues = _ref23.xValues,\n            yValuesArray = _ref23.yValuesArray;\n        return fromPairs(normalizedPivotConfig.x.map(function (key, index) {\n          return [key, xValues[index]];\n        }).concat(isMeasuresPresent ? yValuesArray.map(function (_ref24) {\n          var _ref25 = _slicedToArray(_ref24, 2),\n              yValues = _ref25[0],\n              measure = _ref25[1];\n\n          return [yValues.length ? yValues.join() : 'value', measure];\n        }) : []));\n      });\n    }\n  }, {\n    key: \"tableColumns\",\n    value: function tableColumns(pivotConfig) {\n      var normalizedPivotConfig = this.normalizePivotConfig(pivotConfig || {});\n      var annotations = pipe(pluck('annotation'), reduce(mergeDeepLeft(), {}))(this.loadResponses);\n      var flatMeta = Object.values(annotations).reduce(function (a, b) {\n        return _objectSpread$2(_objectSpread$2({}, a), b);\n      }, {});\n      var schema = {};\n\n      var extractFields = function extractFields(key) {\n        var _ref26 = flatMeta[key] || {},\n            title = _ref26.title,\n            shortTitle = _ref26.shortTitle,\n            type = _ref26.type,\n            format = _ref26.format,\n            meta = _ref26.meta;\n\n        return {\n          key: key,\n          title: title,\n          shortTitle: shortTitle,\n          type: type,\n          format: format,\n          meta: meta\n        };\n      };\n\n      var pivot = this.pivot(normalizedPivotConfig);\n      (pivot[0] && pivot[0].yValuesArray || []).forEach(function (_ref27) {\n        var _ref28 = _slicedToArray(_ref27, 1),\n            yValues = _ref28[0];\n\n        if (yValues.length > 0) {\n          var currentItem = schema;\n          yValues.forEach(function (value, index) {\n            currentItem[value] = {\n              key: value,\n              memberId: normalizedPivotConfig.y[index] === 'measures' ? value : normalizedPivotConfig.y[index],\n              children: currentItem[value] && currentItem[value].children || {}\n            };\n            currentItem = currentItem[value].children;\n          });\n        }\n      });\n\n      var toColumns = function toColumns() {\n        var item = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n        if (Object.keys(item).length === 0) {\n          return [];\n        }\n\n        return Object.values(item).map(function (_ref29) {\n          var key = _ref29.key,\n              currentItem = _objectWithoutProperties(_ref29, _excluded2);\n\n          var children = toColumns(currentItem.children, [].concat(_toConsumableArray(path), [key]));\n\n          var _extractFields = extractFields(currentItem.memberId),\n              title = _extractFields.title,\n              shortTitle = _extractFields.shortTitle,\n              fields = _objectWithoutProperties(_extractFields, _excluded3);\n\n          var dimensionValue = key !== currentItem.memberId || title == null ? key : '';\n\n          if (!children.length) {\n            return _objectSpread$2(_objectSpread$2({}, fields), {}, {\n              key: key,\n              dataIndex: [].concat(_toConsumableArray(path), [key]).join(),\n              title: [title, dimensionValue].join(' ').trim(),\n              shortTitle: dimensionValue || shortTitle\n            });\n          }\n\n          return _objectSpread$2(_objectSpread$2({}, fields), {}, {\n            key: key,\n            title: [title, dimensionValue].join(' ').trim(),\n            shortTitle: dimensionValue || shortTitle,\n            children: children\n          });\n        });\n      };\n\n      var otherColumns = [];\n\n      if (!pivot.length && normalizedPivotConfig.y.includes('measures')) {\n        otherColumns = (this.loadResponses[0].query.measures || []).map(function (key) {\n          return _objectSpread$2(_objectSpread$2({}, extractFields(key)), {}, {\n            dataIndex: key\n          });\n        });\n      } // Syntatic column to display the measure value\n\n\n      if (!normalizedPivotConfig.y.length && normalizedPivotConfig.x.includes('measures')) {\n        otherColumns.push({\n          key: 'value',\n          dataIndex: 'value',\n          title: 'Value',\n          shortTitle: 'Value',\n          type: 'string'\n        });\n      }\n\n      return normalizedPivotConfig.x.map(function (key) {\n        if (key === 'measures') {\n          return {\n            key: 'measures',\n            dataIndex: 'measures',\n            title: 'Measures',\n            shortTitle: 'Measures',\n            type: 'string'\n          };\n        }\n\n        return _objectSpread$2(_objectSpread$2({}, extractFields(key)), {}, {\n          dataIndex: key\n        });\n      }).concat(toColumns(schema)).concat(otherColumns);\n    }\n  }, {\n    key: \"totalRow\",\n    value: function totalRow(pivotConfig) {\n      return this.chartPivot(pivotConfig)[0];\n    }\n  }, {\n    key: \"categories\",\n    value: function categories(pivotConfig) {\n      // TODO\n      return this.chartPivot(pivotConfig);\n    }\n  }, {\n    key: \"seriesNames\",\n    value: function seriesNames(pivotConfig) {\n      var _this4 = this;\n\n      pivotConfig = this.normalizePivotConfig(pivotConfig);\n      var measures = pipe(pluck('annotation'), pluck('measures'), mergeAll)(this.loadResponses);\n      var seriesNames = unnest(this.loadResponses.map(function (_, index) {\n        return pipe(map(_this4.axisValues(pivotConfig.y, index)), unnest, uniq)(_this4.timeDimensionBackwardCompatibleData(index));\n      }));\n      var duplicateMeasures = new Set();\n\n      if (this.queryType === QUERY_TYPE.BLENDING_QUERY) {\n        var allMeasures = flatten(this.loadResponses.map(function (_ref30) {\n          var query = _ref30.query;\n          return query.measures;\n        }));\n        allMeasures.filter(function (e, i, a) {\n          return a.indexOf(e) !== i;\n        }).forEach(function (m) {\n          return duplicateMeasures.add(m);\n        });\n      }\n\n      return seriesNames.map(function (axisValues, i) {\n        var aliasedAxis = aliasSeries(axisValues, i, pivotConfig, duplicateMeasures);\n        return {\n          title: _this4.axisValuesString(pivotConfig.y.find(function (d) {\n            return d === 'measures';\n          }) ? dropLast(1, aliasedAxis).concat(measures[ResultSet.measureFromAxis(axisValues)].title) : aliasedAxis, ', '),\n          key: _this4.axisValuesString(aliasedAxis, ','),\n          yValues: axisValues\n        };\n      });\n    }\n  }, {\n    key: \"query\",\n    value: function query() {\n      if (this.queryType !== QUERY_TYPE.REGULAR_QUERY) {\n        throw new Error(\"Method is not supported for a '\".concat(this.queryType, \"' query type. Please use decompose\"));\n      }\n\n      return this.loadResponses[0].query;\n    }\n  }, {\n    key: \"pivotQuery\",\n    value: function pivotQuery() {\n      return this.loadResponse.pivotQuery || null;\n    }\n  }, {\n    key: \"rawData\",\n    value: function rawData() {\n      if (this.queryType !== QUERY_TYPE.REGULAR_QUERY) {\n        throw new Error(\"Method is not supported for a '\".concat(this.queryType, \"' query type. Please use decompose\"));\n      }\n\n      return this.loadResponses[0].data;\n    }\n  }, {\n    key: \"annotation\",\n    value: function annotation() {\n      if (this.queryType !== QUERY_TYPE.REGULAR_QUERY) {\n        throw new Error(\"Method is not supported for a '\".concat(this.queryType, \"' query type. Please use decompose\"));\n      }\n\n      return this.loadResponses[0].annotation;\n    }\n  }, {\n    key: \"timeDimensionBackwardCompatibleData\",\n    value: function timeDimensionBackwardCompatibleData(resultIndex) {\n      if (resultIndex === undefined) {\n        throw new Error('resultIndex is required');\n      }\n\n      if (!this.backwardCompatibleData[resultIndex]) {\n        var _this$loadResponses$r = this.loadResponses[resultIndex],\n            data = _this$loadResponses$r.data,\n            query = _this$loadResponses$r.query;\n        var timeDimensions = (query.timeDimensions || []).filter(function (td) {\n          return Boolean(td.granularity);\n        });\n        this.backwardCompatibleData[resultIndex] = data.map(function (row) {\n          return _objectSpread$2(_objectSpread$2({}, row), fromPairs(Object.keys(row).filter(function (field) {\n            return timeDimensions.find(function (d) {\n              return d.dimension === field;\n            }) && !row[ResultSet.timeDimensionMember(timeDimensions.find(function (d) {\n              return d.dimension === field;\n            }))];\n          }).map(function (field) {\n            return [ResultSet.timeDimensionMember(timeDimensions.find(function (d) {\n              return d.dimension === field;\n            })), row[field]];\n          })));\n        });\n      }\n\n      return this.backwardCompatibleData[resultIndex];\n    }\n  }, {\n    key: \"decompose\",\n    value: function decompose() {\n      var _this5 = this;\n\n      return this.loadResponses.map(function (result) {\n        return new ResultSet({\n          queryType: QUERY_TYPE.REGULAR_QUERY,\n          pivotQuery: _objectSpread$2(_objectSpread$2({}, result.query), {}, {\n            queryType: QUERY_TYPE.REGULAR_QUERY\n          }),\n          results: [result]\n        }, _this5.options);\n      });\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize() {\n      return {\n        loadResponse: clone(this.loadResponse)\n      };\n    }\n  }], [{\n    key: \"measureFromAxis\",\n    value: function measureFromAxis(axisValues) {\n      return axisValues[axisValues.length - 1];\n    }\n  }, {\n    key: \"timeDimensionMember\",\n    value: function timeDimensionMember(td) {\n      return \"\".concat(td.dimension, \".\").concat(td.granularity);\n    }\n  }, {\n    key: \"deserialize\",\n    value: function deserialize(data) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new ResultSet(data.loadResponse, options);\n    }\n  }, {\n    key: \"getNormalizedPivotConfig\",\n    value: function getNormalizedPivotConfig() {\n      var query = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var pivotConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var defaultPivotConfig = {\n        x: [],\n        y: [],\n        fillMissingDates: true,\n        joinDateRange: false\n      };\n      var _query$measures = query.measures,\n          measures = _query$measures === void 0 ? [] : _query$measures,\n          _query$dimensions = query.dimensions,\n          dimensions = _query$dimensions === void 0 ? [] : _query$dimensions;\n      var timeDimensions = (query.timeDimensions || []).filter(function (td) {\n        return !!td.granularity;\n      });\n      pivotConfig = pivotConfig || (timeDimensions.length ? {\n        x: timeDimensions.map(function (td) {\n          return ResultSet.timeDimensionMember(td);\n        }),\n        y: dimensions\n      } : {\n        x: dimensions,\n        y: []\n      });\n      pivotConfig = mergeDeepLeft(pivotConfig, defaultPivotConfig);\n\n      var substituteTimeDimensionMembers = function substituteTimeDimensionMembers(axis) {\n        return axis.map(function (subDim) {\n          return timeDimensions.find(function (td) {\n            return td.dimension === subDim;\n          }) && !dimensions.find(function (d) {\n            return d === subDim;\n          }) ? ResultSet.timeDimensionMember(query.timeDimensions.find(function (td) {\n            return td.dimension === subDim;\n          })) : subDim;\n        });\n      };\n\n      pivotConfig.x = substituteTimeDimensionMembers(pivotConfig.x);\n      pivotConfig.y = substituteTimeDimensionMembers(pivotConfig.y);\n      var allIncludedDimensions = pivotConfig.x.concat(pivotConfig.y);\n      var allDimensions = timeDimensions.map(function (td) {\n        return ResultSet.timeDimensionMember(td);\n      }).concat(dimensions);\n\n      var dimensionFilter = function dimensionFilter(key) {\n        return allDimensions.includes(key) || key === 'measures';\n      };\n\n      pivotConfig.x = pivotConfig.x.concat(allDimensions.filter(function (d) {\n        return !allIncludedDimensions.includes(d) && d !== 'compareDateRange';\n      })).filter(dimensionFilter);\n      pivotConfig.y = pivotConfig.y.filter(dimensionFilter);\n\n      if (!pivotConfig.x.concat(pivotConfig.y).find(function (d) {\n        return d === 'measures';\n      })) {\n        pivotConfig.y.push('measures');\n      }\n\n      if (dimensions.includes('compareDateRange') && !pivotConfig.y.concat(pivotConfig.x).includes('compareDateRange')) {\n        pivotConfig.y.unshift('compareDateRange');\n      }\n\n      if (!measures.length) {\n        pivotConfig.x = pivotConfig.x.filter(function (d) {\n          return d !== 'measures';\n        });\n        pivotConfig.y = pivotConfig.y.filter(function (d) {\n          return d !== 'measures';\n        });\n      }\n\n      return pivotConfig;\n    }\n  }]);\n\n  return ResultSet;\n}();\n\nvar SqlQuery = /*#__PURE__*/function () {\n  function SqlQuery(sqlQuery) {\n    _classCallCheck(this, SqlQuery);\n\n    this.sqlQuery = sqlQuery;\n  }\n\n  _createClass(SqlQuery, [{\n    key: \"rawQuery\",\n    value: function rawQuery() {\n      return this.sqlQuery.sql;\n    }\n  }, {\n    key: \"sql\",\n    value: function sql() {\n      return this.rawQuery().sql[0];\n    }\n  }]);\n\n  return SqlQuery;\n}();\n\nvar memberMap = function memberMap(memberArray) {\n  return fromPairs(memberArray.map(function (m) {\n    return [m.name, m];\n  }));\n};\n\nvar operators = {\n  string: [{\n    name: 'contains',\n    title: 'contains'\n  }, {\n    name: 'notContains',\n    title: 'does not contain'\n  }, {\n    name: 'equals',\n    title: 'equals'\n  }, {\n    name: 'notEquals',\n    title: 'does not equal'\n  }, {\n    name: 'set',\n    title: 'is set'\n  }, {\n    name: 'notSet',\n    title: 'is not set'\n  }],\n  number: [{\n    name: 'equals',\n    title: 'equals'\n  }, {\n    name: 'notEquals',\n    title: 'does not equal'\n  }, {\n    name: 'set',\n    title: 'is set'\n  }, {\n    name: 'notSet',\n    title: 'is not set'\n  }, {\n    name: 'gt',\n    title: '>'\n  }, {\n    name: 'gte',\n    title: '>='\n  }, {\n    name: 'lt',\n    title: '<'\n  }, {\n    name: 'lte',\n    title: '<='\n  }],\n  time: [{\n    name: 'equals',\n    title: 'equals'\n  }, {\n    name: 'notEquals',\n    title: 'does not equal'\n  }, {\n    name: 'inDateRange',\n    title: 'in date range'\n  }, {\n    name: 'notInDateRange',\n    title: 'not in date range'\n  }, {\n    name: 'afterDate',\n    title: 'after date'\n  }, {\n    name: 'beforeDate',\n    title: 'before date'\n  }]\n};\n/**\n * Contains information about available cubes and it's members.\n */\n\nvar Meta = /*#__PURE__*/function () {\n  function Meta(metaResponse) {\n    _classCallCheck(this, Meta);\n\n    this.meta = metaResponse;\n    var cubes = this.meta.cubes;\n    this.cubes = cubes;\n    this.cubesMap = fromPairs(cubes.map(function (c) {\n      return [c.name, {\n        measures: memberMap(c.measures),\n        dimensions: memberMap(c.dimensions),\n        segments: memberMap(c.segments)\n      }];\n    }));\n  }\n\n  _createClass(Meta, [{\n    key: \"membersForQuery\",\n    value: function membersForQuery(query, memberType) {\n      return unnest$1(this.cubes.map(function (c) {\n        return c[memberType];\n      })).sort(function (a, b) {\n        return a.title > b.title ? 1 : -1;\n      });\n    }\n  }, {\n    key: \"membersGroupedByCube\",\n    value: function membersGroupedByCube() {\n      var memberKeys = ['measures', 'dimensions', 'segments', 'timeDimensions'];\n      return this.cubes.reduce(function (memo, cube) {\n        memberKeys.forEach(function (key) {\n          var members = cube[key];\n\n          if (key === 'timeDimensions') {\n            members = cube.dimensions.filter(function (m) {\n              return m.type === 'time';\n            });\n          }\n\n          memo[key] = [].concat(_toConsumableArray(memo[key]), [{\n            cubeName: cube.name,\n            cubeTitle: cube.title,\n            members: members\n          }]);\n        });\n        return memo;\n      }, {\n        measures: [],\n        dimensions: [],\n        segments: [],\n        timeDimensions: []\n      });\n    }\n  }, {\n    key: \"resolveMember\",\n    value: function resolveMember(memberName, memberType) {\n      var _this = this;\n\n      var _memberName$split = memberName.split('.'),\n          _memberName$split2 = _slicedToArray(_memberName$split, 1),\n          cube = _memberName$split2[0];\n\n      if (!this.cubesMap[cube]) {\n        return {\n          title: memberName,\n          error: \"Cube not found \".concat(cube, \" for path '\").concat(memberName, \"'\")\n        };\n      }\n\n      var memberTypes = Array.isArray(memberType) ? memberType : [memberType];\n      var member = memberTypes.map(function (type) {\n        return _this.cubesMap[cube][type] && _this.cubesMap[cube][type][memberName];\n      }).find(function (m) {\n        return m;\n      });\n\n      if (!member) {\n        return {\n          title: memberName,\n          error: \"Path not found '\".concat(memberName, \"'\")\n        };\n      }\n\n      return member;\n    }\n  }, {\n    key: \"defaultTimeDimensionNameFor\",\n    value: function defaultTimeDimensionNameFor(memberName) {\n      var _this2 = this;\n\n      var _memberName$split3 = memberName.split('.'),\n          _memberName$split4 = _slicedToArray(_memberName$split3, 1),\n          cube = _memberName$split4[0];\n\n      if (!this.cubesMap[cube]) {\n        return null;\n      }\n\n      return Object.keys(this.cubesMap[cube].dimensions || {}).find(function (d) {\n        return _this2.cubesMap[cube].dimensions[d].type === 'time';\n      });\n    }\n  }, {\n    key: \"filterOperatorsForMember\",\n    value: function filterOperatorsForMember(memberName, memberType) {\n      var member = this.resolveMember(memberName, memberType);\n      return operators[member.type] || operators.string;\n    }\n  }]);\n\n  return Meta;\n}();\n\nvar ProgressResult = /*#__PURE__*/function () {\n  function ProgressResult(progressResponse) {\n    _classCallCheck(this, ProgressResult);\n\n    this.progressResponse = progressResponse;\n  }\n\n  _createClass(ProgressResult, [{\n    key: \"stage\",\n    value: function stage() {\n      return this.progressResponse.stage;\n    }\n  }, {\n    key: \"timeElapsed\",\n    value: function timeElapsed() {\n      return this.progressResponse.timeElapsed;\n    }\n  }]);\n\n  return ProgressResult;\n}();\n\nvar _excluded = [\"baseRequestId\"];\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$1(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$1(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar HttpTransport = /*#__PURE__*/function () {\n  function HttpTransport(_ref) {\n    var authorization = _ref.authorization,\n        apiUrl = _ref.apiUrl,\n        method = _ref.method,\n        _ref$headers = _ref.headers,\n        headers = _ref$headers === void 0 ? {} : _ref$headers,\n        credentials = _ref.credentials;\n\n    _classCallCheck(this, HttpTransport);\n\n    this.authorization = authorization;\n    this.apiUrl = apiUrl;\n    this.method = method;\n    this.headers = headers;\n    this.credentials = credentials;\n  }\n\n  _createClass(HttpTransport, [{\n    key: \"request\",\n    value: function request(method, _ref2) {\n      var _this = this;\n\n      var baseRequestId = _ref2.baseRequestId,\n          params = _objectWithoutProperties(_ref2, _excluded);\n\n      var spanCounter = 1;\n      var searchParams = new URLSearchParams(params && Object.keys(params).map(function (k) {\n        return _defineProperty({}, k, _typeof(params[k]) === 'object' ? JSON.stringify(params[k]) : params[k]);\n      }).reduce(function (a, b) {\n        return _objectSpread$1(_objectSpread$1({}, a), b);\n      }, {}));\n      var url = \"\".concat(this.apiUrl, \"/\").concat(method).concat(searchParams.toString().length ? \"?\".concat(searchParams) : '');\n      var requestMethod = this.method || (url.length < 2000 ? 'GET' : 'POST');\n\n      if (requestMethod === 'POST') {\n        url = \"\".concat(this.apiUrl, \"/\").concat(method);\n        this.headers['Content-Type'] = 'application/json';\n      } // Currently, all methods make GET requests. If a method makes a request with a body payload,\n      // remember to add {'Content-Type': 'application/json'} to the header.\n\n\n      var runRequest = function runRequest() {\n        return fetch(url, {\n          method: requestMethod,\n          headers: _objectSpread$1({\n            Authorization: _this.authorization,\n            'x-request-id': baseRequestId && \"\".concat(baseRequestId, \"-span-\").concat(spanCounter++)\n          }, _this.headers),\n          credentials: _this.credentials,\n          body: requestMethod === 'POST' ? JSON.stringify(params) : null\n        });\n      };\n\n      return {\n        subscribe: function subscribe(callback) {\n          var _this2 = this;\n\n          return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n            var result;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return runRequest();\n\n                  case 2:\n                    result = _context.sent;\n                    return _context.abrupt(\"return\", callback(result, function () {\n                      return _this2.subscribe(callback);\n                    }));\n\n                  case 4:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee);\n          }))();\n        }\n      };\n    }\n  }]);\n\n  return HttpTransport;\n}();\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar RequestError = /*#__PURE__*/function (_Error) {\n  _inherits(RequestError, _Error);\n\n  var _super = _createSuper(RequestError);\n\n  function RequestError(message, response) {\n    var _this;\n\n    _classCallCheck(this, RequestError);\n\n    _this = _super.call(this, message);\n    _this.response = response;\n    return _this;\n  }\n\n  return RequestError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar mutexCounter = 0;\nvar MUTEX_ERROR = 'Mutex has been changed';\n\nvar mutexPromise = function mutexPromise(promise) {\n  return new Promise(function (resolve, reject) {\n    promise.then(function (r) {\n      return resolve(r);\n    }, function (e) {\n      return e !== MUTEX_ERROR && reject(e);\n    });\n  });\n};\n\nvar CubejsApi = /*#__PURE__*/function () {\n  function CubejsApi(apiToken, options) {\n    _classCallCheck(this, CubejsApi);\n\n    if (_typeof(apiToken) === 'object') {\n      options = apiToken;\n      apiToken = undefined;\n    }\n\n    options = options || {};\n\n    if (!options.transport && !options.apiUrl) {\n      throw new Error('The `apiUrl` option is required');\n    }\n\n    this.apiToken = apiToken;\n    this.apiUrl = options.apiUrl;\n    this.method = options.method;\n    this.headers = options.headers || {};\n    this.credentials = options.credentials;\n    this.transport = options.transport || new HttpTransport({\n      authorization: typeof apiToken === 'function' ? undefined : apiToken,\n      apiUrl: this.apiUrl,\n      method: this.method,\n      headers: this.headers,\n      credentials: this.credentials\n    });\n    this.pollInterval = options.pollInterval || 5;\n    this.parseDateMeasures = options.parseDateMeasures;\n  }\n\n  _createClass(CubejsApi, [{\n    key: \"request\",\n    value: function request(method, params) {\n      return this.transport.request(method, _objectSpread({\n        baseRequestId: v4()\n      }, params));\n    }\n  }, {\n    key: \"loadMethod\",\n    value: function loadMethod(request, toResult, options, callback) {\n      var _this = this;\n\n      var mutexValue = ++mutexCounter;\n\n      if (typeof options === 'function' && !callback) {\n        callback = options;\n        options = undefined;\n      }\n\n      options = options || {};\n      var mutexKey = options.mutexKey || 'default';\n\n      if (options.mutexObj) {\n        options.mutexObj[mutexKey] = mutexValue;\n      }\n\n      var requestPromise = this.updateTransportAuthorization().then(function () {\n        return request();\n      });\n      var unsubscribed = false;\n\n      var checkMutex = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var requestInstance;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return requestPromise;\n\n                case 2:\n                  requestInstance = _context.sent;\n\n                  if (!(options.mutexObj && options.mutexObj[mutexKey] !== mutexValue)) {\n                    _context.next = 9;\n                    break;\n                  }\n\n                  unsubscribed = true;\n\n                  if (!requestInstance.unsubscribe) {\n                    _context.next = 8;\n                    break;\n                  }\n\n                  _context.next = 8;\n                  return requestInstance.unsubscribe();\n\n                case 8:\n                  throw MUTEX_ERROR;\n\n                case 9:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function checkMutex() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n\n      var loadImpl = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(response, next) {\n          var requestInstance, subscribeNext, continueWait, body, text, error, result;\n          return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n            while (1) {\n              switch (_context4.prev = _context4.next) {\n                case 0:\n                  _context4.next = 2;\n                  return requestPromise;\n\n                case 2:\n                  requestInstance = _context4.sent;\n\n                  subscribeNext = /*#__PURE__*/function () {\n                    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                        while (1) {\n                          switch (_context2.prev = _context2.next) {\n                            case 0:\n                              if (!(options.subscribe && !unsubscribed)) {\n                                _context2.next = 8;\n                                break;\n                              }\n\n                              if (!requestInstance.unsubscribe) {\n                                _context2.next = 5;\n                                break;\n                              }\n\n                              return _context2.abrupt(\"return\", next());\n\n                            case 5:\n                              _context2.next = 7;\n                              return new Promise(function (resolve) {\n                                return setTimeout(function () {\n                                  return resolve();\n                                }, _this.pollInterval * 1000);\n                              });\n\n                            case 7:\n                              return _context2.abrupt(\"return\", next());\n\n                            case 8:\n                              return _context2.abrupt(\"return\", null);\n\n                            case 9:\n                            case \"end\":\n                              return _context2.stop();\n                          }\n                        }\n                      }, _callee2);\n                    }));\n\n                    return function subscribeNext() {\n                      return _ref3.apply(this, arguments);\n                    };\n                  }();\n\n                  continueWait = /*#__PURE__*/function () {\n                    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(wait) {\n                      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                        while (1) {\n                          switch (_context3.prev = _context3.next) {\n                            case 0:\n                              if (unsubscribed) {\n                                _context3.next = 5;\n                                break;\n                              }\n\n                              if (!wait) {\n                                _context3.next = 4;\n                                break;\n                              }\n\n                              _context3.next = 4;\n                              return new Promise(function (resolve) {\n                                return setTimeout(function () {\n                                  return resolve();\n                                }, _this.pollInterval * 1000);\n                              });\n\n                            case 4:\n                              return _context3.abrupt(\"return\", next());\n\n                            case 5:\n                              return _context3.abrupt(\"return\", null);\n\n                            case 6:\n                            case \"end\":\n                              return _context3.stop();\n                          }\n                        }\n                      }, _callee3);\n                    }));\n\n                    return function continueWait(_x3) {\n                      return _ref4.apply(this, arguments);\n                    };\n                  }();\n\n                  _context4.next = 7;\n                  return _this.updateTransportAuthorization();\n\n                case 7:\n                  if (!(response.status === 502)) {\n                    _context4.next = 11;\n                    break;\n                  }\n\n                  _context4.next = 10;\n                  return checkMutex();\n\n                case 10:\n                  return _context4.abrupt(\"return\", continueWait(true));\n\n                case 11:\n                  body = {};\n                  text = '';\n                  _context4.prev = 13;\n                  _context4.next = 16;\n                  return response.text();\n\n                case 16:\n                  text = _context4.sent;\n                  body = JSON.parse(text);\n                  _context4.next = 23;\n                  break;\n\n                case 20:\n                  _context4.prev = 20;\n                  _context4.t0 = _context4[\"catch\"](13);\n                  body.error = text;\n\n                case 23:\n                  if (!(body.error === 'Continue wait')) {\n                    _context4.next = 28;\n                    break;\n                  }\n\n                  _context4.next = 26;\n                  return checkMutex();\n\n                case 26:\n                  if (options.progressCallback) {\n                    options.progressCallback(new ProgressResult(body));\n                  }\n\n                  return _context4.abrupt(\"return\", continueWait());\n\n                case 28:\n                  if (!(response.status !== 200)) {\n                    _context4.next = 41;\n                    break;\n                  }\n\n                  _context4.next = 31;\n                  return checkMutex();\n\n                case 31:\n                  if (!(!options.subscribe && requestInstance.unsubscribe)) {\n                    _context4.next = 34;\n                    break;\n                  }\n\n                  _context4.next = 34;\n                  return requestInstance.unsubscribe();\n\n                case 34:\n                  error = new RequestError(body.error, body); // TODO error class\n\n                  if (!callback) {\n                    _context4.next = 39;\n                    break;\n                  }\n\n                  callback(error);\n                  _context4.next = 40;\n                  break;\n\n                case 39:\n                  throw error;\n\n                case 40:\n                  return _context4.abrupt(\"return\", subscribeNext());\n\n                case 41:\n                  _context4.next = 43;\n                  return checkMutex();\n\n                case 43:\n                  if (!(!options.subscribe && requestInstance.unsubscribe)) {\n                    _context4.next = 46;\n                    break;\n                  }\n\n                  _context4.next = 46;\n                  return requestInstance.unsubscribe();\n\n                case 46:\n                  result = toResult(body);\n\n                  if (!callback) {\n                    _context4.next = 51;\n                    break;\n                  }\n\n                  callback(null, result);\n                  _context4.next = 52;\n                  break;\n\n                case 51:\n                  return _context4.abrupt(\"return\", result);\n\n                case 52:\n                  return _context4.abrupt(\"return\", subscribeNext());\n\n                case 53:\n                case \"end\":\n                  return _context4.stop();\n              }\n            }\n          }, _callee4, null, [[13, 20]]);\n        }));\n\n        return function loadImpl(_x, _x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      var promise = requestPromise.then(function (requestInstance) {\n        return mutexPromise(requestInstance.subscribe(loadImpl));\n      });\n\n      if (callback) {\n        return {\n          unsubscribe: function () {\n            var _unsubscribe = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n              var requestInstance;\n              return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                while (1) {\n                  switch (_context5.prev = _context5.next) {\n                    case 0:\n                      _context5.next = 2;\n                      return requestPromise;\n\n                    case 2:\n                      requestInstance = _context5.sent;\n                      unsubscribed = true;\n\n                      if (!requestInstance.unsubscribe) {\n                        _context5.next = 6;\n                        break;\n                      }\n\n                      return _context5.abrupt(\"return\", requestInstance.unsubscribe());\n\n                    case 6:\n                      return _context5.abrupt(\"return\", null);\n\n                    case 7:\n                    case \"end\":\n                      return _context5.stop();\n                  }\n                }\n              }, _callee5);\n            }));\n\n            function unsubscribe() {\n              return _unsubscribe.apply(this, arguments);\n            }\n\n            return unsubscribe;\n          }()\n        };\n      } else {\n        return promise;\n      }\n    }\n  }, {\n    key: \"updateTransportAuthorization\",\n    value: function () {\n      var _updateTransportAuthorization = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n        var token;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (!(typeof this.apiToken === 'function')) {\n                  _context6.next = 5;\n                  break;\n                }\n\n                _context6.next = 3;\n                return this.apiToken();\n\n              case 3:\n                token = _context6.sent;\n\n                if (this.transport.authorization !== token) {\n                  this.transport.authorization = token;\n                }\n\n              case 5:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function updateTransportAuthorization() {\n        return _updateTransportAuthorization.apply(this, arguments);\n      }\n\n      return updateTransportAuthorization;\n    }()\n  }, {\n    key: \"load\",\n    value: function load(query, options, callback) {\n      var _this2 = this;\n\n      return this.loadMethod(function () {\n        return _this2.request('load', {\n          query: query,\n          queryType: 'multi'\n        });\n      }, function (response) {\n        return new ResultSet(response, {\n          parseDateMeasures: _this2.parseDateMeasures\n        });\n      }, options, callback);\n    }\n  }, {\n    key: \"sql\",\n    value: function sql(query, options, callback) {\n      var _this3 = this;\n\n      return this.loadMethod(function () {\n        return _this3.request('sql', {\n          query: query\n        });\n      }, function (response) {\n        return Array.isArray(response) ? response.map(function (body) {\n          return new SqlQuery(body);\n        }) : new SqlQuery(response);\n      }, options, callback);\n    }\n  }, {\n    key: \"meta\",\n    value: function meta(options, callback) {\n      var _this4 = this;\n\n      return this.loadMethod(function () {\n        return _this4.request('meta');\n      }, function (body) {\n        return new Meta(body);\n      }, options, callback);\n    }\n  }, {\n    key: \"dryRun\",\n    value: function dryRun(query, options, callback) {\n      var _this5 = this;\n\n      return this.loadMethod(function () {\n        return _this5.request('dry-run', {\n          query: query\n        });\n      }, function (response) {\n        return response;\n      }, options, callback);\n    }\n  }, {\n    key: \"subscribe\",\n    value: function subscribe(query, options, callback) {\n      var _this6 = this;\n\n      return this.loadMethod(function () {\n        return _this6.request('subscribe', {\n          query: query,\n          queryType: 'multi'\n        });\n      }, function (body) {\n        return new ResultSet(body, {\n          parseDateMeasures: _this6.parseDateMeasures\n        });\n      }, _objectSpread(_objectSpread({}, options), {}, {\n        subscribe: true\n      }), callback);\n    }\n  }]);\n\n  return CubejsApi;\n}();\n\nvar index = function (apiToken, options) {\n  return new CubejsApi(apiToken, options);\n};\n\nexport default index;\nexport { CubejsApi, GRANULARITIES, HttpTransport, ResultSet, areQueriesEqual, defaultHeuristics, defaultOrder, flattenFilters, getOrderMembersFromOrder, getQueryMembers, isQueryPresent, moveItemInArray, movePivotItem };","map":{"version":3,"sources":["../src/utils.js","../src/ResultSet.js","../src/SqlQuery.js","../src/Meta.js","../src/ProgressResult.js","../src/HttpTransport.js","../src/RequestError.js","../src/index.js"],"names":["DEFAULT_GRANULARITY","GRANULARITIES","name","title","query1","query2","equals","Object","granularity","query","d","oldQuery","options","props","clone","meta","sessionGranularity","state","newQuery","areQueriesEqual","Array","td","defaultTimeDimension","timeDimensions","dimension","dateRange","pivotConfig","shouldApplyHeuristicOrder","chartType","undefined","filters","newChartType","q","nextPivotConfig","x","y","id","lastIndex","destinationIndex","result","removed","filter","flattenFilters","keys","members","ids","indexedOrderMembers","indexBy","prop","entries","order","nextOrderMembers","memberId","currentOrder","orderMembers","member","nonNullValues","value","duplicateMeasures","dayjs","weekStart","TIME_SERIES","day","month","year","hour","minute","second","week","DateRegex","LocalDateRegex","groupByToPairs","acc","data","key","keyFn","unnest","res","arr","subArr","dayRange","by","results","start","end","snapTo","QUERY_TYPE","REGULAR_QUERY","COMPARE_DATE_RANGE_QUERY","BLENDING_QUERY","ResultSet","axisValues","loadResponse","queryType","xValues","yValues","drillDownLocator","normalizedPivotConfig","values","parentFilters","segments","measures","measureName","operator","cubeName","range","dt","timezone","series","obj","resultIndex","row","measure","formatValue","v","delimiter","defaultPivotConfig","fillMissingDates","joinDateRange","dimensions","mergeDeepLeft","substituteTimeDimensionMembers","allIncludedDimensions","allDimensions","dimensionFilter","timeDimension","dates","pipe","map","reduce","minBy","maxBy","padToDay","pivotImpl","groupByXAxis","measureValue","Boolean","byXValues","groupBy","xGrouped","yValuesMap","rows","allYValues","measureOnX","yGrouped","yValuesArray","pivots","minLengthPivot","memo","current","pivot","validate","Number","allMeasures","flatten","a","m","aliasSeries","isMeasuresPresent","fromPairs","annotations","pluck","flatMeta","schema","extractFields","shortTitle","type","format","currentItem","children","toColumns","item","path","fields","dimensionValue","dataIndex","otherColumns","seriesNames","aliasedAxis","dropLast","pivotQuery","SqlQuery","memberMap","operators","string","number","time","Meta","cubes","c","b","memberKeys","cube","cubeTitle","memberName","error","memberTypes","ProgressResult","HttpTransport","authorization","apiUrl","method","headers","credentials","baseRequestId","params","spanCounter","searchParams","JSON","url","requestMethod","runRequest","fetch","Authorization","body","subscribe","callback","RequestError","Error","mutexCounter","MUTEX_ERROR","mutexPromise","promise","resolve","e","reject","CubejsApi","apiToken","uuidv4","mutexValue","mutexKey","requestPromise","request","unsubscribed","checkMutex","requestInstance","loadImpl","subscribeNext","next","setTimeout","continueWait","response","text","toResult","unsubscribe","token","parseDateMeasures"],"mappings":"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","sourcesContent":["import { indexBy, prop, clone, equals } from 'ramda';\n\nexport const DEFAULT_GRANULARITY = 'day';\n\nexport const GRANULARITIES = [\n  { name: undefined, title: 'w/o grouping' },\n  { name: 'second', title: 'Second' },\n  { name: 'minute', title: 'Minute' },\n  { name: 'hour', title: 'Hour' },\n  { name: 'day', title: 'Day' },\n  { name: 'week', title: 'Week' },\n  { name: 'month', title: 'Month' },\n  { name: 'year', title: 'Year' },\n];\n\nexport function areQueriesEqual(query1 = {}, query2 = {}) {\n  return (\n    equals(Object.entries((query1 && query1.order) || {}), Object.entries((query2 && query2.order) || {})) &&\n    equals(query1, query2)\n  );\n}\n\nexport function defaultOrder(query) {\n  const granularity = (query.timeDimensions || []).find((d) => d.granularity);\n\n  if (granularity) {\n    return {\n      [granularity.dimension]: 'asc',\n    };\n  } else if ((query.measures || []).length > 0 && (query.dimensions || []).length > 0) {\n    return {\n      [query.measures[0]]: 'desc',\n    };\n  } else if ((query.dimensions || []).length > 0) {\n    return {\n      [query.dimensions[0]]: 'asc',\n    };\n  }\n\n  return {};\n}\n\nexport function defaultHeuristics(newState, oldQuery = {}, options) {\n  const { query, ...props } = clone(newState);\n  const { meta, sessionGranularity } = options;\n  const granularity = sessionGranularity || DEFAULT_GRANULARITY;\n\n  let state = {\n    query,\n    ...props,\n  };\n\n  let newQuery = null;\n  if (!areQueriesEqual(query, oldQuery)) {\n    newQuery = query;\n  }\n\n  if (Array.isArray(newQuery) || Array.isArray(oldQuery)) {\n    return newState;\n  }\n\n  if (newQuery) {\n    if (\n      (oldQuery.timeDimensions || []).length === 1 &&\n      (newQuery.timeDimensions || []).length === 1 &&\n      newQuery.timeDimensions[0].granularity &&\n      oldQuery.timeDimensions[0].granularity !== newQuery.timeDimensions[0].granularity\n    ) {\n      state = {\n        ...state,\n        sessionGranularity: newQuery.timeDimensions[0].granularity,\n      };\n    }\n\n    if (\n      ((oldQuery.measures || []).length === 0 && (newQuery.measures || []).length > 0) ||\n      ((oldQuery.measures || []).length === 1 &&\n        (newQuery.measures || []).length === 1 &&\n        oldQuery.measures[0] !== newQuery.measures[0])\n    ) {\n      const [td] = newQuery.timeDimensions || [];\n      const defaultTimeDimension = meta.defaultTimeDimensionNameFor(newQuery.measures[0]);\n      newQuery = {\n        ...newQuery,\n        timeDimensions: defaultTimeDimension\n          ? [\n            {\n              dimension: defaultTimeDimension,\n              granularity: (td && td.granularity) || granularity,\n              dateRange: td && td.dateRange,\n            },\n          ]\n          : [],\n      };\n\n      return {\n        ...state,\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        chartType: defaultTimeDimension ? 'line' : 'number',\n      };\n    }\n\n    if ((oldQuery.dimensions || []).length === 0 && (newQuery.dimensions || []).length > 0) {\n      newQuery = {\n        ...newQuery,\n        timeDimensions: (newQuery.timeDimensions || []).map((td) => ({ ...td, granularity: undefined })),\n      };\n\n      return {\n        ...state,\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        chartType: 'table',\n      };\n    }\n\n    if ((oldQuery.dimensions || []).length > 0 && (newQuery.dimensions || []).length === 0) {\n      newQuery = {\n        ...newQuery,\n        timeDimensions: (newQuery.timeDimensions || []).map((td) => ({\n          ...td,\n          granularity: td.granularity || granularity,\n        })),\n      };\n\n      return {\n        ...state,\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        chartType: (newQuery.timeDimensions || []).length ? 'line' : 'number',\n      };\n    }\n\n    if (\n      ((oldQuery.dimensions || []).length > 0 || (oldQuery.measures || []).length > 0) &&\n      (newQuery.dimensions || []).length === 0 &&\n      (newQuery.measures || []).length === 0\n    ) {\n      newQuery = {\n        ...newQuery,\n        timeDimensions: [],\n        filters: [],\n      };\n\n      return {\n        ...state,\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: newQuery,\n        sessionGranularity: null,\n      };\n    }\n    return state;\n  }\n\n  if (state.chartType) {\n    const newChartType = state.chartType;\n    if (\n      (newChartType === 'line' || newChartType === 'area') &&\n      (oldQuery.timeDimensions || []).length === 1 &&\n      !oldQuery.timeDimensions[0].granularity\n    ) {\n      const [td] = oldQuery.timeDimensions;\n      return {\n        ...state,\n        pivotConfig: null,\n        query: {\n          ...oldQuery,\n          timeDimensions: [{ ...td, granularity }],\n        },\n      };\n    }\n\n    if (\n      (newChartType === 'pie' || newChartType === 'table' || newChartType === 'number') &&\n      (oldQuery.timeDimensions || []).length === 1 &&\n      oldQuery.timeDimensions[0].granularity\n    ) {\n      const [td] = oldQuery.timeDimensions;\n      return {\n        ...state,\n        pivotConfig: null,\n        shouldApplyHeuristicOrder: true,\n        query: {\n          ...oldQuery,\n          timeDimensions: [{ ...td, granularity: undefined }],\n        },\n      };\n    }\n  }\n\n  return state;\n}\n\nexport function isQueryPresent(query) {\n  if (!query) {\n    return false;\n  }\n\n  return (Array.isArray(query) ? query : [query]).every(\n    (q) => (q.measures && q.measures.length) ||\n      (q.dimensions && q.dimensions.length) ||\n      (q.timeDimensions && q.timeDimensions.length)\n  );\n}\n\nexport function movePivotItem(pivotConfig, sourceIndex, destinationIndex, sourceAxis, destinationAxis) {\n  const nextPivotConfig = {\n    ...pivotConfig,\n    x: [...pivotConfig.x],\n    y: [...pivotConfig.y],\n  };\n  const id = pivotConfig[sourceAxis][sourceIndex];\n  const lastIndex = nextPivotConfig[destinationAxis].length - 1;\n\n  if (id === 'measures') {\n    destinationIndex = lastIndex + 1;\n  } else if (destinationIndex >= lastIndex && nextPivotConfig[destinationAxis][lastIndex] === 'measures') {\n    destinationIndex = lastIndex - 1;\n  }\n\n  nextPivotConfig[sourceAxis].splice(sourceIndex, 1);\n  nextPivotConfig[destinationAxis].splice(destinationIndex, 0, id);\n\n  return nextPivotConfig;\n}\n\nexport function moveItemInArray(list, sourceIndex, destinationIndex) {\n  const result = [...list];\n  const [removed] = result.splice(sourceIndex, 1);\n  result.splice(destinationIndex, 0, removed);\n\n  return result;\n}\n\nexport function flattenFilters(filters = []) {\n  return filters.reduce((memo, filter) => {\n    if (filter.or || filter.and) {\n      return [...memo, ...flattenFilters(filter.or || filter.and)];\n    }\n\n    return [...memo, filter];\n  }, []);\n}\n\nexport function getQueryMembers(query = {}) {\n  const keys = ['measures', 'dimensions', 'segments'];\n  const members = new Set();\n\n  keys.forEach((key) => (query[key] || []).forEach((member) => members.add(member)));\n  (query.timeDimensions || []).forEach((td) => members.add(td.dimension));\n\n  flattenFilters(query.filters).forEach((filter) => members.add(filter.dimension || filter.member));\n\n  return [...members];\n}\n\nexport function getOrderMembersFromOrder(orderMembers, order) {\n  const ids = new Set();\n  const indexedOrderMembers = indexBy(prop('id'), orderMembers);\n  const entries = Array.isArray(order) ? order : Object.entries(order || {});\n  const nextOrderMembers = [];\n\n  entries.forEach(([memberId, currentOrder]) => {\n    if (currentOrder !== 'none' && indexedOrderMembers[memberId]) {\n      ids.add(memberId);\n      nextOrderMembers.push({\n        ...indexedOrderMembers[memberId],\n        order: currentOrder,\n      });\n    }\n  });\n  orderMembers.forEach((member) => {\n    if (!ids.has(member.id)) {\n      nextOrderMembers.push({\n        ...member,\n        order: member.order || 'none',\n      });\n    }\n  });\n\n  return nextOrderMembers;\n}\n\nexport function aliasSeries(values, index, pivotConfig, duplicateMeasures) {\n  const nonNullValues = values.filter((value) => value != null);\n\n  if (pivotConfig && pivotConfig.aliasSeries && pivotConfig.aliasSeries[index]) {\n    return [pivotConfig.aliasSeries[index], ...nonNullValues];\n  } else if (duplicateMeasures.has(nonNullValues[0])) {\n    return [index, ...nonNullValues];\n  }\n\n  return nonNullValues;\n}\n","import dayjs from 'dayjs';\nimport en from 'dayjs/locale/en';\nimport {\n  groupBy, pipe, fromPairs, uniq, filter, map, dropLast, equals, reduce, minBy, maxBy, clone, mergeDeepLeft,\n  pluck, mergeAll, flatten,\n} from 'ramda';\n\nimport { aliasSeries } from './utils';\n\ndayjs.locale({\n  ...en,\n  weekStart: 1,\n});\n\nexport const TIME_SERIES = {\n  day: (range) => range.by('d').map(d => d.format('YYYY-MM-DDT00:00:00.000')),\n  month: (range) => range.snapTo('month').by('M').map(d => d.format('YYYY-MM-01T00:00:00.000')),\n  year: (range) => range.snapTo('year').by('y').map(d => d.format('YYYY-01-01T00:00:00.000')),\n  hour: (range) => range.by('h').map(d => d.format('YYYY-MM-DDTHH:00:00.000')),\n  minute: (range) => range.by('m').map(d => d.format('YYYY-MM-DDTHH:mm:00.000')),\n  second: (range) => range.by('s').map(d => d.format('YYYY-MM-DDTHH:mm:ss.000')),\n  week: (range) => range.snapTo('week').by('w').map(d => d.startOf('week').format('YYYY-MM-DDT00:00:00.000'))\n};\n\nconst DateRegex = /^\\d\\d\\d\\d-\\d\\d-\\d\\d$/;\nconst LocalDateRegex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}Z?$/;\n\nconst groupByToPairs = (keyFn) => {\n  const acc = new Map();\n\n  return (data) => {\n    data.forEach((row) => {\n      const key = keyFn(row);\n\n      if (!acc.has(key)) {\n        acc.set(key, []);\n      }\n\n      acc.get(key).push(row);\n    });\n\n    return Array.from(acc.entries());\n  };\n};\n\nconst unnest = (arr) => {\n  const res = [];\n  arr.forEach((subArr) => {\n    subArr.forEach(element => res.push(element));\n  });\n\n  return res;\n};\n\nexport const dayRange = (from, to) => ({\n  by: (value) => {\n    const results = [];\n\n    let start = dayjs(from);\n    const end = dayjs(to);\n\n    while (start.isBefore(end) || start.isSame(end)) {\n      results.push(start);\n      start = start.add(1, value);\n    }\n\n    return results;\n  },\n  snapTo: (value) => dayRange(dayjs(from).startOf(value), dayjs(to).endOf(value)),\n  start: dayjs(from),\n  end: dayjs(to),\n});\n\nexport const QUERY_TYPE = {\n  REGULAR_QUERY: 'regularQuery',\n  COMPARE_DATE_RANGE_QUERY: 'compareDateRangeQuery',\n  BLENDING_QUERY: 'blendingQuery',\n};\n\nclass ResultSet {\n  static measureFromAxis(axisValues) {\n    return axisValues[axisValues.length - 1];\n  }\n\n  static timeDimensionMember(td) {\n    return `${td.dimension}.${td.granularity}`;\n  }\n\n  static deserialize(data, options = {}) {\n    return new ResultSet(data.loadResponse, options);\n  }\n\n  constructor(loadResponse, options = {}) {\n    this.loadResponse = loadResponse;\n\n    if (this.loadResponse.queryType != null) {\n      this.queryType = loadResponse.queryType;\n      this.loadResponses = loadResponse.results;\n    } else {\n      this.queryType = QUERY_TYPE.REGULAR_QUERY;\n      this.loadResponse.pivotQuery = {\n        ...loadResponse.query,\n        queryType: this.queryType\n      };\n      this.loadResponses = [loadResponse];\n    }\n\n    if (!Object.values(QUERY_TYPE).includes(this.queryType)) {\n      throw new Error('Unknown query type');\n    }\n\n    this.parseDateMeasures = options.parseDateMeasures;\n    this.options = options;\n\n    this.backwardCompatibleData = [];\n  }\n\n  drillDown(drillDownLocator, pivotConfig) {\n    if (this.queryType === QUERY_TYPE.COMPARE_DATE_RANGE_QUERY) {\n      throw new Error('compareDateRange drillDown query is not currently supported');\n    }\n    if (this.queryType === QUERY_TYPE.BLENDING_QUERY) {\n      throw new Error('Data blending drillDown query is not currently supported');\n    }\n\n    const { xValues = [], yValues = [] } = drillDownLocator;\n    const normalizedPivotConfig = this.normalizePivotConfig(pivotConfig);\n\n    const values = [];\n    normalizedPivotConfig.x.forEach((member, currentIndex) => values.push([member, xValues[currentIndex]]));\n    normalizedPivotConfig.y.forEach((member, currentIndex) => values.push([member, yValues[currentIndex]]));\n\n    const { filters: parentFilters = [], segments = [] } = this.query();\n    const { measures } = this.loadResponses[0].annotation;\n    let [, measureName] = values.find(([member]) => member === 'measures') || [];\n\n    if (measureName === undefined) {\n      [measureName] = Object.keys(measures);\n    }\n\n    if (!(measures[measureName] && measures[measureName].drillMembers || []).length) {\n      return null;\n    }\n\n    const filters = [\n      {\n        member: measureName,\n        operator: 'measureFilter',\n      },\n      ...parentFilters\n    ];\n    const timeDimensions = [];\n\n    values.filter(([member]) => member !== 'measures')\n      .forEach(([member, value]) => {\n        const [cubeName, dimension, granularity] = member.split('.');\n\n        if (granularity !== undefined) {\n          const range = dayRange(value, value).snapTo(granularity);\n\n          timeDimensions.push({\n            dimension: [cubeName, dimension].join('.'),\n            dateRange: [\n              range.start,\n              range.end\n            ].map((dt) => dt.format('YYYY-MM-DDTHH:mm:ss.SSS')),\n          });\n        } else if (value == null) {\n          filters.push({\n            member,\n            operator: 'notSet',\n          });\n        } else {\n          filters.push({\n            member,\n            operator: 'equals',\n            values: [value.toString()],\n          });\n        }\n      });\n\n    const { query } = this.loadResponses[0];\n    if (\n      timeDimensions.length === 0 &&\n      query.timeDimensions.length > 0 &&\n      query.timeDimensions[0].granularity == null\n    ) {\n      timeDimensions.push(query.timeDimensions[0]);\n    }\n\n    return {\n      ...measures[measureName].drillMembersGrouped,\n      filters,\n      ...(segments.length > 0 ? { segments } : {}),\n      timeDimensions,\n      segments,\n      timezone: query.timezone\n    };\n  }\n\n  series(pivotConfig) {\n    return this.seriesNames(pivotConfig).map(({ title, key }) => ({\n      title,\n      key,\n      series: this.chartPivot(pivotConfig).map(({ x, ...obj }) => ({ value: obj[key], x }))\n    }));\n  }\n\n  axisValues(axis, resultIndex = 0) {\n    const { query } = this.loadResponses[resultIndex];\n\n    return row => {\n      const value = (measure) => axis.filter(d => d !== 'measures')\n        .map(d => (row[d] != null ? row[d] : null)).concat(measure ? [measure] : []);\n\n      if (axis.find(d => d === 'measures') && (query.measures || []).length) {\n        return query.measures.map(value);\n      }\n\n      return [value()];\n    };\n  }\n\n  axisValuesString(axisValues, delimiter) {\n    const formatValue = (v) => {\n      if (v == null) {\n        return '∅';\n      } else if (v === '') {\n        return '[Empty string]';\n      } else {\n        return v;\n      }\n    };\n    return axisValues.map(formatValue).join(delimiter || ', ');\n  }\n\n  static getNormalizedPivotConfig(query = {}, pivotConfig = null) {\n    const defaultPivotConfig = {\n      x: [],\n      y: [],\n      fillMissingDates: true,\n      joinDateRange: false\n    };\n\n    const {\n      measures = [],\n      dimensions = []\n    } = query;\n\n    const timeDimensions = (query.timeDimensions || []).filter(td => !!td.granularity);\n\n    pivotConfig = pivotConfig || (timeDimensions.length ? {\n      x: timeDimensions.map(td => ResultSet.timeDimensionMember(td)),\n      y: dimensions\n    } : {\n      x: dimensions,\n      y: []\n    });\n\n    pivotConfig = mergeDeepLeft(pivotConfig, defaultPivotConfig);\n\n    const substituteTimeDimensionMembers = axis => axis.map(\n      subDim => (\n        (\n          timeDimensions.find(td => td.dimension === subDim) &&\n          !dimensions.find(d => d === subDim)\n        ) ?\n          ResultSet.timeDimensionMember(query.timeDimensions.find(td => td.dimension === subDim)) :\n          subDim\n      )\n    );\n\n    pivotConfig.x = substituteTimeDimensionMembers(pivotConfig.x);\n    pivotConfig.y = substituteTimeDimensionMembers(pivotConfig.y);\n\n    const allIncludedDimensions = pivotConfig.x.concat(pivotConfig.y);\n    const allDimensions = timeDimensions.map(td => ResultSet.timeDimensionMember(td)).concat(dimensions);\n\n    const dimensionFilter = (key) => allDimensions.includes(key) || key === 'measures';\n\n    pivotConfig.x = pivotConfig.x.concat(\n      allDimensions.filter(d => !allIncludedDimensions.includes(d) && d !== 'compareDateRange')\n    )\n      .filter(dimensionFilter);\n    pivotConfig.y = pivotConfig.y.filter(dimensionFilter);\n\n    if (!pivotConfig.x.concat(pivotConfig.y).find(d => d === 'measures')) {\n      pivotConfig.y.push('measures');\n    }\n\n    if (dimensions.includes('compareDateRange') && !pivotConfig.y.concat(pivotConfig.x).includes('compareDateRange')) {\n      pivotConfig.y.unshift('compareDateRange');\n    }\n\n    if (!measures.length) {\n      pivotConfig.x = pivotConfig.x.filter(d => d !== 'measures');\n      pivotConfig.y = pivotConfig.y.filter(d => d !== 'measures');\n    }\n\n    return pivotConfig;\n  }\n\n  normalizePivotConfig(pivotConfig) {\n    return ResultSet.getNormalizedPivotConfig(this.loadResponse.pivotQuery, pivotConfig);\n  }\n\n  timeSeries(timeDimension, resultIndex) {\n    if (!timeDimension.granularity) {\n      return null;\n    }\n\n    let { dateRange } = timeDimension;\n\n    if (!dateRange) {\n      const member = ResultSet.timeDimensionMember(timeDimension);\n      const dates = pipe(\n        map(row => row[member] && dayjs(row[member])),\n        filter(Boolean)\n      )(this.timeDimensionBackwardCompatibleData(resultIndex));\n\n      dateRange = dates.length && [\n        reduce(minBy(d => d.toDate()), dates[0], dates),\n        reduce(maxBy(d => d.toDate()), dates[0], dates)\n      ] || null;\n    }\n\n    if (!dateRange) {\n      return null;\n    }\n\n    const padToDay = timeDimension.dateRange ?\n      timeDimension.dateRange.find(d => d.match(DateRegex)) :\n      !['hour', 'minute', 'second'].includes(timeDimension.granularity);\n\n    const [start, end] = dateRange;\n    const range = dayRange(start, end);\n\n    if (!TIME_SERIES[timeDimension.granularity]) {\n      throw new Error(`Unsupported time granularity: ${timeDimension.granularity}`);\n    }\n\n    return TIME_SERIES[timeDimension.granularity](\n      padToDay ? range.snapTo('d') : range\n    );\n  }\n\n  pivot(pivotConfig) {\n    pivotConfig = this.normalizePivotConfig(pivotConfig);\n    const { pivotQuery: query } = this.loadResponse;\n\n    const pivotImpl = (resultIndex = 0) => {\n      let groupByXAxis = groupByToPairs(({ xValues }) => this.axisValuesString(xValues));\n\n      let measureValue = (row, measure) => row[measure];\n\n      if (\n        pivotConfig.fillMissingDates &&\n        pivotConfig.x.length === 1 &&\n        (equals(\n          pivotConfig.x,\n          (query.timeDimensions || [])\n            .filter(td => Boolean(td.granularity))\n            .map(td => ResultSet.timeDimensionMember(td))\n        ))\n      ) {\n        const series = this.loadResponses.map(\n          (loadResponse) => this.timeSeries(loadResponse.query.timeDimensions[0], resultIndex)\n        );\n\n        if (series[0]) {\n          groupByXAxis = (rows) => {\n            const byXValues = groupBy(\n              ({ xValues }) => xValues[0],\n              rows\n            );\n            return series[resultIndex].map(d => [d, byXValues[d] || [{ xValues: [d], row: {} }]]);\n          };\n\n          measureValue = (row, measure) => row[measure] || 0;\n        }\n      }\n\n      const xGrouped = pipe(\n        map(row => this.axisValues(pivotConfig.x, resultIndex)(row).map(xValues => ({ xValues, row }))),\n        unnest,\n        groupByXAxis\n      )(this.timeDimensionBackwardCompatibleData(resultIndex));\n\n      const yValuesMap = {};\n      xGrouped.forEach(([, rows]) => {\n        rows.forEach(({ row }) => {\n          this.axisValues(pivotConfig.y, resultIndex)(row).forEach((values) => {\n            if (Object.keys(row).length > 0) {\n              yValuesMap[values.join()] = values;\n            }\n          });\n        });\n      });\n      const allYValues = Object.values(yValuesMap);\n\n      const measureOnX = Boolean(pivotConfig.x.find(d => d === 'measures'));\n\n      return xGrouped.map(([, rows]) => {\n        const { xValues } = rows[0];\n        const yGrouped = {};\n\n        rows.forEach(({ row }) => {\n          const arr = this.axisValues(pivotConfig.y, resultIndex)(row).map(yValues => ({ yValues, row }));\n          arr.forEach((res) => {\n            yGrouped[this.axisValuesString(res.yValues)] = res;\n          });\n        });\n\n        return {\n          xValues,\n          yValuesArray: unnest(allYValues.map(yValues => {\n            const measure = measureOnX ?\n              ResultSet.measureFromAxis(xValues) :\n              ResultSet.measureFromAxis(yValues);\n\n            return [[yValues, measureValue((yGrouped[this.axisValuesString(yValues)] ||\n              ({ row: {} })).row, measure)]];\n          }))\n        };\n      });\n    };\n\n    const pivots = this.loadResponses.length > 1\n      ? this.loadResponses.map((_, index) => pivotImpl(index))\n      : [];\n\n    return pivots.length\n      ? this.mergePivots(pivots, pivotConfig.joinDateRange)\n      : pivotImpl();\n  }\n\n  mergePivots(pivots, joinDateRange) {\n    const minLengthPivot = pivots.reduce(\n      (memo, current) => (memo != null && current.length >= memo.length ? memo : current), null\n    );\n\n    return minLengthPivot.map((_, index) => {\n      const xValues = joinDateRange\n        ? [pivots.map((pivot) => pivot[index] && pivot[index].xValues || []).join(', ')]\n        : minLengthPivot[index].xValues;\n\n      return {\n        xValues,\n        yValuesArray: unnest(pivots.map((pivot) => pivot[index].yValuesArray))\n      };\n    });\n  }\n\n  pivotedRows(pivotConfig) { // TODO\n    return this.chartPivot(pivotConfig);\n  }\n\n  chartPivot(pivotConfig) {\n    const validate = (value) => {\n      if (this.parseDateMeasures && LocalDateRegex.test(value)) {\n        return new Date(value);\n      } else if (!Number.isNaN(Number.parseFloat(value))) {\n        return Number.parseFloat(value);\n      }\n\n      return value;\n    };\n\n    const duplicateMeasures = new Set();\n    if (this.queryType === QUERY_TYPE.BLENDING_QUERY) {\n      const allMeasures = flatten(this.loadResponses.map(({ query }) => query.measures));\n      allMeasures.filter((e, i, a) => a.indexOf(e) !== i).forEach(m => duplicateMeasures.add(m));\n    }\n\n    return this.pivot(pivotConfig).map(({ xValues, yValuesArray }) => {\n      const yValuesMap = {};\n\n      yValuesArray\n        .forEach(([yValues, m], i) => {\n          yValuesMap[this.axisValuesString(aliasSeries(yValues, i, pivotConfig, duplicateMeasures), ',')] = m && validate(m);\n        });\n\n      return ({\n        x: this.axisValuesString(xValues, ','),\n        xValues,\n        ...yValuesMap\n      });\n    });\n  }\n\n  tablePivot(pivotConfig) {\n    const normalizedPivotConfig = this.normalizePivotConfig(pivotConfig || {});\n    const isMeasuresPresent = normalizedPivotConfig.x.concat(normalizedPivotConfig.y).includes('measures');\n\n    return this.pivot(normalizedPivotConfig).map(({ xValues, yValuesArray }) => fromPairs(\n      normalizedPivotConfig.x\n        .map((key, index) => [key, xValues[index]])\n        .concat(\n          isMeasuresPresent ? yValuesArray.map(([yValues, measure]) => [\n            yValues.length ? yValues.join() : 'value',\n            measure\n          ]) : []\n        )\n    ));\n  }\n\n  tableColumns(pivotConfig) {\n    const normalizedPivotConfig = this.normalizePivotConfig(pivotConfig || {});\n    const annotations = pipe(\n      pluck('annotation'),\n      reduce(mergeDeepLeft(), {})\n    )(this.loadResponses);\n    const flatMeta = Object.values(annotations).reduce((a, b) => ({ ...a, ...b }), {});\n    const schema = {};\n\n    const extractFields = (key) => {\n      const { title, shortTitle, type, format, meta } = flatMeta[key] || {};\n\n      return {\n        key,\n        title,\n        shortTitle,\n        type,\n        format,\n        meta\n      };\n    };\n\n    const pivot = this.pivot(normalizedPivotConfig);\n\n    (pivot[0] && pivot[0].yValuesArray || []).forEach(([yValues]) => {\n      if (yValues.length > 0) {\n        let currentItem = schema;\n\n        yValues.forEach((value, index) => {\n          currentItem[value] = {\n            key: value,\n            memberId: normalizedPivotConfig.y[index] === 'measures'\n              ? value\n              : normalizedPivotConfig.y[index],\n            children: (currentItem[value] && currentItem[value].children) || {}\n          };\n\n          currentItem = currentItem[value].children;\n        });\n      }\n    });\n\n    const toColumns = (item = {}, path = []) => {\n      if (Object.keys(item).length === 0) {\n        return [];\n      }\n\n      return Object.values(item).map(({ key, ...currentItem }) => {\n        const children = toColumns(currentItem.children, [\n          ...path,\n          key\n        ]);\n\n        const { title, shortTitle, ...fields } = extractFields(currentItem.memberId);\n\n        const dimensionValue = key !== currentItem.memberId || title == null ? key : '';\n\n        if (!children.length) {\n          return {\n            ...fields,\n            key,\n            dataIndex: [...path, key].join(),\n            title: [title, dimensionValue].join(' ').trim(),\n            shortTitle: dimensionValue || shortTitle,\n          };\n        }\n\n        return {\n          ...fields,\n          key,\n          title: [title, dimensionValue].join(' ').trim(),\n          shortTitle: dimensionValue || shortTitle,\n          children,\n        };\n      });\n    };\n\n    let otherColumns = [];\n\n    if (!pivot.length && normalizedPivotConfig.y.includes('measures')) {\n      otherColumns = (this.loadResponses[0].query.measures || []).map(\n        (key) => ({ ...extractFields(key), dataIndex: key })\n      );\n    }\n\n    // Syntatic column to display the measure value\n    if (!normalizedPivotConfig.y.length && normalizedPivotConfig.x.includes('measures')) {\n      otherColumns.push({\n        key: 'value',\n        dataIndex: 'value',\n        title: 'Value',\n        shortTitle: 'Value',\n        type: 'string',\n      });\n    }\n\n    return normalizedPivotConfig.x\n      .map((key) => {\n        if (key === 'measures') {\n          return {\n            key: 'measures',\n            dataIndex: 'measures',\n            title: 'Measures',\n            shortTitle: 'Measures',\n            type: 'string',\n          };\n        }\n\n        return ({ ...extractFields(key), dataIndex: key });\n      })\n      .concat(toColumns(schema))\n      .concat(otherColumns);\n  }\n\n  totalRow(pivotConfig) {\n    return this.chartPivot(pivotConfig)[0];\n  }\n\n  categories(pivotConfig) { // TODO\n    return this.chartPivot(pivotConfig);\n  }\n\n  seriesNames(pivotConfig) {\n    pivotConfig = this.normalizePivotConfig(pivotConfig);\n    const measures = pipe(\n      pluck('annotation'),\n      pluck('measures'),\n      mergeAll\n    )(this.loadResponses);\n\n    const seriesNames = unnest(this.loadResponses.map((_, index) => pipe(\n      map(this.axisValues(pivotConfig.y, index)),\n      unnest,\n      uniq\n    )(\n      this.timeDimensionBackwardCompatibleData(index)\n    )));\n    const duplicateMeasures = new Set();\n    if (this.queryType === QUERY_TYPE.BLENDING_QUERY) {\n      const allMeasures = flatten(this.loadResponses.map(({ query }) => query.measures));\n      allMeasures.filter((e, i, a) => a.indexOf(e) !== i).forEach(m => duplicateMeasures.add(m));\n    }\n\n    return seriesNames.map((axisValues, i) => {\n      const aliasedAxis = aliasSeries(axisValues, i, pivotConfig, duplicateMeasures);\n      return {\n        title: this.axisValuesString(\n          pivotConfig.y.find(d => d === 'measures') ?\n            dropLast(1, aliasedAxis).concat(\n              measures[\n                ResultSet.measureFromAxis(axisValues)\n              ].title\n            ) :\n            aliasedAxis, ', '\n        ),\n        key: this.axisValuesString(aliasedAxis, ','),\n        yValues: axisValues\n      };\n    });\n  }\n\n  query() {\n    if (this.queryType !== QUERY_TYPE.REGULAR_QUERY) {\n      throw new Error(`Method is not supported for a '${this.queryType}' query type. Please use decompose`);\n    }\n\n    return this.loadResponses[0].query;\n  }\n\n  pivotQuery() {\n    return this.loadResponse.pivotQuery || null;\n  }\n\n  rawData() {\n    if (this.queryType !== QUERY_TYPE.REGULAR_QUERY) {\n      throw new Error(`Method is not supported for a '${this.queryType}' query type. Please use decompose`);\n    }\n\n    return this.loadResponses[0].data;\n  }\n\n  annotation() {\n    if (this.queryType !== QUERY_TYPE.REGULAR_QUERY) {\n      throw new Error(`Method is not supported for a '${this.queryType}' query type. Please use decompose`);\n    }\n\n    return this.loadResponses[0].annotation;\n  }\n\n  timeDimensionBackwardCompatibleData(resultIndex) {\n    if (resultIndex === undefined) {\n      throw new Error('resultIndex is required');\n    }\n\n    if (!this.backwardCompatibleData[resultIndex]) {\n      const { data, query } = this.loadResponses[resultIndex];\n      const timeDimensions = (query.timeDimensions || []).filter(td => Boolean(td.granularity));\n\n      this.backwardCompatibleData[resultIndex] = data.map(row => (\n        {\n          ...row,\n          ...(\n            fromPairs(Object.keys(row)\n              .filter(\n                field => timeDimensions.find(d => d.dimension === field) &&\n                  !row[ResultSet.timeDimensionMember(timeDimensions.find(d => d.dimension === field))]\n              ).map(field => (\n                [ResultSet.timeDimensionMember(timeDimensions.find(d => d.dimension === field)), row[field]]\n              )))\n          )\n        }\n      ));\n    }\n\n    return this.backwardCompatibleData[resultIndex];\n  }\n\n  decompose() {\n    return this.loadResponses.map((result) => new ResultSet({\n      queryType: QUERY_TYPE.REGULAR_QUERY,\n      pivotQuery: {\n        ...result.query,\n        queryType: QUERY_TYPE.REGULAR_QUERY,\n      },\n      results: [result]\n    }, this.options));\n  }\n\n  serialize() {\n    return {\n      loadResponse: clone(this.loadResponse)\n    };\n  }\n}\n\nexport default ResultSet;\n","export default class SqlQuery {\n  constructor(sqlQuery) {\n    this.sqlQuery = sqlQuery;\n  }\n\n  rawQuery() {\n    return this.sqlQuery.sql;\n  }\n\n  sql() {\n    return this.rawQuery().sql[0];\n  }\n}\n","/**\n * @module @cubejs-client/core\n */\n\nimport { unnest, fromPairs } from 'ramda';\n\nconst memberMap = (memberArray) => fromPairs(memberArray.map((m) => [m.name, m]));\n\nconst operators = {\n  string: [\n    { name: 'contains', title: 'contains' },\n    { name: 'notContains', title: 'does not contain' },\n    { name: 'equals', title: 'equals' },\n    { name: 'notEquals', title: 'does not equal' },\n    { name: 'set', title: 'is set' },\n    { name: 'notSet', title: 'is not set' },\n  ],\n  number: [\n    { name: 'equals', title: 'equals' },\n    { name: 'notEquals', title: 'does not equal' },\n    { name: 'set', title: 'is set' },\n    { name: 'notSet', title: 'is not set' },\n    { name: 'gt', title: '>' },\n    { name: 'gte', title: '>=' },\n    { name: 'lt', title: '<' },\n    { name: 'lte', title: '<=' },\n  ],\n  time: [\n    { name: 'equals', title: 'equals' },\n    { name: 'notEquals', title: 'does not equal' },\n    { name: 'inDateRange', title: 'in date range' },\n    { name: 'notInDateRange', title: 'not in date range' },\n    { name: 'afterDate', title: 'after date' },\n    { name: 'beforeDate', title: 'before date' },\n  ],\n};\n\n/**\n * Contains information about available cubes and it's members.\n */\nclass Meta {\n  constructor(metaResponse) {\n    this.meta = metaResponse;\n    const { cubes } = this.meta;\n    this.cubes = cubes;\n    this.cubesMap = fromPairs(\n      cubes.map((c) => [\n        c.name,\n        {\n          measures: memberMap(c.measures),\n          dimensions: memberMap(c.dimensions),\n          segments: memberMap(c.segments),\n        },\n      ])\n    );\n  }\n\n  membersForQuery(query, memberType) {\n    return unnest(this.cubes.map((c) => c[memberType])).sort((a, b) => (a.title > b.title ? 1 : -1));\n  }\n\n  membersGroupedByCube() {\n    const memberKeys = ['measures', 'dimensions', 'segments', 'timeDimensions'];\n\n    return this.cubes.reduce(\n      (memo, cube) => {\n        memberKeys.forEach((key) => {\n          let members = cube[key];\n\n          if (key === 'timeDimensions') {\n            members = cube.dimensions.filter((m) => m.type === 'time');\n          }\n\n          memo[key] = [\n            ...memo[key],\n            {\n              cubeName: cube.name,\n              cubeTitle: cube.title,\n              members\n            },\n          ];\n        });\n\n        return memo;\n      },\n      {\n        measures: [],\n        dimensions: [],\n        segments: [],\n        timeDimensions: [],\n      }\n    );\n  }\n\n  resolveMember(memberName, memberType) {\n    const [cube] = memberName.split('.');\n\n    if (!this.cubesMap[cube]) {\n      return { title: memberName, error: `Cube not found ${cube} for path '${memberName}'` };\n    }\n\n    const memberTypes = Array.isArray(memberType) ? memberType : [memberType];\n    const member = memberTypes\n      .map((type) => this.cubesMap[cube][type] && this.cubesMap[cube][type][memberName])\n      .find((m) => m);\n\n    if (!member) {\n      return {\n        title: memberName,\n        error: `Path not found '${memberName}'`,\n      };\n    }\n\n    return member;\n  }\n\n  defaultTimeDimensionNameFor(memberName) {\n    const [cube] = memberName.split('.');\n    if (!this.cubesMap[cube]) {\n      return null;\n    }\n    return Object.keys(this.cubesMap[cube].dimensions || {}).find(\n      (d) => this.cubesMap[cube].dimensions[d].type === 'time'\n    );\n  }\n\n  filterOperatorsForMember(memberName, memberType) {\n    const member = this.resolveMember(memberName, memberType);\n\n    return operators[member.type] || operators.string;\n  }\n}\n\nexport default Meta;\n","export default class ProgressResult {\n  constructor(progressResponse) {\n    this.progressResponse = progressResponse;\n  }\n\n  stage() {\n    return this.progressResponse.stage;\n  }\n\n  timeElapsed() {\n    return this.progressResponse.timeElapsed;\n  }\n}\n","import fetch from 'cross-fetch';\nimport 'url-search-params-polyfill';\n\nclass HttpTransport {\n  constructor({ authorization, apiUrl, method, headers = {}, credentials }) {\n    this.authorization = authorization;\n    this.apiUrl = apiUrl;\n    this.method = method;\n    this.headers = headers;\n    this.credentials = credentials;\n  }\n\n  request(method, { baseRequestId, ...params }) {\n    let spanCounter = 1;\n    const searchParams = new URLSearchParams(\n      params && Object.keys(params)\n        .map(k => ({ [k]: typeof params[k] === 'object' ? JSON.stringify(params[k]) : params[k] }))\n        .reduce((a, b) => ({ ...a, ...b }), {})\n    );\n\n    let url = `${this.apiUrl}/${method}${searchParams.toString().length ? `?${searchParams}` : ''}`;\n\n    const requestMethod = this.method || (url.length < 2000 ? 'GET' : 'POST');\n    if (requestMethod === 'POST') {\n      url = `${this.apiUrl}/${method}`;\n      this.headers['Content-Type'] = 'application/json';\n    }\n\n    // Currently, all methods make GET requests. If a method makes a request with a body payload,\n    // remember to add {'Content-Type': 'application/json'} to the header.\n    const runRequest = () => fetch(url, {\n      method: requestMethod,\n      headers: {\n        Authorization: this.authorization,\n        'x-request-id': baseRequestId && `${baseRequestId}-span-${spanCounter++}`,\n        ...this.headers\n      },\n      credentials: this.credentials,\n      body: requestMethod === 'POST' ? JSON.stringify(params) : null\n    });\n\n    return {\n      async subscribe(callback) {\n        const result = await runRequest();\n        return callback(result, () => this.subscribe(callback));\n      }\n    };\n  }\n}\n\nexport default HttpTransport;\n","export default class RequestError extends Error {\n  constructor(message, response) {\n    super(message);\n    this.response = response;\n  }\n}\n","import { v4 as uuidv4 } from 'uuid';\nimport ResultSet from './ResultSet';\nimport SqlQuery from './SqlQuery';\nimport Meta from './Meta';\nimport ProgressResult from './ProgressResult';\nimport HttpTransport from './HttpTransport';\nimport RequestError from './RequestError';\n\nlet mutexCounter = 0;\n\nconst MUTEX_ERROR = 'Mutex has been changed';\n\nconst mutexPromise = (promise) => new Promise((resolve, reject) => {\n  promise.then(r => resolve(r), e => e !== MUTEX_ERROR && reject(e));\n});\n\nclass CubejsApi {\n  constructor(apiToken, options) {\n    if (typeof apiToken === 'object') {\n      options = apiToken;\n      apiToken = undefined;\n    }\n    options = options || {};\n\n    if (!options.transport && !options.apiUrl) {\n      throw new Error('The `apiUrl` option is required');\n    }\n\n    this.apiToken = apiToken;\n    this.apiUrl = options.apiUrl;\n    this.method = options.method;\n    this.headers = options.headers || {};\n    this.credentials = options.credentials;\n    this.transport = options.transport || new HttpTransport({\n      authorization: typeof apiToken === 'function' ? undefined : apiToken,\n      apiUrl: this.apiUrl,\n      method: this.method,\n      headers: this.headers,\n      credentials: this.credentials\n    });\n    this.pollInterval = options.pollInterval || 5;\n    this.parseDateMeasures = options.parseDateMeasures;\n  }\n\n  request(method, params) {\n    return this.transport.request(method, { baseRequestId: uuidv4(), ...params });\n  }\n\n  loadMethod(request, toResult, options, callback) {\n    const mutexValue = ++mutexCounter;\n    if (typeof options === 'function' && !callback) {\n      callback = options;\n      options = undefined;\n    }\n\n    options = options || {};\n\n    const mutexKey = options.mutexKey || 'default';\n    if (options.mutexObj) {\n      options.mutexObj[mutexKey] = mutexValue;\n    }\n\n    const requestPromise = this.updateTransportAuthorization().then(() => request());\n\n    let unsubscribed = false;\n\n    const checkMutex = async () => {\n      const requestInstance = await requestPromise;\n\n      if (options.mutexObj && options.mutexObj[mutexKey] !== mutexValue) {\n        unsubscribed = true;\n        if (requestInstance.unsubscribe) {\n          await requestInstance.unsubscribe();\n        }\n        throw MUTEX_ERROR;\n      }\n    };\n\n    const loadImpl = async (response, next) => {\n      const requestInstance = await requestPromise;\n\n      const subscribeNext = async () => {\n        if (options.subscribe && !unsubscribed) {\n          if (requestInstance.unsubscribe) {\n            return next();\n          } else {\n            await new Promise(resolve => setTimeout(() => resolve(), this.pollInterval * 1000));\n            return next();\n          }\n        }\n        return null;\n      };\n\n      const continueWait = async (wait) => {\n        if (!unsubscribed) {\n          if (wait) {\n            await new Promise(resolve => setTimeout(() => resolve(), this.pollInterval * 1000));\n          }\n          return next();\n        }\n        return null;\n      };\n\n      await this.updateTransportAuthorization();\n\n      if (response.status === 502) {\n        await checkMutex();\n        return continueWait(true);\n      }\n\n      let body = {};\n      let text = '';\n      try {\n        text = await response.text();\n        body = JSON.parse(text);\n      } catch (_) {\n        body.error = text;\n      }\n\n      if (body.error === 'Continue wait') {\n        await checkMutex();\n        if (options.progressCallback) {\n          options.progressCallback(new ProgressResult(body));\n        }\n        return continueWait();\n      }\n\n      if (response.status !== 200) {\n        await checkMutex();\n        if (!options.subscribe && requestInstance.unsubscribe) {\n          await requestInstance.unsubscribe();\n        }\n\n        const error = new RequestError(body.error, body); // TODO error class\n        if (callback) {\n          callback(error);\n        } else {\n          throw error;\n        }\n\n        return subscribeNext();\n      }\n      await checkMutex();\n      if (!options.subscribe && requestInstance.unsubscribe) {\n        await requestInstance.unsubscribe();\n      }\n      const result = toResult(body);\n      if (callback) {\n        callback(null, result);\n      } else {\n        return result;\n      }\n\n      return subscribeNext();\n    };\n\n    const promise = requestPromise.then(requestInstance => mutexPromise(requestInstance.subscribe(loadImpl)));\n\n    if (callback) {\n      return {\n        unsubscribe: async () => {\n          const requestInstance = await requestPromise;\n\n          unsubscribed = true;\n          if (requestInstance.unsubscribe) {\n            return requestInstance.unsubscribe();\n          }\n          return null;\n        }\n      };\n    } else {\n      return promise;\n    }\n  }\n\n  async updateTransportAuthorization() {\n    if (typeof this.apiToken === 'function') {\n      const token = await this.apiToken();\n      if (this.transport.authorization !== token) {\n        this.transport.authorization = token;\n      }\n    }\n  }\n\n  load(query, options, callback) {\n    return this.loadMethod(\n      () => this.request('load', {\n        query,\n        queryType: 'multi'\n      }),\n      (response) => new ResultSet(response, { parseDateMeasures: this.parseDateMeasures }),\n      options,\n      callback\n    );\n  }\n\n  sql(query, options, callback) {\n    return this.loadMethod(\n      () => this.request('sql', { query }),\n      (response) => (Array.isArray(response) ? response.map((body) => new SqlQuery(body)) : new SqlQuery(response)),\n      options,\n      callback\n    );\n  }\n\n  meta(options, callback) {\n    return this.loadMethod(\n      () => this.request('meta'),\n      (body) => new Meta(body),\n      options,\n      callback\n    );\n  }\n\n  dryRun(query, options, callback) {\n    return this.loadMethod(\n      () => this.request('dry-run', { query }),\n      (response) => response,\n      options,\n      callback\n    );\n  }\n\n  subscribe(query, options, callback) {\n    return this.loadMethod(\n      () => this.request('subscribe', {\n        query,\n        queryType: 'multi'\n      }),\n      (body) => new ResultSet(body, { parseDateMeasures: this.parseDateMeasures }),\n      { ...options, subscribe: true },\n      callback\n    );\n  }\n}\n\nexport default (apiToken, options) => new CubejsApi(apiToken, options);\n\nexport { CubejsApi, HttpTransport, ResultSet };\nexport {\n  areQueriesEqual,\n  defaultHeuristics,\n  movePivotItem,\n  isQueryPresent,\n  moveItemInArray,\n  defaultOrder,\n  flattenFilters,\n  getQueryMembers,\n  getOrderMembersFromOrder,\n  GRANULARITIES\n} from './utils';\n"]},"metadata":{},"sourceType":"module"}