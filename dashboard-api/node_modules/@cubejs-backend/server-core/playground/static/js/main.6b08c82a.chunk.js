(this["webpackJsonp@cubejs-client/playground"]=this["webpackJsonp@cubejs-client/playground"]||[]).push([[0],{819:function(e,t,n){"use strict";n.r(t);var r,a,i,o,s,c=n(11),u=n.n(c),l=n(7),d=n(23),b=n(53),p=n(37),h=n.n(p),f=n(46),m=n(93),j=n(74),v=n(75),g=n(104),y=n(103),O=n(13),x=n(0),k=n.n(x),w=(n(244),n(830)),S=n(850),C=n(135),D=n(12),T=n(858),E=n(831),R=n(859),q=n(860),M=n(297),P=n(172),A=n(363),L=n(106),Q=n(1),I=function(){return Object(Q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",fill:"currentColor",children:Object(Q.jsx)("path",{d:"M16.135 0c8.75 0 15.865 7.313 15.865 15.995s-7.104 15.99-15.865 15.99l-16.135 0.016v-16.281c0-8.677 7.375-15.719 16.135-15.719zM16.292 6.083c-3.458-0.005-6.661 1.802-8.448 4.76-1.776 2.943-1.849 6.609-0.198 9.625l-1.781 5.677 6.396-1.432c3.656 1.635 7.953 0.901 10.844-1.854 2.896-2.734 3.818-6.969 2.318-10.661-1.51-3.703-5.12-6.12-9.12-6.115z"})})},z=Object(D.b)(P.a)(r||(r=Object(O.a)(["\n  && {\n    background: transparent;\n    border-bottom: 0;\n  }\n"]))),F=Object(D.b)(P.a.Item)(a||(a=Object(O.a)(["\n  &&& {\n    font-size: 15px;\n    font-weight: 500;\n    line-height: 48px;\n    height: 49px;\n    & > a {\n      &,\n      &:hover {\n        opacity: 0.6;\n        color: white;\n      }\n    }\n    &.ant-menu-item-selected,\n    &.ant-menu-item-active {\n      color: white;\n      border-bottom: 2px solid white;\n\n      &:hover {\n        border-bottom: 2px solid white;\n      }\n\n      a {\n        opacity: 1;\n        color: white;\n      }\n    }\n\n    &:not(.ant-menu-item-selected) {\n      &.ant-menu-item-active,\n      &:hover {\n        color: white;\n        border-bottom: 2px solid white;\n      }\n    }\n  }\n"]))),N=D.b.a(i||(i=Object(O.a)(["\n  &&& {\n    float: right;\n    height: 32px;\n    margin: 8px ",";\n    border: 1px solid rgba(255, 255, 255, 0.35);\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    color: white;\n    transition: all 0.25s ease;\n    padding: 0 10px;\n\n    span {\n      font-size: 14px;\n      margin-right: 10px;\n    }\n\n    &:hover {\n      border-color: white;\n      color: white;\n    }\n  }\n"])),(function(e){return e.noMargin?"0":"8px"})),B=n(16),_=n(857),U=n(849),V=n(843),Y=n(65),J=D.b.div(o||(o=Object(O.a)(["\n  display: flex;\n  flex-direction: ",";\n  justify-content: ",";\n  gap: ",";\n  margin: ",";\n"])),(function(e){return e.direction||"row"}),(function(e){return e.justifyContent||"space-between"}),(function(e){return e.gap?"".concat(8*e.gap,"px"):null}),(function e(t){var n=t.margin;if("string"===typeof n)return n;if("number"===typeof n)return"".concat(8*n,"px");if(Array.isArray(n)){var r=n.length;if(2===r){var a=Object(B.a)(n,2),i=a[0],o=a[1];return"".concat(8*i,"px ").concat(8*o,"px")}if(r>2)return n.fill(0,0,4).map((function(e){return"".concat(8*e)})).join(" ")}if(n&&Object.keys(n||{}).length)return Object.entries(n).map((function(t){var n=Object(B.a)(t,2),r=n[0],a=n[1];return"top"===r?"".concat(e({margin:a})," 0 0 0"):"bottom"===r?"0 0 ".concat(e({margin:a})," 0"):void 0}));return null}));var K=D.b.div(s||(s=Object(O.a)(["\n  align-self: ","\n"])),(function(e){return e.align})),H=n(192),W=n.n(H);var G,$=n(283),Z=n(371),X=n(845),ee=n(841),te=n(842),ne=n(854),re=n(493),ae=n(494),ie=n(212),oe=n(55),se=n(491),ce=n(365),ue=n.n(ce),le={"angular-cli":{files:{"src/polyfills.ts":{content:"import 'core-js/proposals/reflect-metadata';\nimport 'zone.js/dist/zone';"},"src/main.ts":{content:"import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));"},"src/index.html":{content:'<!DOCTYPE html>\n        <html lang="en">\n          <head>\n            <meta charset="utf-8" />\n            <title>AngularCharts</title>\n            <base href="/" />\n            <meta name="viewport" content="width=device-width, initial-scale=1" />\n            <link rel="icon" type="image/x-icon" href="favicon.ico" />\n          </head>\n          <body>\n            <app-root></app-root>\n          </body>\n        </html>\n        '},".angular-cli.json":{content:'{\n          "apps": [\n            {\n              "root": "src",\n              "outDir": "dist",\n              "index": "index.html",\n              "main": "main.ts",\n              "polyfills": "polyfills.ts",\n              "styles": [],\n              "scripts": []\n            }\n          ]\n        }'}},dependencies:{"zone.js":"latest","@angular/platform-browser-dynamic":"latest","@angular/platform-browser":"latest","@angular/compiler":"latest",rxjs:"latest","@angular/common":"latest"}},"create-react-app":{dependencies:{"react-dom":"latest"}}},de={"react-chartjs-2":"chart.js"};function be(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){var r=new CustomEvent("__cubejsPlaygroundEvent",{bubbles:!0,composed:!0,detail:Object(l.a)(Object(l.a)({},n),{},{eventType:t})});e.dispatchEvent(r)}}function pe(e,t,n){return Promise.race([ue()(e,t),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),n)}))])}function he(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(d.a)(u.a.mark((function e(t){var n,r=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"Copied to clipboard",navigator.clipboard||se.a.error({message:"Your browser doesn't support copy to clipboard"}),e.prev=2,e.next=5,navigator.clipboard.writeText(t);case 5:se.a.success({message:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),se.a.error({message:"Can't copy to clipboard",description:e.t0});case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}var me=Z.a.TabPane,je=X.a.TextArea,ve=V.a.Text,ge=V.a.Link,ye=D.b.div(G||(G=Object(O.a)(["\n  display: flex;\n  gap: 8px;\n\n  input {\n    text-overflow: ",";\n  }\n"])),(function(e){return e.editing?"unset":"ellipsis"}));function Oe(){var e=Ce(),t=e.payload,n=e.token,r=e.isModalOpen,a=e.setIsModalOpen,i=e.saveToken,o=e.onTokenPayloadChange,s=ee.a.useForm(),c=Object(B.a)(s,1)[0],l=Object(x.useState)(!1),b=Object(B.a)(l,2),p=b[0],h=b[1],f=Object(x.useState)(!0),m=Object(B.a)(f,2),j=m[0],v=m[1],g=Object(x.useState)(t||""),y=Object(B.a)(g,2),O=y[0],k=y[1],w=Object(x.useState)(!1),S=Object(B.a)(w,2),C=S[0],D=S[1],T=Object(x.useRef)(null);function E(){return(E=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D(!0),e.t0=i,e.next=5,o(Object($.a)(null===t||void 0===t?void 0:t.token),(null===t||void 0===t?void 0:t.token)||null);case 5:e.t1=e.sent,(0,e.t0)(e.t1),e.next=12;break;case 9:e.prev=9,e.t2=e.catch(0),i((null===t||void 0===t?void 0:t.token)||null);case 12:return e.prev=12,h(!1),a(!1),D(!1),e.finish(12);case 17:case"end":return e.stop()}}),e,null,[[0,9,12,17]])})))).apply(this,arguments)}function R(){return(R=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=18;break}if("function"===typeof o){e.next=3;break}throw new Error("Saving token requires the `onTokenPayloadChange` function provided to the `SecurityContext`");case 3:return D(!0),e.prev=4,e.t0=i,e.next=8,o(JSON.parse(O||"{}"),null);case 8:e.t1=e.sent,(0,e.t0)(e.t1),e.next=15;break;case 12:e.prev=12,e.t2=e.catch(4),console.error(e.t2);case 15:D(!1),e.next=19;break;case 18:O||i(null);case 19:a(!1);case 20:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}return Object(x.useEffect)((function(){var e;p&&(null===(e=T.current)||void 0===e||e.focus())}),[p]),Object(x.useEffect)((function(){h(!n),k(t),c.setFieldsValue({token:n})}),[c,n,t]),Object(Q.jsx)(te.a,{title:"Security Context",visible:r,footer:null,bodyStyle:{paddingTop:16},onCancel:function(){a(!1),h(!1)},children:Object(Q.jsx)("div",{"data-testid":"security-context-modal",children:Object(Q.jsxs)(ne.b,{direction:"vertical",size:24,style:{width:"100%"},children:[Object(Q.jsxs)(Z.a,{defaultActiveKey:"json",style:{minHeight:200},onChange:function(e){"token"!==e&&p&&n&&(h(!1),c.resetFields())},children:[Object(Q.jsx)(me,{tab:"JSON",children:Object(Q.jsxs)(ne.b,{direction:"vertical",size:16,style:{width:"100%"},children:[Object(Q.jsx)(je,{"data-testid":"security-context-textarea",value:O||"",rows:6,style:{width:"100%"},onChange:function(e){var t=e.target.value;k(t);try{JSON.parse(t),v(!0)}catch(n){v(!1)}}}),Object(Q.jsx)(Y.a,{"data-testid":"save-security-context-payload-btn",type:"primary",disabled:Boolean(O&&!j),loading:C,onClick:function(){return R.apply(this,arguments)},children:"Save"})]})},"json"),Object(Q.jsx)(me,{"data-testid":"security-modal-token-tab",tab:"Token",children:Object(Q.jsxs)(ne.b,{direction:"vertical",size:16,style:{width:"100%"},children:[Object(Q.jsx)(ve,{type:"secondary",children:"Edit or copy the generated token from below"}),Object(Q.jsx)(ee.a,{form:c,initialValues:{token:n},onFinish:function(e){return E.apply(this,arguments)},children:Object(Q.jsxs)(ye,{editing:p,children:[Object(Q.jsx)(ee.a.Item,{name:"token",style:{width:"auto",flexGrow:1},children:Object(Q.jsx)(X.a,{"data-testid":"security-context-token-input",ref:T,disabled:!p})}),p?Object(Q.jsx)(Y.a,{type:"primary",htmlType:"submit",loading:C,icon:Object(Q.jsx)(ie.a,{})}):Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Y.a,{ghost:!0,type:"primary",icon:Object(Q.jsx)(re.a,{}),onClick:function(){h(!0)}}),Object(Q.jsx)(Y.a,{type:"primary",icon:Object(Q.jsx)(ae.a,{}),disabled:!n,onClick:function(){return he(n)},children:"Copy"})]})]})})]})},"token")]}),Object(Q.jsxs)(ve,{type:"secondary",children:["Learn more about Security Context in"," ",Object(Q.jsx)(ge,{href:"https://cube.dev/docs/security/context",target:"_blank",children:"docs"})]})]})})})}var xe=Object(x.createContext)({}),ke=0,we=null;function Se(e){var t=e.children,n=e.tokenUpdater,r=e.onTokenPayloadChange,a=Mn(),i=qn("cubejsToken",null),o=Object(B.a)(i,3),s=o[0],c=o[1],l=o[2],b=Object(x.useState)(""),p=Object(B.a)(b,2),h=p[0],f=p[1],m=Object(x.useState)(!1),j=Object(B.a)(m,2),v=j[0],g=j[1];function y(){return(y=Object(d.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==s||!n||we===s){e.next=7;break}return we=s,t=ke,e.next=5,n(s);case 5:r=e.sent,a()&&t===ke&&(c(r),ke++);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(x.useEffect)((function(){if(s)try{var e=Object($.a)(s);f(JSON.stringify(e,null,2))}catch(t){f(""),console.error("Invalid JWT token",s)}else f("")}),[s]),Object(Q.jsxs)(xe.Provider,{value:{token:s,payload:h,isModalOpen:v,setIsModalOpen:g,saveToken:function(e){e?c(e):l()},refreshToken:function(){return y.apply(this,arguments)},onTokenPayloadChange:r},children:[t,Object(Q.jsx)(Oe,{})]})}function Ce(){return Object(x.useContext)(xe)}n(383),n(393),n(394),n(395),n(580),n(582),n(583),n(261),n(402),n(403),n(404),n(405),n(591),n(594),n(596),n(412),n(413),n(414),n(415),n(598),n(416),n(421),n(330),n(424),n(609),n(610),n(331),n(613),n(426),n(614),n(427),n(429),n(617);var De=n(73),Te=n.n(De),Ee=n(39),Re=n.n(Ee),qe=n(100),Me=n.n(qe),Pe=n(70),Ae=n.n(Pe),Le=n(76),Qe=n.n(Le),Ie=n(26),ze=n.n(Ie),Fe=n(847),Ne=n(115),Be=n.n(Ne),_e=n(51),Ue=n.n(_e),Ve=n(34),Ye=n.n(Ve),Je=n(142),Ke=n.n(Je),He=n(466),We=n.n(He),Ge=n(487),$e=n(822),Ze=n(823),Xe=n(488),et=n(851),tt=n(206),nt=n(852),rt=n(469),at=n(824),it=n(825),ot=n(826),st=n(827),ct=n(828),ut=n(829),lt=n(853),dt=n(874),bt=n(875),pt=n(846),ht=n(848),ft=n(467),mt=n.n(ft),jt=(n(629),n(111)),vt=n.n(jt),gt=n(196),yt=n.n(gt),Ot=n(128),xt=n.n(Ot),kt=n(468),wt=n.n(kt),St=["query"];function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){Re()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt=[{name:void 0,title:"w/o grouping"},{name:"second",title:"Second"},{name:"minute",title:"Minute"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"year",title:"Year"}];function Et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(Ge.a)(Object.entries(e&&e.order||{}),Object.entries(t&&t.order||{}))&&Object(Ge.a)(e,t)}function Rt(e){var t=(e.timeDimensions||[]).find((function(e){return e.granularity}));return t?Re()({},t.dimension,"asc"):(e.measures||[]).length>0&&(e.dimensions||[]).length>0?Re()({},e.measures[0],"desc"):(e.dimensions||[]).length>0?Re()({},e.dimensions[0],"asc"):{}}function qt(e){return!!e&&(Array.isArray(e)?e:[e]).every((function(e){return e.measures&&e.measures.length||e.dimensions&&e.dimensions.length||e.timeDimensions&&e.timeDimensions.length}))}function Mt(e,t,n,r,a){var i=Dt(Dt({},e),{},{x:Ue()(e.x),y:Ue()(e.y)}),o=e[r][t],s=i[a].length-1;return"measures"===o?n=s+1:n>=s&&"measures"===i[a][s]&&(n=s-1),i[r].splice(t,1),i[a].splice(n,0,o),i}function Pt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){return t.or||t.and?[].concat(Ue()(e),Ue()(Pt(t.or||t.and))):[].concat(Ue()(e),[t])}),[])}function At(e,t,n,r){var a=e.filter((function(e){return null!=e}));return n&&n.aliasSeries&&n.aliasSeries[t]?[n.aliasSeries[t]].concat(Ue()(a)):r.has(a[0])?[t].concat(Ue()(a)):a}var Lt=["x"],Qt=["key"],It=["title","shortTitle"];function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){Re()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ke.a.locale(Ft(Ft({},We.a),{},{weekStart:1}));var Nt={day:function(e){return e.by("d").map((function(e){return e.format("YYYY-MM-DDT00:00:00.000")}))},month:function(e){return e.snapTo("month").by("M").map((function(e){return e.format("YYYY-MM-01T00:00:00.000")}))},year:function(e){return e.snapTo("year").by("y").map((function(e){return e.format("YYYY-01-01T00:00:00.000")}))},hour:function(e){return e.by("h").map((function(e){return e.format("YYYY-MM-DDTHH:00:00.000")}))},minute:function(e){return e.by("m").map((function(e){return e.format("YYYY-MM-DDTHH:mm:00.000")}))},second:function(e){return e.by("s").map((function(e){return e.format("YYYY-MM-DDTHH:mm:ss.000")}))},week:function(e){return e.snapTo("week").by("w").map((function(e){return e.startOf("week").format("YYYY-MM-DDT00:00:00.000")}))}},Bt=/^\d\d\d\d-\d\d-\d\d$/,_t=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z?$/,Ut=function(e){var t=new Map;return function(n){return n.forEach((function(n){var r=e(n);t.has(r)||t.set(r,[]),t.get(r).push(n)})),Array.from(t.entries())}},Vt=function(e){var t=[];return e.forEach((function(e){e.forEach((function(e){return t.push(e)}))})),t},Yt=function e(t,n){return{by:function(e){for(var r=[],a=Ke()(t),i=Ke()(n);a.isBefore(i)||a.isSame(i);)r.push(a),a=a.add(1,e);return r},snapTo:function(r){return e(Ke()(t).startOf(r),Ke()(n).endOf(r))},start:Ke()(t),end:Ke()(n)}},Jt={REGULAR_QUERY:"regularQuery",COMPARE_DATE_RANGE_QUERY:"compareDateRangeQuery",BLENDING_QUERY:"blendingQuery"},Kt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Ae()(this,e),this.loadResponse=t,null!=this.loadResponse.queryType?(this.queryType=t.queryType,this.loadResponses=t.results):(this.queryType=Jt.REGULAR_QUERY,this.loadResponse.pivotQuery=Ft(Ft({},t.query),{},{queryType:this.queryType}),this.loadResponses=[t]),!Object.values(Jt).includes(this.queryType))throw new Error("Unknown query type");this.parseDateMeasures=n.parseDateMeasures,this.options=n,this.backwardCompatibleData=[]}return Qe()(e,[{key:"drillDown",value:function(e,t){if(this.queryType===Jt.COMPARE_DATE_RANGE_QUERY)throw new Error("compareDateRange drillDown query is not currently supported");if(this.queryType===Jt.BLENDING_QUERY)throw new Error("Data blending drillDown query is not currently supported");var n=e.xValues,r=void 0===n?[]:n,a=e.yValues,i=void 0===a?[]:a,o=this.normalizePivotConfig(t),s=[];o.x.forEach((function(e,t){return s.push([e,r[t]])})),o.y.forEach((function(e,t){return s.push([e,i[t]])}));var c=this.query(),u=c.filters,l=void 0===u?[]:u,d=c.segments,b=void 0===d?[]:d,p=this.loadResponses[0].annotation.measures,h=s.find((function(e){return"measures"===Ye()(e,1)[0]}))||[],f=Ye()(h,2)[1];if(void 0===f){var m=Object.keys(p);f=Ye()(m,1)[0]}if(!(p[f]&&p[f].drillMembers||[]).length)return null;var j=[{member:f,operator:"measureFilter"}].concat(Ue()(l)),v=[];s.filter((function(e){return"measures"!==Ye()(e,1)[0]})).forEach((function(e){var t=Ye()(e,2),n=t[0],r=t[1],a=n.split("."),i=Ye()(a,3),o=i[0],s=i[1],c=i[2];if(void 0!==c){var u=Yt(r,r).snapTo(c);v.push({dimension:[o,s].join("."),dateRange:[u.start,u.end].map((function(e){return e.format("YYYY-MM-DDTHH:mm:ss.SSS")}))})}else null==r?j.push({member:n,operator:"notSet"}):j.push({member:n,operator:"equals",values:[r.toString()]})}));var g=this.loadResponses[0].query;return 0===v.length&&g.timeDimensions.length>0&&null==g.timeDimensions[0].granularity&&v.push(g.timeDimensions[0]),Ft(Ft(Ft({},p[f].drillMembersGrouped),{},{filters:j},b.length>0?{segments:b}:{}),{},{timeDimensions:v,segments:b,timezone:g.timezone})}},{key:"series",value:function(e){var t=this;return this.seriesNames(e).map((function(n){var r=n.title,a=n.key;return{title:r,key:a,series:t.chartPivot(e).map((function(e){var t=e.x;return{value:Be()(e,Lt)[a],x:t}}))}}))}},{key:"axisValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.loadResponses[t].query;return function(t){var r=function(n){return e.filter((function(e){return"measures"!==e})).map((function(e){return null!=t[e]?t[e]:null})).concat(n?[n]:[])};return e.find((function(e){return"measures"===e}))&&(n.measures||[]).length?n.measures.map(r):[r()]}}},{key:"axisValuesString",value:function(e,t){return e.map((function(e){return null==e?"\u2205":""===e?"[Empty string]":e})).join(t||", ")}},{key:"normalizePivotConfig",value:function(t){return e.getNormalizedPivotConfig(this.loadResponse.pivotQuery,t)}},{key:"timeSeries",value:function(t,n){if(!t.granularity)return null;var r=t.dateRange;if(!r){var a=e.timeDimensionMember(t),i=Object(et.a)(Object(tt.a)((function(e){return e[a]&&Ke()(e[a])})),Object(nt.a)(Boolean))(this.timeDimensionBackwardCompatibleData(n));r=i.length&&[Object(rt.a)(Object(at.a)((function(e){return e.toDate()})),i[0],i),Object(rt.a)(Object(it.a)((function(e){return e.toDate()})),i[0],i)]||null}if(!r)return null;var o=t.dateRange?t.dateRange.find((function(e){return e.match(Bt)})):!["hour","minute","second"].includes(t.granularity),s=r,c=Ye()(s,2),u=c[0],l=c[1],d=Yt(u,l);if(!Nt[t.granularity])throw new Error("Unsupported time granularity: ".concat(t.granularity));return Nt[t.granularity](o?d.snapTo("d"):d)}},{key:"pivot",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=this.loadResponse.pivotQuery,a=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=Ut((function(e){var t=e.xValues;return n.axisValuesString(t)})),o=function(e,t){return e[t]};if(t.fillMissingDates&&1===t.x.length&&Object(Ge.a)(t.x,(r.timeDimensions||[]).filter((function(e){return Boolean(e.granularity)})).map((function(t){return e.timeDimensionMember(t)})))){var s=n.loadResponses.map((function(e){return n.timeSeries(e.query.timeDimensions[0],a)}));s[0]&&(i=function(e){var t=Object(ot.a)((function(e){return e.xValues[0]}),e);return s[a].map((function(e){return[e,t[e]||[{xValues:[e],row:{}}]]}))},o=function(e,t){return e[t]||0})}var c=Object(et.a)(Object(tt.a)((function(e){return n.axisValues(t.x,a)(e).map((function(t){return{xValues:t,row:e}}))})),Vt,i)(n.timeDimensionBackwardCompatibleData(a)),u={};c.forEach((function(e){Ye()(e,2)[1].forEach((function(e){var r=e.row;n.axisValues(t.y,a)(r).forEach((function(e){Object.keys(r).length>0&&(u[e.join()]=e)}))}))}));var l=Object.values(u),d=Boolean(t.x.find((function(e){return"measures"===e})));return c.map((function(r){var i=Ye()(r,2)[1],s=i[0].xValues,c={};return i.forEach((function(e){var r=e.row;n.axisValues(t.y,a)(r).map((function(e){return{yValues:e,row:r}})).forEach((function(e){c[n.axisValuesString(e.yValues)]=e}))})),{xValues:s,yValuesArray:Vt(l.map((function(t){var r=d?e.measureFromAxis(s):e.measureFromAxis(t);return[[t,o((c[n.axisValuesString(t)]||{row:{}}).row,r)]]})))}}))},i=this.loadResponses.length>1?this.loadResponses.map((function(e,t){return a(t)})):[];return i.length?this.mergePivots(i,t.joinDateRange):a()}},{key:"mergePivots",value:function(e,t){var n=e.reduce((function(e,t){return null!=e&&t.length>=e.length?e:t}),null);return n.map((function(r,a){return{xValues:t?[e.map((function(e){return e[a]&&e[a].xValues||[]})).join(", ")]:n[a].xValues,yValuesArray:Vt(e.map((function(e){return e[a].yValuesArray})))}}))}},{key:"pivotedRows",value:function(e){return this.chartPivot(e)}},{key:"chartPivot",value:function(e){var t=this,n=new Set;this.queryType===Jt.BLENDING_QUERY&&Object(st.a)(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return n.add(e)}));return this.pivot(e).map((function(r){var a=r.xValues,i=r.yValuesArray,o={};return i.forEach((function(r,a){var i,s=Ye()(r,2),c=s[0],u=s[1];o[t.axisValuesString(At(c,a,e,n),",")]=u&&(i=u,t.parseDateMeasures&&_t.test(i)?new Date(i):Number.isNaN(Number.parseFloat(i))?i:Number.parseFloat(i))})),Ft({x:t.axisValuesString(a,","),xValues:a},o)}))}},{key:"tablePivot",value:function(e){var t=this.normalizePivotConfig(e||{}),n=t.x.concat(t.y).includes("measures");return this.pivot(t).map((function(e){var r=e.xValues,a=e.yValuesArray;return Object(ct.a)(t.x.map((function(e,t){return[e,r[t]]})).concat(n?a.map((function(e){var t=Ye()(e,2),n=t[0],r=t[1];return[n.length?n.join():"value",r]})):[]))}))}},{key:"tableColumns",value:function(e){var t=this.normalizePivotConfig(e||{}),n=Object(et.a)(Object(ut.a)("annotation"),Object(rt.a)(Object(lt.a)(),{}))(this.loadResponses),r=Object.values(n).reduce((function(e,t){return Ft(Ft({},e),t)}),{}),a={},i=function(e){var t=r[e]||{};return{key:e,title:t.title,shortTitle:t.shortTitle,type:t.type,format:t.format,meta:t.meta}},o=this.pivot(t);(o[0]&&o[0].yValuesArray||[]).forEach((function(e){var n=Ye()(e,1)[0];if(n.length>0){var r=a;n.forEach((function(e,n){r[e]={key:e,memberId:"measures"===t.y[n]?e:t.y[n],children:r[e]&&r[e].children||{}},r=r[e].children}))}}));var s=[];return!o.length&&t.y.includes("measures")&&(s=(this.loadResponses[0].query.measures||[]).map((function(e){return Ft(Ft({},i(e)),{},{dataIndex:e})}))),!t.y.length&&t.x.includes("measures")&&s.push({key:"value",dataIndex:"value",title:"Value",shortTitle:"Value",type:"string"}),t.x.map((function(e){return"measures"===e?{key:"measures",dataIndex:"measures",title:"Measures",shortTitle:"Measures",type:"string"}:Ft(Ft({},i(e)),{},{dataIndex:e})})).concat(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===Object.keys(t).length?[]:Object.values(t).map((function(t){var r=t.key,a=Be()(t,Qt),o=e(a.children,[].concat(Ue()(n),[r])),s=i(a.memberId),c=s.title,u=s.shortTitle,l=Be()(s,It),d=r!==a.memberId||null==c?r:"";return o.length?Ft(Ft({},l),{},{key:r,title:[c,d].join(" ").trim(),shortTitle:d||u,children:o}):Ft(Ft({},l),{},{key:r,dataIndex:[].concat(Ue()(n),[r]).join(),title:[c,d].join(" ").trim(),shortTitle:d||u})}))}(a)).concat(s)}},{key:"totalRow",value:function(e){return this.chartPivot(e)[0]}},{key:"categories",value:function(e){return this.chartPivot(e)}},{key:"seriesNames",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=Object(et.a)(Object(ut.a)("annotation"),Object(ut.a)("measures"),dt.a)(this.loadResponses),a=Vt(this.loadResponses.map((function(e,r){return Object(et.a)(Object(tt.a)(n.axisValues(t.y,r)),Vt,bt.a)(n.timeDimensionBackwardCompatibleData(r))}))),i=new Set;this.queryType===Jt.BLENDING_QUERY&&Object(st.a)(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return i.add(e)}));return a.map((function(a,o){var s=At(a,o,t,i);return{title:n.axisValuesString(t.y.find((function(e){return"measures"===e}))?Object(pt.a)(1,s).concat(r[e.measureFromAxis(a)].title):s,", "),key:n.axisValuesString(s,","),yValues:a}}))}},{key:"query",value:function(){if(this.queryType!==Jt.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].query}},{key:"pivotQuery",value:function(){return this.loadResponse.pivotQuery||null}},{key:"rawData",value:function(){if(this.queryType!==Jt.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].data}},{key:"annotation",value:function(){if(this.queryType!==Jt.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].annotation}},{key:"timeDimensionBackwardCompatibleData",value:function(t){if(void 0===t)throw new Error("resultIndex is required");if(!this.backwardCompatibleData[t]){var n=this.loadResponses[t],r=n.data,a=(n.query.timeDimensions||[]).filter((function(e){return Boolean(e.granularity)}));this.backwardCompatibleData[t]=r.map((function(t){return Ft(Ft({},t),Object(ct.a)(Object.keys(t).filter((function(n){return a.find((function(e){return e.dimension===n}))&&!t[e.timeDimensionMember(a.find((function(e){return e.dimension===n})))]})).map((function(n){return[e.timeDimensionMember(a.find((function(e){return e.dimension===n}))),t[n]]}))))}))}return this.backwardCompatibleData[t]}},{key:"decompose",value:function(){var t=this;return this.loadResponses.map((function(n){return new e({queryType:Jt.REGULAR_QUERY,pivotQuery:Ft(Ft({},n.query),{},{queryType:Jt.REGULAR_QUERY}),results:[n]},t.options)}))}},{key:"serialize",value:function(){return{loadResponse:Object($e.a)(this.loadResponse)}}}],[{key:"measureFromAxis",value:function(e){return e[e.length-1]}},{key:"timeDimensionMember",value:function(e){return"".concat(e.dimension,".").concat(e.granularity)}},{key:"deserialize",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new e(t.loadResponse,n)}},{key:"getNormalizedPivotConfig",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={x:[],y:[],fillMissingDates:!0,joinDateRange:!1},a=t.measures,i=void 0===a?[]:a,o=t.dimensions,s=void 0===o?[]:o,c=(t.timeDimensions||[]).filter((function(e){return!!e.granularity}));n=n||(c.length?{x:c.map((function(t){return e.timeDimensionMember(t)})),y:s}:{x:s,y:[]});var u=function(n){return n.map((function(n){return c.find((function(e){return e.dimension===n}))&&!s.find((function(e){return e===n}))?e.timeDimensionMember(t.timeDimensions.find((function(e){return e.dimension===n}))):n}))};(n=Object(lt.a)(n,r)).x=u(n.x),n.y=u(n.y);var l=n.x.concat(n.y),d=c.map((function(t){return e.timeDimensionMember(t)})).concat(s),b=function(e){return d.includes(e)||"measures"===e};return n.x=n.x.concat(d.filter((function(e){return!l.includes(e)&&"compareDateRange"!==e}))).filter(b),n.y=n.y.filter(b),n.x.concat(n.y).find((function(e){return"measures"===e}))||n.y.push("measures"),s.includes("compareDateRange")&&!n.y.concat(n.x).includes("compareDateRange")&&n.y.unshift("compareDateRange"),i.length||(n.x=n.x.filter((function(e){return"measures"!==e})),n.y=n.y.filter((function(e){return"measures"!==e}))),n}}]),e}(),Ht=function(){function e(t){Ae()(this,e),this.sqlQuery=t}return Qe()(e,[{key:"rawQuery",value:function(){return this.sqlQuery.sql}},{key:"sql",value:function(){return this.rawQuery().sql[0]}}]),e}(),Wt=function(e){return Object(ct.a)(e.map((function(e){return[e.name,e]})))},Gt={string:[{name:"contains",title:"contains"},{name:"notContains",title:"does not contain"},{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"}],number:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"},{name:"gt",title:">"},{name:"gte",title:">="},{name:"lt",title:"<"},{name:"lte",title:"<="}],time:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"inDateRange",title:"in date range"},{name:"notInDateRange",title:"not in date range"},{name:"afterDate",title:"after date"},{name:"beforeDate",title:"before date"}]},$t=function(){function e(t){Ae()(this,e),this.meta=t;var n=this.meta.cubes;this.cubes=n,this.cubesMap=Object(ct.a)(n.map((function(e){return[e.name,{measures:Wt(e.measures),dimensions:Wt(e.dimensions),segments:Wt(e.segments)}]})))}return Qe()(e,[{key:"membersForQuery",value:function(e,t){return Object(ht.a)(this.cubes.map((function(e){return e[t]}))).sort((function(e,t){return e.title>t.title?1:-1}))}},{key:"membersGroupedByCube",value:function(){var e=["measures","dimensions","segments","timeDimensions"];return this.cubes.reduce((function(t,n){return e.forEach((function(e){var r=n[e];"timeDimensions"===e&&(r=n.dimensions.filter((function(e){return"time"===e.type}))),t[e]=[].concat(Ue()(t[e]),[{cubeName:n.name,cubeTitle:n.title,members:r}])})),t}),{measures:[],dimensions:[],segments:[],timeDimensions:[]})}},{key:"resolveMember",value:function(e,t){var n=this,r=e.split("."),a=Ye()(r,1)[0];if(!this.cubesMap[a])return{title:e,error:"Cube not found ".concat(a," for path '").concat(e,"'")};var i=(Array.isArray(t)?t:[t]).map((function(t){return n.cubesMap[a][t]&&n.cubesMap[a][t][e]})).find((function(e){return e}));return i||{title:e,error:"Path not found '".concat(e,"'")}}},{key:"defaultTimeDimensionNameFor",value:function(e){var t=this,n=e.split("."),r=Ye()(n,1)[0];return this.cubesMap[r]?Object.keys(this.cubesMap[r].dimensions||{}).find((function(e){return"time"===t.cubesMap[r].dimensions[e].type})):null}},{key:"filterOperatorsForMember",value:function(e,t){var n=this.resolveMember(e,t);return Gt[n.type]||Gt.string}}]),e}(),Zt=function(){function e(t){Ae()(this,e),this.progressResponse=t}return Qe()(e,[{key:"stage",value:function(){return this.progressResponse.stage}},{key:"timeElapsed",value:function(){return this.progressResponse.timeElapsed}}]),e}(),Xt=["baseRequestId"];function en(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?en(Object(n),!0).forEach((function(t){Re()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nn=function(){function e(t){var n=t.authorization,r=t.apiUrl,a=t.method,i=t.headers,o=void 0===i?{}:i,s=t.credentials;Ae()(this,e),this.authorization=n,this.apiUrl=r,this.method=a,this.headers=o,this.credentials=s}return Qe()(e,[{key:"request",value:function(e,t){var n=this,r=t.baseRequestId,a=Be()(t,Xt),i=1,o=new URLSearchParams(a&&Object.keys(a).map((function(e){return Re()({},e,"object"===Me()(a[e])?JSON.stringify(a[e]):a[e])})).reduce((function(e,t){return tn(tn({},e),t)}),{})),s="".concat(this.apiUrl,"/").concat(e).concat(o.toString().length?"?".concat(o):""),c=this.method||(s.length<2e3?"GET":"POST");"POST"===c&&(s="".concat(this.apiUrl,"/").concat(e),this.headers["Content-Type"]="application/json");return{subscribe:function(e){var t=this;return Te()(ze.a.mark((function o(){var u;return ze.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,mt()(s,{method:c,headers:tn({Authorization:n.authorization,"x-request-id":r&&"".concat(r,"-span-").concat(i++)},n.headers),credentials:n.credentials,body:"POST"===c?JSON.stringify(a):null});case 2:return u=o.sent,o.abrupt("return",e(u,(function(){return t.subscribe(e)})));case 4:case"end":return o.stop()}}),o)})))()}}}}]),e}();function rn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xt()(e);if(t){var a=xt()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return yt()(this,n)}}var an=function(e){vt()(n,e);var t=rn(n);function n(e,r){var a;return Ae()(this,n),(a=t.call(this,e)).response=r,a}return n}(wt()(Error));function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach((function(t){Re()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var cn=0,un="Mutex has been changed",ln=function(){function e(t,n){if(Ae()(this,e),"object"===Me()(t)&&(n=t,t=void 0),!(n=n||{}).transport&&!n.apiUrl)throw new Error("The `apiUrl` option is required");this.apiToken=t,this.apiUrl=n.apiUrl,this.method=n.method,this.headers=n.headers||{},this.credentials=n.credentials,this.transport=n.transport||new nn({authorization:"function"===typeof t?void 0:t,apiUrl:this.apiUrl,method:this.method,headers:this.headers,credentials:this.credentials}),this.pollInterval=n.pollInterval||5,this.parseDateMeasures=n.parseDateMeasures}return Qe()(e,[{key:"request",value:function(e,t){return this.transport.request(e,sn({baseRequestId:Object(Fe.a)()},t))}},{key:"loadMethod",value:function(e,t,n,r){var a=this,i=++cn;"function"!==typeof n||r||(r=n,n=void 0);var o=(n=n||{}).mutexKey||"default";n.mutexObj&&(n.mutexObj[o]=i);var s=this.updateTransportAuthorization().then((function(){return e()})),c=!1,u=function(){var e=Te()(ze.a.mark((function e(){var t;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s;case 2:if(t=e.sent,!n.mutexObj||n.mutexObj[o]===i){e.next=9;break}if(c=!0,!t.unsubscribe){e.next=8;break}return e.next=8,t.unsubscribe();case 8:throw un;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Te()(ze.a.mark((function e(i,o){var l,d,b,p,h,f,m;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s;case 2:return l=e.sent,d=function(){var e=Te()(ze.a.mark((function e(){return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.subscribe||c){e.next=8;break}if(!l.unsubscribe){e.next=5;break}return e.abrupt("return",o());case 5:return e.next=7,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 7:return e.abrupt("return",o());case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Te()(ze.a.mark((function e(t){return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=5;break}if(!t){e.next=4;break}return e.next=4,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 4:return e.abrupt("return",o());case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=7,a.updateTransportAuthorization();case 7:if(502!==i.status){e.next=11;break}return e.next=10,u();case 10:return e.abrupt("return",b(!0));case 11:return p={},h="",e.prev=13,e.next=16,i.text();case 16:h=e.sent,p=JSON.parse(h),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(13),p.error=h;case 23:if("Continue wait"!==p.error){e.next=28;break}return e.next=26,u();case 26:return n.progressCallback&&n.progressCallback(new Zt(p)),e.abrupt("return",b());case 28:if(200===i.status){e.next=41;break}return e.next=31,u();case 31:if(n.subscribe||!l.unsubscribe){e.next=34;break}return e.next=34,l.unsubscribe();case 34:if(f=new an(p.error,p),!r){e.next=39;break}r(f),e.next=40;break;case 39:throw f;case 40:return e.abrupt("return",d());case 41:return e.next=43,u();case 43:if(n.subscribe||!l.unsubscribe){e.next=46;break}return e.next=46,l.unsubscribe();case 46:if(m=t(p),!r){e.next=51;break}r(null,m),e.next=52;break;case 51:return e.abrupt("return",m);case 52:return e.abrupt("return",d());case 53:case"end":return e.stop()}}),e,null,[[13,20]])})));return function(t,n){return e.apply(this,arguments)}}(),d=s.then((function(e){return function(e){return new Promise((function(t,n){e.then((function(e){return t(e)}),(function(e){return e!==un&&n(e)}))}))}(e.subscribe(l))}));return r?{unsubscribe:function(){var e=Te()(ze.a.mark((function e(){var t;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s;case 2:if(t=e.sent,c=!0,!t.unsubscribe){e.next=6;break}return e.abrupt("return",t.unsubscribe());case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}:d}},{key:"updateTransportAuthorization",value:function(){var e=Te()(ze.a.mark((function e(){var t;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof this.apiToken){e.next=5;break}return e.next=3,this.apiToken();case 3:t=e.sent,this.transport.authorization!==t&&(this.transport.authorization=t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("load",{query:e,queryType:"multi"})}),(function(e){return new Kt(e,{parseDateMeasures:r.parseDateMeasures})}),t,n)}},{key:"sql",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("sql",{query:e})}),(function(e){return Array.isArray(e)?e.map((function(e){return new Ht(e)})):new Ht(e)}),t,n)}},{key:"meta",value:function(e,t){var n=this;return this.loadMethod((function(){return n.request("meta")}),(function(e){return new $t(e)}),e,t)}},{key:"dryRun",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("dry-run",{query:e})}),(function(e){return e}),t,n)}},{key:"subscribe",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("subscribe",{query:e,queryType:"multi"})}),(function(e){return new Kt(e,{parseDateMeasures:r.parseDateMeasures})}),sn(sn({},t),{},{subscribe:!0}),n)}}]),e}(),dn=function(e,t){return new ln(e,t)};var bn=n(83),pn=["retries"];function hn(e){var t=[];return e.forEach((function(e){return e.members.forEach((function(e){t.push([e.name,e])}))})),t}function fn(e){var t={};return Object.entries(e).forEach((function(e){var n=Object(B.a)(e,2),r=n[0];n[1].forEach((function(e){t[e.cubeName]||(t[e.cubeName]={cubeName:e.cubeName,cubeTitle:e.cubeTitle,measures:[],dimensions:[],segments:[],timeDimensions:[]}),e.members.forEach((function(n){t[e.cubeName]=Object(l.a)(Object(l.a)({},t[e.cubeName]),{},Object(oe.a)({},r,[].concat(Object(bn.a)(t[e.cubeName][r]),[n])))}))}))})),Object.values(t)}function mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.retries,r=void 0===n?0:n,a=Object(b.a)(t,pn);return Object(C.a)(e,a).then(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(500!==t.status){e.next=6;break}return e.next=3,t.text();case 3:n=e.sent;try{r=JSON.parse(n),n=r.error}catch(a){}throw n;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(n){if("Network request failed"===n.message&&r>0)return mn(e,{options:t,retries:r-1});throw n}))}function jn(e){return vn.apply(this,arguments)}function vn(){return(vn=Object(d.a)(u.a.mark((function e(t){var n,r,a,i,o,s,c=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:"GET",r=c.length>2&&void 0!==c[2]?c[2]:{},a=r.body,i=r.token,o={},i&&(o.authorization=i),e.next=7,Object(C.a)(t,Object(l.a)({method:n,headers:Object(l.a)({"Content-Type":"application/json"},o)},a?{body:JSON.stringify(a)}:null));case 7:return s=e.sent,e.t0=s.ok,e.next=11,s.json();case 11:return e.t1=e.sent,e.abrupt("return",{ok:e.t0,json:e.t1});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gn(e){var t,n=e.url,r=e.title,a=void 0===r?"":r,i=e.width,o=void 0===i?640:i,s=e.height,c=void 0===s?720:s,u=void 0!==window.screenLeft?window.screenLeft:window.screenX,l=void 0!==window.screenTop?window.screenTop:window.screenY,d=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,b=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,p=d/window.screen.availWidth,h=(d-o)/2/p+u,f=(b-c)/2/p+l,m=window.open(n,a,"\n      scrollbars=yes,\n      width=".concat(o/p,", \n      height=").concat(c/p,", \n      top=").concat(f,", \n      left=").concat(h,"\n    "));return null===m||void 0===m||null===(t=m.focus)||void 0===t||t.call(m),m}var yn=Object(x.createContext)(null);function On(e){var t=e.disabled,n=void 0!==t&&t,r=e.children,a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(x.useRef)(!1),n=Object(x.useState)(null),r=Object(B.a)(n,2),a=r[0],i=r[1],o=Object(x.useState)({loading:!0,active:!1,deploymentUrl:null}),s=Object(B.a)(o,2),c=s[0],b=s[1];Object(x.useEffect)((function(){if(!e){var t=setInterval((function(){p()}),5e3);return p(),function(){clearInterval(t)}}}),[]),Object(x.useEffect)((function(){c.loading||t.current===c.active||f(),t.current=c.active}),[t,c.active,c.loading]);var p=function(){return fetch("/playground/live-preview/status").then((function(e){return e.json()})).then((function(e){b(Object(l.a)({loading:!1},e))}))},h=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/live-preview/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===c||void 0===c?void 0:c.active)){e.next=8;break}return e.next=3,h({});case 3:t=e.sent,n=t.token,i({token:(null===n||void 0===n?void 0:n.token)||null,apiUrl:(null===c||void 0===c?void 0:c.deploymentUrl)||null}),e.next=9;break;case 8:i(null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{credentials:a,statusLivePreview:c,createTokenWithPayload:h,stopLivePreview:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/live-preview/stop");case 2:return e.next=4,p();case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),startLivePreview:function(){return new Promise((function(e,t){var n=encodeURIComponent(window.location.origin),r="http://localhost:4000"!==window.location.origin&&new URLSearchParams({callbackUrl:n}).toString(),a=gn({url:"https://cubecloud.dev/auth/live-preview".concat(r?"?".concat(r):"")});if(!a)return console.error("The popup was blocked by the browser"),void t();var i=setInterval((function(){a.closed&&(clearInterval(i),e(!0),p())}),1e3)}))}}}(n);return Object(Q.jsx)(yn.Provider,{value:Object(l.a)(Object(l.a)({},a),{},{livePreviewDisabled:n}),children:r})}function xn(){return Object(x.useContext)(yn)}var kn=n(470),wn=["children"],Sn=Object(x.createContext)({});function Cn(e){var t=e.children,n=Object(b.a)(e,wn),r=Object(x.useState)(n||null),a=Object(B.a)(r,2),i=a[0],o=a[1],s=Object(x.useCallback)((function(e){o((function(t){return Object(l.a)(Object(l.a)(Object(l.a)({},t),e),{},{playgroundContext:Object(l.a)(Object(l.a)({},null===t||void 0===t?void 0:t.playgroundContext),null===e||void 0===e?void 0:e.playgroundContext)})}))}),[]);return Object(Q.jsx)(Sn.Provider,{value:Object(l.a)(Object(l.a)({apiUrl:null,schemaVersion:0,ready:!1},i),{},{token:(null===i||void 0===i?void 0:i.token)||null,playgroundContext:(null===i||void 0===i?void 0:i.playgroundContext)||{},setContext:s}),children:t})}function Dn(e){var t=e.onReady,n=Tn();return Object(x.useEffect)((function(){t(n)}),[n]),null}function Tn(){return Object(x.useContext)(Sn)}function En(){return Tn().playgroundContext}var Rn=new(function(){function e(){var t=this;Object(j.a)(this,e),this.emitter=Object(kn.a)(),window.addEventListener("storage",(function(e){if(e.oldValue!==e.newValue){var n;try{n=JSON.parse(e.newValue||"")}catch(r){n=e.newValue}t.emit(e.key,n)}}))}return Object(v.a)(e,[{key:"emit",value:function(e,t){this.emitter.emit(e,t)}},{key:"subscribe",value:function(e,t){this.emitter.on(e,t)}},{key:"unsubscribe",value:function(e,t){this.emitter.off(e,t)}},{key:"setItem",value:function(e,t){if(void 0===t)localStorage.removeItem(e);else{var n=JSON.stringify(t);localStorage.setItem(e,n)}this.emit(e,t)}},{key:"getItem",value:function(e,t){try{var n=localStorage.getItem(e),r="string"===typeof n?JSON.parse(n):void 0;return"function"===typeof t?t(r):void 0!==r?r:t}catch(a){return"function"===typeof t?t(null):t}}},{key:"removeItem",value:function(e){this.setItem(e,void 0)}}]),e}());function qn(e,t){var n=Tn().identifier||"",r=[e,n?":":"",n].join(""),a=function(){return Rn.getItem(r,t)},i=Object(x.useState)(a),o=Object(B.a)(i,2),s=o[0],c=o[1];return Object(x.useEffect)((function(){return c(a),Rn.subscribe(r,(function(e){c("function"===typeof t?t(e):e||t)})),function(){Rn.unsubscribe(r,c)}}),[r]),Object(x.useMemo)((function(){return[s,function(e){return Rn.setItem(r,e),e},function(){Rn.removeItem(r)}]}),[r,s])}function Mn(){var e=Object(x.useRef)(!0),t=Object(x.useCallback)((function(){return e.current}),[]);return Object(x.useEffect)((function(){return function(){e.current=!1}}),[]),t}function Pn(e){var t=Object(x.useRef)();return W()(t.current,e)||(t.current=e),t.current}function An(e,t){var n=Pn(t);return Object(x.useEffect)(e,n)}function Ln(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(x.useState)(e),n=Object(B.a)(t,2),r=n[0],a=n[1];return[r,function(){return a((function(e){return!e}))}]}var Qn,In=["label","value","onCopyClick"],zn=Object(D.b)(Y.a)(Qn||(Qn=Object(O.a)(["\n  border: none;\n  color: var(--primary-1);\n"])));function Fn(e){var t=e.label,n=e.value,r=e.onCopyClick,a=Object(b.a)(e,In),i=Object(Q.jsx)(zn,{"data-testid":"localhost-tipbox-".concat(null===t||void 0===t?void 0:t.toLowerCase(),"-copy-btn"),icon:Object(Q.jsx)(ae.a,{}),onClick:function(){return n&&r(n.toString())}});return Object(Q.jsx)(ee.a.Item,{label:t?Object(Q.jsx)("b",{children:t}):null,labelCol:{span:24},wrapperCol:{span:24},children:Object(Q.jsx)(X.a,Object(l.a)({"data-testid":"localhost-tipbox-".concat(null===t||void 0===t?void 0:t.toLowerCase(),"-input"),value:n,suffix:i},a))})}var Nn=n(79),Bn=n(208);function _n(e){var t=e.status,n=e.uploading,r={loading:Object(Q.jsx)(Nn.a,{spin:!0}),inProgress:Object(Q.jsx)(Nn.a,{spin:!0}),running:Object(Q.jsx)(Bn.a,{})};return n?r.loading:r[t]||r.loading}var Un;function Vn(){var e,t=xn(),n=Object(x.useState)(!1),r=Object(B.a)(n,2),a=r[0],i=r[1];if(!t||(null===t||void 0===t?void 0:t.livePreviewDisabled))return null;var o=t.statusLivePreview,s=o.active,c=o.status,l=o.uploading,b=Object(Q.jsxs)(N,{"data-testid":"live-preview-btn",onClick:function(){console.log({active:s}),s||t.startLivePreview()},children:[s?Object(Q.jsx)(_n,{status:c,uploading:l}):Object(Q.jsx)(_.a,{}),s?"Running":"Run"," on Cube Cloud"]});return s?Object(Q.jsx)(M.a,{overlay:Object(Q.jsx)(Yn,{livePreviewStatus:t.statusLivePreview,apiUrl:(null===(e=t.credentials)||void 0===e?void 0:e.apiUrl)||"",loading:a,onStopClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,t.stopLivePreview();case 3:i(!1);case 4:case"end":return e.stop()}}),e)})))}),trigger:["click"],children:b}):b}function Yn(e){var t=e.livePreviewStatus,n=e.apiUrl,r=e.loading,a=e.onStopClick,i=t.url,o=t.deploymentId;return Object(Q.jsx)(U.a,{style:{maxWidth:600},children:Object(Q.jsxs)(J,{direction:"column",gap:2,children:[Object(Q.jsxs)(V.a.Paragraph,{children:["Playground uses the following API URL to execute queries on Cloud. You can use this API to test queries in your application."," ",Object(Q.jsx)(V.a.Link,{href:"https://cube.dev/docs/cloud",target:"_blank",children:"Learn more"})," ","on developing and testing with Cube Cloud."]}),Object(Q.jsx)(Fn,{value:n,onCopyClick:he}),Object(Q.jsx)(K,{children:Object(Q.jsxs)(J,{justifyContent:"space-between",children:[Object(Q.jsx)(Y.a,{type:"primary",target:"_blank",href:"".concat(i,"/deployments/").concat(o,"/history"),children:"Inspect querires"}),Object(Q.jsx)(Y.a,{type:"primary",danger:!0,loading:r,onClick:a,children:"Stop"})]})})]})})}var Jn=Object(D.b)(w.a.Header)(Un||(Un=Object(O.a)(["\n  && {\n    background-color: var(--dark-02-color);\n    color: white;\n    padding: 0 16px;\n    line-height: 44px;\n    height: 48px;\n  }\n"])));function Kn(e){var t=e.selectedKeys,n=Object(A.useMediaQuery)({query:"(min-device-width: 992px)"}),r=Object(A.useMediaQuery)({query:"(max-device-width: 991px)"});return Object(Q.jsxs)(Jn,{children:[Object(Q.jsx)("div",{style:{float:"left"},children:Object(Q.jsx)("img",{src:"./cubejs-playground-logo.svg",style:{height:28,marginRight:28},alt:""})}),n&&Object(Q.jsxs)(z,{theme:"light",mode:"horizontal",selectedKeys:t,children:[Object(Q.jsx)(F,{children:Object(Q.jsx)(L.a,{to:"/build",children:"Build"})},"/build"),Object(Q.jsx)(F,{children:Object(Q.jsx)(L.a,{to:"/dashboard",children:"Dashboard App"})},"/dashboard"),Object(Q.jsx)(F,{children:Object(Q.jsx)(L.a,{to:"/schema",children:"Schema"})},"/schema"),Object(Q.jsxs)(N,{href:"https://slack.cube.dev",target:"_blank",children:[Object(Q.jsx)(T.a,{}),"Slack"]},"slack"),Object(Q.jsxs)(N,{noMargin:!0,href:"https://forum.cube.dev/",target:"_blank",children:[Object(Q.jsx)(E.a,{component:function(){return Object(Q.jsx)(I,{})}}),"Discourse"]},"discourse"),Object(Q.jsxs)(N,{href:"https://cube.dev/docs",target:"_blank",children:[Object(Q.jsx)(R.a,{}),"Docs"]},"docs"),Object(Q.jsx)(Vn,{})]}),r&&Object(Q.jsx)("div",{style:{float:"right"},children:Object(Q.jsx)(M.a,{overlay:Object(Q.jsxs)(P.a,{children:[Object(Q.jsx)(P.a.Item,{children:Object(Q.jsx)(L.a,{to:"/build",children:"Build"})},"/build"),Object(Q.jsx)(P.a.Item,{children:Object(Q.jsx)(L.a,{to:"/dashboard",children:"Dashboard App"})},"/dashboard"),Object(Q.jsx)(P.a.Item,{children:Object(Q.jsx)(L.a,{to:"/schema",children:"Schema"})},"/schema")]}),children:Object(Q.jsx)(q.a,{})})})]})}var Hn={pink:"255, 100, 146",purple:"122, 119, 255","purple-03":"175, 173, 255","purple-04":"202, 201, 255",text:"91, 92, 125","dark-01":"20, 20, 70","dark-02":"67, 67, 107","dark-03":"114, 114, 144","dark-04":"161, 161, 181","dark-05":"213, 213, 226",light:"243, 243, 251",green:"65, 181, 111",yellow:"251, 188, 5",gray:"246, 246, 248"};function Wn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"rgba(".concat(Hn[e],", ").concat(t,")")}var Gn={"active-bg":Wn("purple",.1),"primary-bg":Wn("purple",.1),"primary-1":Wn("purple",.9),"primary-2":Wn("purple",.8),"primary-3":Wn("purple",.7),"primary-4":Wn("purple",.6),"primary-5":Wn("purple",.5),"primary-6":Wn("purple",.4),"primary-7":Wn("purple",.3),"primary-8":Wn("purple",.2),"primary-9":Wn("purple",.1),"primary-10":Wn("purple",0),"light-5":Wn("light",.5),"remove-btn-bg":Wn("purple",.1),"remove-btn-hover-bg":Wn("purple",.2),"primary-color":Wn("purple"),"success-bg-color":Wn("green",.1),"success-color":Wn("green",.9),"warning-bg-color":Wn("yellow",.1),"warning-color":Wn("yellow",.9),"pink-8":Wn("pink",.2),"pink-9":Wn("pink",.1),"heading-color":Wn("dark",.65),"link-color":Wn("purple"),"info-color":Wn("purple"),"layout-body-background":"#f6f6f8;","layout-header-background":"#eeeef5","menu-highlight-color":Wn("dark-01"),"item-hover-bg":Wn("light"),"layout-header-height":"48px","font-family":'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", "Avenir Next", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',"menu-item-font-size":"15px","btn-primary-shadow":"none","btn-text-shadow":"none","modal-body-padding":"32px","form-item-margin-bottom":"23px","disabled-color":Wn("dark-01",.25),"disabled-bg":Wn("dark-05",.2),"menu-item-active-bg":Wn("light"),"font-size-base":"14px","border-radius-base":"4px","padding-lg":"16px"};Object.keys(Hn).forEach((function(e){return Gn["".concat(e,"-color")]=Wn(e)}));var $n,Zn={},Xn={};Object.keys(Gn).forEach((function(e){Zn["@".concat(e)]=Gn[e]})),Object.keys(Gn).forEach((function(e){Xn["--".concat(e)]=Gn[e]}));var er,tr,nr=Object(D.a)($n||($n=Object(O.a)(["\n  body {\n    ",'\n  }\n\n  body {\n    margin: 0;\n    padding: 0;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    background: var(--layout-body-background);\n    overflow-x: hidden;\n  }\n\n  .inline-code {\n    margin: 0 1px;\n    padding: 0.2em 0.4em;\n    font-size: 0.9em;\n    background: #f2f4f5;\n    border: 1px solid #eee;\n    border-radius: 3px;\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-track {\n    background: var(--light-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-thumb {\n    border-radius: 4px;\n    background: var(--dark-03-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  } \n  \n  .schema-sidebar .ant-tabs-top-bar {\n    padding: 0 16px;\n  }\n  \n  .schema-sidebar .ant-menu {\n    border: 0;\n  }\n  \n  .ant-layout {\n    height: 100%;\n    background: var(--layout-body-background);\n  }\n  \n  .ant-layout-header .ant-menu {\n    height: 100%;\n  }\n  \n  .ant-menu-horizontal .ant-menu-item {\n    top: 0;\n    height: 100%;\n  }\n  \n  .ant-select-item.ant-select-item-option-selected:not(.ant-select-item-option-disabled) {\n    color: white;\n  }\n  \n  .ant-popover .ant-popover-inner-content {\n    padding: 0;\n  }\n  \n  \n  code[class*="language-"],\n  pre[class*="language-"] {\n    color: var(--dark-01-color);\n    background: none;\n    /*text-shadow: 0 1px white;*/\n    font-family: "Roboto Mono", Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;\n    text-align: left;\n    font-weight: normal;\n    font-size: 14px;\n    line-height: 20px;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    border-radius: 4px;\n    border: none;\n  \n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n  \n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, "Courier New",\n    monospace;\n  }\n\n  .schema-sidebar,\n  .schema-sidebar .ant-tabs,\n  .schema-sidebar .ant-tabs-content {\n    height: 100%;\n  }\n\n  .schema-sidebar {\n    background: #fff;\n    border-right: 1px solid #eee;\n    padding: 0;\n  }\n\n  .schema-sidebar .ant-tabs-tabpane {\n    /* TODO: replace with flexbox */\n    height: 85%;\n    overflow: auto;\n  }\n\n  .ant-popover-disabled-compatible-wrapper {\n    pointer-events: none;\n  }\n  \n  pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,\n  code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  pre[class*="language-"]::selection, pre[class*="language-"] ::selection,\n  code[class*="language-"]::selection, code[class*="language-"] ::selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  @media print {\n    code[class*="language-"],\n    pre[class*="language-"] {\n      text-shadow: none;\n    }\n  }\n  \n  /* Code blocks */\n  pre[class*="language-"] {\n    padding: 1em;\n    overflow: auto;\n  }\n  \n  :not(pre) > code[class*="language-"],\n  pre[class*="language-"] {\n    background: transparent;\n  }\n  \n  /* Inline code */\n  :not(pre) > code[class*="language-"] {\n    padding: .1em;\n    border-radius: .3em;\n    white-space: normal;\n  }\n  \n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: var(--dark-04-color);\n  }\n  \n  .token.punctuation {\n    color: var(--dark-04-color);\n  }\n  \n  .namespace {\n    opacity: .7;\n  }\n  \n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: var(--pink-color);\n  }\n  \n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: var(--purple-color);\n  }\n  \n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.keyword {\n    font-weight: 500;\n  }\n  \n  .token.function,\n  .token.class-name {\n    color: var(--pink-color);\n  }\n  \n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: var(--pink-color);\n  }\n  \n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  \n  .token.italic {\n    font-style: italic;\n  }\n  \n  .token.entity {\n    cursor: help;\n  }\n  \n  .missing-member-tooltip {\n    max-width: none;\n  }\n  \n  .ant-btn-link > span {\n    text-decoration: underline;\n  }\n  \n  a.ant-typography {\n    text-decoration: underline;\n  }\n  \n  .ant-notification {\n    z-index: 9999;\n  }\n'])),Object.entries(Xn).map((function(e){var t=Object(B.a)(e,2),n=t[0],r=t[1];return"".concat(n,": ").concat(r,";")})).join("\n    ")),rr={error:{border:"#FFCCC7",background:"rgb(255, 100, 109, 0.05)",color:"#EF404A"},warning:{border:"#FFE58F",background:"#FFFBE6"},info:{border:"#91D5FF",background:"#E6F7FF"},success:{border:"#B7EB8F",background:"#F6FFED"}},ar=Object(D.b)(S.a)(er||(er=Object(O.a)(["\n  && {\n    background: ",";\n    border: 1px solid ",";\n    color: ",";\n    box-sizing: border-box;\n    border-radius: 2px;\n  }\n"])),(function(e){return rr[e.type||"info"].background}),(function(e){return rr[e.type||"info"].border}),(function(e){var t;return(null===(t=rr[e.type||""])||void 0===t?void 0:t.color)||"inherit"})),ir=[[49,.5],[0,25],[49,49],[98,25]];function or(e){return"transform: translate(".concat(ir[e][0],"%, ").concat(ir[e][1],"%);")}var sr,cr=D.b.img((function(e){var t=e.index;return"\n  display: block;\n  position: absolute;\n  width: 50%;\n  height: 50%;\n  \n  ".concat(null!=t?"\n  animation-name: dice".concat(t,";\n  animation-duration: 2s;\n  animation-iteration-count: infinite;\n  animation-timing-function: ease;\n  z-index: 0;\n  \n  @keyframes dice").concat(t," {\n    ").concat(0===t?"\n    from {\n      ".concat(or(0),"\n      z-index: 0;\n    }\n    \n    25% {\n      ").concat(or(0),"\n      z-index: 0;\n    }\n    \n    50% {\n      ").concat(or(1),"\n      z-index: 0;\n    }\n    \n    51% {\n      z-index: 1;\n    }\n    \n    75% {\n      z-index: 1;\n    }\n\n    to {\n      ").concat(or(1),"\n      z-index: 1;\n    }\n    "):"","\n    \n    ").concat(1===t?"\n    from {\n      ".concat(or(1),"\n      z-index: 3;\n    }\n    \n    25% {\n      ").concat(or(2),"\n      z-index: 3;\n    }\n    \n    75% {\n      ").concat(or(2),"\n      z-index: 2;\n    }\n    \n    to {\n      ").concat(or(3),"\n      z-index: 1;\n    }\n    "):"","\n    \n    ").concat(2===t?"\n    from {\n      ".concat(or(3),"\n      z-index: 1;\n    }\n    \n    50% {\n      ").concat(or(3),"\n      z-index: 0;\n    }\n    \n    75% {\n      ").concat(or(0),"\n      z-index: 0;\n    }\n\n    to {\n      ").concat(or(0),"\n      z-index: 0;\n    }\n    "):"","\n  }\n  "):"","\n")})),ur=function(e){return Object(Q.jsx)(cr,Object(l.a)({role:"presentation",src:"data:image/svg+xml,%3Csvg width='36' height='41' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M35.899 10.351l-18 10.25L.1 10.25l18-10.25L35.9 10.351z' fill='%23FAFAFF'/%3E%3Cpath d='M18 41L0 30.75l.101-20.5L18 20.5' fill='%23E5E5F6'/%3E%3Cpath d='M36 30.75L18 41V20.6l17.899-10.25L36 30.75z' fill='%23C0C0EA'/%3E%3C/svg%3E",alt:""},e))},lr=D.b.div(tr||(tr=Object(O.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n"])));function dr(e){var t=e.size,n=void 0===t?80:t,r=e.full,a=void 0===r||r,i=Object(Q.jsxs)("div",{"data-testid":"cube-loader",role:"img","aria-label":"Loading animation",style:{position:"relative",width:n,height:1.1388888889*n,margin:"0 auto"},children:[Object(Q.jsx)(ur,{style:{transform:"translate(0%, 72.5%)"}}),Object(Q.jsx)(ur,{style:{transform:"translate(98%, 72.5%)"}}),Object(Q.jsx)(ur,{style:{transform:"translate(49%, 96.5%)"}}),Object(Q.jsx)(ur,{index:0}),Object(Q.jsx)(ur,{index:1}),Object(Q.jsx)(ur,{index:2})]},"loader");return a?Object(Q.jsx)(lr,{children:i}):i}var br,pr,hr=V.a.Text,fr=V.a.Paragraph,mr=D.b.pre(sr||(sr=Object(O.a)(["\n  padding: 0.4em 0.8em;\n  font-size: 13px;\n  white-space: pre-wrap;\n  margin: 0;\n"])));function jr(e){var t=e.error;return Object(Q.jsxs)(ne.b,{direction:"vertical",children:[Object(Q.jsx)(hr,{strong:!0,style:{fontSize:18},children:"Error \ud83d\ude22"}),Object(Q.jsxs)(fr,{children:["Ask about it in"," ",Object(Q.jsx)("a",{href:"https://slack.cube.dev",target:"_blank",rel:"noopener noreferrer",children:"Slack"}),". These guys know how to fix this for sure!"]}),Object(Q.jsx)(ar,{type:"error",message:Object(Q.jsx)(mr,{dangerouslySetInnerHTML:{__html:t.toString().replace(/(Error:\s){2,}/g,"")}})})]})}var vr,gr=Object(D.b)(Y.a)(br||(br=Object(O.a)(["\n  &&:not(.ant-btn-link) {\n    padding: 5px 12px;\n    height: auto;\n    border-color: var(--dark-05-color);\n    color: var(--text-color);\n    box-shadow: none;\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n\n    &:disabled {\n      color: var(--disabled-color);\n      border-color: var(--disabled-color);\n      background-color: white;\n\n      &:hover,\n      &:active,\n      &:focus {\n        color: var(--disabled-color);\n        border-color: var(--disabled-color);\n      }\n    }\n\n    &.ant-btn-primary:not([disabled]) {\n      background: var(--primary-color);\n      color: white;\n      border-color: var(--primary-color);\n      place-self: center;\n    }\n\n    &.ant-btn-background-ghost:not([disabled]) {\n      color: var(--primary-color);\n    }\n\n    &.ant-btn-icon-only {\n      display: inline-flex;\n      place-items: center;\n      padding: 5px 8px;\n      font-size: 14px;\n\n      svg {\n        width: 15px;\n        height: 14px;\n      }\n    }\n\n    .anticon {\n      display: inline-block;\n      height: 14px;\n    }\n\n    &.ant-btn-sm {\n      padding: 0 8px;\n      height: 24px !important;\n    }\n  }\n"])));gr.Group=Object(D.b)(Y.a.Group)(pr||(pr=Object(O.a)(["\n  &&& .ant-btn-primary:not([disabled]) {\n    background-color: var(--primary-bg);\n    color: var(--primary-color);\n    border: 1px solid var(--primary-color);\n\n    &:not(:first-child):not(:last-child) {\n      border-left-color: var(--primary-color);\n      border-right-color: var(--primary-color);\n    }\n\n    &:first-child {\n      border-right-color: var(--primary-color);\n    }\n\n    &:last-child {\n      border-left-color: var(--primary-color);\n    }\n  }\n\n  &&\n    .ant-btn-primary:not([disabled])\n    + .ant-btn:not(.ant-btn-primary):not([disabled]) {\n    border-left-color: var(--primary-color);\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-left-color: var(--primary-color);\n    }\n  }\n\n  &&& .ant-btn:disabled {\n    background-color: var(--disabled-bg);\n  }\n"])));var yr,Or,xr,kr=Object(D.b)(U.a)(vr||(vr=Object(O.a)(["\n  && {\n    border-radius: 8px;\n    border: none;\n\n    .ant-card-head {\n      border-bottom: 1px solid #d7d7f488;\n      padding: 8px 16px;\n    }\n\n    .ant-card-head-title {\n      padding: 0;\n      flex: initial;\n    }\n\n    .ant-card-extra {\n      padding: 0;\n    }\n\n    .ant-card-head-wrapper {\n      flex-flow: row wrap;\n      place-content: space-between;\n    }\n\n    .ant-card-head-title {\n      font-size: 18px;\n      line-height: 40px;\n    }\n\n    .ant-card-body {\n      padding: 16px;\n    }\n  }\n"]))),wr=n(855),Sr=Object(D.b)(wr.a)(yr||(yr=Object(O.a)(["\n  && {\n    .ant-popover-inner-content {\n      padding: 0;\n    }\n  }\n"]))),Cr=n(369),Dr=n.n(Cr),Tr=function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return Object(v.a)(n,[{key:"componentDidMount",value:function(){Dr.a.highlightAll()}},{key:"componentDidUpdate",value:function(){Dr.a.highlightAll()}},{key:"render",value:function(){return Object(Q.jsx)("pre",{"data-testid":"prism-code",style:this.props.style,children:Object(Q.jsx)("code",{className:"language-".concat(this.props.language||"javascript"),children:this.props.code})})}}]),n}(x.Component),Er=D.b.div(Or||(Or=Object(O.a)(["\n  display: flex;\n  border-radius: 4px;\n  background: var(--layout-body-background);\n  width: 100%;\n  max-width: 100%;\n"]))),Rr=D.b.div(xr||(xr=Object(O.a)(["\n  position: relative;\n\n  button,\n  button:hover,\n  button:focus {\n    border: none;\n    background: none;\n    box-shadow: none;\n    outline: none;\n    color: var(--primary-color);\n  }\n\n  [ant-click-animating-without-extra-node]:after {\n    animation: none !important;\n  }\n\n  ::after {\n    display: block;\n    content: '';\n    width: 16px;\n    position: absolute;\n    left: -16px;\n    top: 0;\n    bottom: 0;\n    background: linear-gradient(\n      to right,\n      rgba(246, 246, 248, 0),\n      rgba(246, 246, 248, 1)\n    );\n  }\n"])));function qr(e){var t=e.code,n=e.language,r=e.style;return Object(Q.jsxs)(Er,{style:r,children:[Object(Q.jsx)(Tr,{code:t,language:n,style:{flexGrow:1}}),Object(Q.jsx)(Rr,{children:Object(Q.jsx)(Y.a,{icon:Object(Q.jsx)(ae.a,{}),onClick:function(){return he(t,"Pre-aggregation code is copied")}})})]})}var Mr,Pr,Ar=n(370),Lr=n.n(Ar),Qr=null,Ir=[],zr={sentFrom:"frontend"},Fr=null,Nr=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===Mr){e.next=2;break}return e.abrupt("return");case 2:return(n=localStorage.getItem("playground_anonymous"))||(n=Lr.a.get("playground_anonymous")||Object(Fe.a)().toString(),localStorage.setItem("playground_anonymous",n),Lr.a.remove("playground_anonymous")),Ir.push(Object(l.a)(Object(l.a)(Object(l.a)({},zr),t),{},{id:Object(Fe.a)(),clientAnonymousId:n,clientTimestamp:(new Date).toJSON()})),r=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,i=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:10,t||(t=Ir,Ir=[]),t.length){e.next=4;break}return e.abrupt("return",null);case 4:return e.prev=4,a=(new Date).toJSON(),e.next=8,Object(C.a)("https://track.cube.dev/track",{method:"post",body:JSON.stringify(t.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{sentAt:a})}))),headers:{"Content-Type":"application/json"}});case 8:if(!(200!==e.sent.status&&n>0)){e.next=11;break}return e.abrupt("return",r(t,n-1));case 11:e.next=17;break;case 13:if(e.prev=13,e.t0=e.catch(4),!(n>0)){e.next=17;break}return e.abrupt("return",r(t,n-1));case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),a=(Qr||Promise.resolve()).then((function(){return r()})).then((function(){a===Qr&&(Qr=null)})),Qr=a,e.abrupt("return",Qr);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Br=function(e,t){var n;zr=Object(l.a)(Object(l.a)({},zr),t),null===(n=Fr)||void 0===n||n(Object(l.a)({event:"identify",anonymousId:e},t),Mr)},_r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=Fr)||void 0===t||t(Object(l.a)({event:e},n),Mr)},Ur=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_r("Playground Action",Object(l.a)({name:e},t))},Vr=Object(D.b)(w.a.Content)(Pr||(Pr=Object(O.a)(["\n  height: 100%;\n"]))),Yr=function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(){var e;Object(j.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={fatalError:null,context:null,showLoader:!1,isAppContextSet:!1},e}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,r=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout((function(){return r.setState({showLoader:!0})}),700),window.addEventListener("unhandledrejection",(function(e){var t=e.reason;console.log(t);var n=(t.stack||t).toString();_r("Playground Error",{error:n})})),e.next=4,Object(C.a)("/playground/context");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,a=n.telemetry,Mr=a,Fr=Nr,Br(n.anonymousId,{coreServerVersion:n.coreServerVersion,projectFingerprint:n.projectFingerprint,isDocker:Boolean(n.isDocker),dockerVersion:n.dockerVersion}),this.setState({context:n});case 12:case"end":return e.stop()}var a}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidCatch",value:function(e,t){_r("Playground Error",{error:(e.stack||e).toString(),info:t.toString()})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.location,a=n.children,i=this.state,o=i.context,s=i.fatalError,c=i.isAppContextSet,u=i.showLoader;return null==o||c?null!=o||c?(s&&console.log(s.stack),Object(Q.jsx)(On,{disabled:null==o.livePreview||!o.livePreview,children:Object(Q.jsxs)(w.a,{children:[Object(Q.jsx)(nr,{}),Object(Q.jsx)(Kn,{selectedKeys:(e=r.pathname,"/template-gallery"===e?["/dashboard"]:[e])}),Object(Q.jsx)(Vr,{children:s?Object(Q.jsx)(S.a,{message:"Error occured while rendering",description:s.stack||"",type:"error"}):a})]})})):u?Object(Q.jsx)(dr,{}):null:Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Jr,{context:o}),Object(Q.jsx)(Dn,{onReady:function(){return t.setState({isAppContextSet:!0})}})]})}}],[{key:"getDerivedStateFromError",value:function(e){return{fatalError:e}}}]),n}(x.Component);function Jr(e){var t=e.context,n=Tn().setContext;return Object(x.useEffect)((function(){null!==t&&n({ready:!0,playgroundContext:Object(l.a)(Object(l.a)({},t),{},{isCloud:!1}),identifier:t.identifier})}),[t]),null}var Kr,Hr,Wr,Gr,$r,Zr,Xr=Object(f.g)(Yr),ea=n(471),ta=function(e,t,n){return mn(e,Object(l.a)(Object(l.a)({},t),{},{retries:n}))},na=function(){function e(){Object(j.a)(this,e),this.loadError=null,this.dashboardCreated=!1,this.installedTemplates=void 0,this.playgroundContext=void 0}return Object(v.a)(e,[{key:"load",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,r,a=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]&&a[0],e.next=3,ta("/playground/dashboard-app-create-status".concat(t?"?instant=true":""),void 0,10);case 3:return n=e.sent,e.next=6,n.json();case 6:(r=e.sent).error?this.loadError=r.error:(this.dashboardCreated="created"===r.status,this.installedTemplates=r.installedTemplates);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyTemplatePackages",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:null,this.playgroundContext){e.next=5;break}return e.next=4,this.loadContext();case 4:this.playgroundContext=e.sent;case 5:return e.abrupt("return",mn("/playground/apply-template-packages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toApply:t,templateConfig:n||{credentials:this.playgroundContext}})}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadContext",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mn("/playground/context");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",{cubejsToken:n.cubejsToken,apiUrl:n.apiUrl||window.location.href.split("#")[0].replace(/\/$/,"")});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"templatePackages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"react";return"react"===e.toLowerCase()?[{name:"react-antd-dynamic",description:"React Antd Dynamic"},{name:"react-antd-static",description:"React Antd Static"},{name:"react-material-static",description:"React Material UI Static"}]:"angular"===e.toLowerCase()?[{name:"ng-material-dynamic",description:"Angular Material UI Dynamic"}]:"vue"===e.toLowerCase()?[{name:"vue-vuetify-dynamic",description:"Vue Vuetify UI Dynamic"}]:[]}},{key:"canAddChart",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return",this.loadError);case 4:return e.abrupt("return",!!Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addChart",value:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.applyTemplatePackages(["create-react-app",Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})),"static-chart"],{chartCode:t});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"templates",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mn("/playground/manifest");case 2:return e.next=4,e.sent.json();case 4:return t=e.sent,n=t.templates,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ra=function(e){var t=e.children;return Object(Q.jsx)("div",{style:{textAlign:"center",marginTop:50},children:t})},aa=function(){return Object(Q.jsxs)("p",{style:{width:450,margin:"20px auto"},children:["Dashboard App is a convenient way to setup and deploy frontend app to work with Cube.js backend. You can learn more about in the"," ",Object(Q.jsx)("a",{href:"https://cube.dev/docs/dashboard-app",target:"_blankl",children:"Cube.js docs"}),"."]})},ia=function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(j.a)(this,n),(r=t.call(this,e)).dashboardSource=new na,r.state={},r}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDashboard();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDashboard",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({appCode:null,loadError:null}),e.prev=1,e.next=4,this.dashboardSource.load();case 4:return this.setState({dashboardStarting:!1,appCode:!this.dashboardSource.loadError&&this.dashboardSource.dashboardCreated,loadError:this.dashboardSource.loadError}),e.next=7,mn("/playground/dashboard-app-status");case 7:return e.next=9,e.sent.json();case 9:t=e.sent,this.setState({dashboardRunning:t.running,dashboardPort:t.dashboardPort,dashboardAppPath:t.dashboardAppPath}),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),this.setState({dashboardStarting:!1,loadError:Object(Q.jsx)("pre",{children:e.t0.toString()})}),e.t0;case 17:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"startDashboardApp",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({dashboardStarting:!0}),e.next=3,fetch("/playground/start-dashboard-app");case 3:return e.next=5,this.loadDashboard();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.appCode,r=t.dashboardPort,a=t.loadError,i=t.dashboardRunning,o=t.dashboardStarting,s=t.dashboardAppPath;if(a&&"string"===typeof a&&-1!==a.indexOf("Dashboard app not found"))return Object(Q.jsx)(f.a,{to:"/template-gallery"});if(a)return Object(Q.jsxs)(ra,{children:[Object(Q.jsx)("h2",{children:a}),Object(Q.jsx)("p",{style:{marginTop:25},children:Object(Q.jsx)(L.a,{to:"/template-gallery",children:Object(Q.jsx)(Y.a,{type:"primary",children:"Create dashboard app in your project directory"})})}),Object(Q.jsx)(aa,{})]});if(!n)return Object(Q.jsxs)(ra,{children:[Object(Q.jsx)("h2",{children:"\xa0Creating Dashboard App"}),Object(Q.jsx)("div",{children:Object(Q.jsx)(ea.a,{tip:"It may take several minutes. Please check console for progress..."})}),Object(Q.jsx)(aa,{})]});if(!i)return Object(Q.jsxs)(ra,{children:[Object(Q.jsx)("h2",{children:"Dashboard App is not running"}),Object(Q.jsxs)("h3",{children:["Please start dashboard app or run it manually using",Object(Q.jsx)("code",{className:"inline-code",children:"$ npm run start"}),Object(Q.jsx)("br",{}),"in\xa0",Object(Q.jsx)("b",{children:s}),"\xa0directory."]}),Object(Q.jsx)("p",{style:{marginTop:25},children:Object(Q.jsx)(Y.a,{type:"primary",size:"large",loading:o,onClick:function(){return e.startDashboardApp()},children:o?"Dashboard app is starting. It may take a while. Please check console for progress...":"Start dashboard app"})}),Object(Q.jsx)(aa,{})]});var c="http://".concat(window.location.hostname,":").concat(r);return Object(Q.jsxs)("div",{style:{height:"100%",width:"100%",padding:"15px 30px 30px 30px",background:"#fff"},children:[Object(Q.jsx)(S.a,{message:Object(Q.jsxs)("span",{children:["This dashboard app can be edited at\xa0",Object(Q.jsx)("b",{children:s}),". Dev server is running at\xa0",Object(Q.jsx)("a",{href:c,target:"_blank",rel:"noopener noreferrer",children:c}),". Learn more how to customize and deploy it at\xa0",Object(Q.jsx)("a",{href:"https://cube.dev/docs/dashboard-app",children:"Cube.js\xa0docs"}),".\xa0",Object(Q.jsx)("a",{onClick:function(){return window.location.reload()},style:{cursor:"pointer"},children:"Refresh page"}),"\xa0if it is empty."]}),type:"info",closable:!0,style:{marginBottom:15}}),Object(Q.jsx)("iframe",{src:c,style:{width:"100%",height:"100%",border:0,borderRadius:4,overflow:"hidden"},sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin",title:"Dashboard"})]})}}]),n}(x.Component),oa=Object(f.g)(ia),sa=n(141),ca=D.b.div(Kr||(Kr=Object(O.a)(["\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 18px;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: var(--dark-04-color);\n  margin-bottom: 8px;\n"]))),ua=D.b.div(Hr||(Hr=Object(O.a)(["\n  display: flex;\n  flex-flow: row wrap;\n  margin-right: -8px;\n  margin-bottom: -8px;\n\n  && > * {\n    margin-right: 8px !important;\n    margin-bottom: 8px !important;\n  }\n"]))),la=n(240),da=Object(D.b)(la.a)(Wr||(Wr=Object(O.a)(["\n  &&& {\n    &.ant-select-disabled {\n      .ant-select-selector {\n        border-color: var(--disabled-color);\n        background-color: white;\n      }\n\n      .ant-select-selector {\n        color: var(--disabled-color);\n\n        &:hover,\n        &:active,\n        &:focus {\n          border-color: var(--disabled-color);\n          color: var(--disabled-color);\n        }\n      }\n    }\n\n    &.ant-select-single {\n      .ant-select-selector {\n        padding: 5px 12px;\n\n        .ant-select-selection-placeholder {\n          line-height: 22px;\n        }\n      }\n    }\n\n    &.ant-select-multiple {\n      .ant-select-selector {\n        padding: 3px 12px;\n      }\n\n      .ant-select-selection-item {\n        margin-top: 0;\n        margin-bottom: 0;\n      }\n    }\n\n    .ant-select-selection-item {\n      font-size: 14px;\n      line-height: 22px;\n    }\n\n    .ant-select-selector {\n      height: auto;\n      color: var(--text-color);\n      font-size: 14px;\n      line-height: 22px;\n\n      &:hover,\n      &:active,\n      &:focus {\n        border-color: var(--purple-04-color);\n        color: var(--primary-color);\n      }\n    }\n\n    .ant-select-selector::after {\n      font-size: 14px;\n      line-height: 22px;\n    }\n  }\n"]))),ba=(Object(D.b)(X.a)(Gr||(Gr=Object(O.a)(["\n  && .ant-select-selector {\n    padding: 6px 12px;\n    height: auto;\n    border-color: 1px solid var(--dark-05-color);\n    color: var(--text-color);\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n  }\n"]))),Object(D.b)(P.a)($r||($r=Object(O.a)(["\n  && {\n    user-select: none;\n\n    &.ant-menu-inline .ant-menu-item:not(:last-child) {\n      margin-bottom: 0;\n    }\n  }\n"]))));ba.Item=Object(D.b)(P.a.Item)(Zr||(Zr=Object(O.a)(["\n  &&& {\n    border-radius: 4px;\n    margin-bottom: 0;\n    margin-top: 0;\n\n    &::after {\n      border-color: transparent;\n    }\n\n    &.ant-menu-item-selected {\n      color: var(--primary-color);\n\n      &::after {\n        border-color: transparent;\n      }\n    }\n  }\n"])));var pa,ha,fa,ma=ba,ja=Object(D.b)(Z.a)(pa||(pa=Object(O.a)(["\n  && {\n    .ant-tabs-nav {\n      padding: 0 16px;\n      user-select: none;\n    }\n\n    .ant-tabs-content-holder {\n      padding: 0 16px;\n    }\n  }\n"]))),va=n(840),ga=Object(D.b)(va.a)(ha||(ha=Object(O.a)(["\n  && {\n    user-select: none;\n\n    .ant-tree-node-content-wrapper.ant-tree-node-selected {\n      color: white;\n    }\n  }\n"])));ga.TreeNode=Object(D.b)(va.a.TreeNode)(fa||(fa=Object(O.a)(["\n  && {\n  }\n"])));var ya=ga,Oa=w.a.Content,xa=w.a.Sider,ka=ya.TreeNode,wa=ja.TabPane,Sa={},Ca=function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(j.a)(this,n),(r=t.call(this,e)).state={expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],activeTab:"schema",files:[],isDocker:null},r}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDBSchema();case 2:return e.next=4,this.loadFiles();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExpand",value:function(e){Ur("Expand Tables"),this.setState({expandedKeys:e,autoExpandParent:!1})}},{key:"onCheck",value:function(e){Ur("Check Tables"),this.setState({checkedKeys:e})}},{key:"onSelect",value:function(e){this.setState({selectedKeys:e})}},{key:"loadDBSchema",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({schemaLoading:!0}),e.prev=1,e.next=4,mn("/playground/db-schema");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,this.setState({tablesSchema:n.tablesSchema}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({schemaLoadingError:e.t0});case 14:return e.prev=14,this.setState({schemaLoading:!1}),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadFiles",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mn("/playground/files");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({files:n.files});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateSchema",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,r,a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.checkedKeys,r=t.tablesSchema,a=this.props.history,Ur("Generate Schema"),e.next=5,mn("/playground/generate-schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:n.filter((function(e){return!!Sa[e]})).map((function(e){return Sa[e]})),tablesSchema:r})});case 5:if(200!==(i=e.sent).status){e.next=14;break}return Ur("Generate Schema Success"),e.next=10,this.loadFiles();case 10:this.setState({checkedKeys:[],activeTab:"files"}),te.a.success({title:"Schema files successfully generated!",content:"You can start building the charts",okText:"Build",cancelText:"Close",okCancel:!0,onOk:function(){a.push("/build")}}),e.next=20;break;case 14:return e.t0=Ur,e.next=17,i.text();case 17:e.t1=e.sent,e.t2={error:e.t1},(0,e.t0)("Generate Schema Fail",e.t2);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"selectedFileContent",value:function(){var e=this.selectedFile();return e&&e.content}},{key:"selectedFile",value:function(){var e=this.state,t=e.files,n=e.selectedFile;return t.find((function(e){return e.fileName===n}))}},{key:"renderFilesMenu",value:function(){var e=this,t=this.state,n=t.selectedFile,r=t.files;return Object(Q.jsx)(ma,{mode:"inline",onClick:function(t){var n=t.key;Ur("Select File"),e.setState({selectedFile:n})},selectedKeys:n?[n]:[],children:r.map((function(e){return Object(Q.jsx)(ma.Item,{children:e.fileName},e.fileName)}))})}},{key:"render",value:function(){var e=this,t=this.state,n=t.schemaLoading,r=t.schemaLoadingError,a=t.tablesSchema,i=t.selectedFile,o=t.expandedKeys,s=t.autoExpandParent,c=t.checkedKeys,u=t.selectedKeys,d=t.activeTab,b=t.isDocker,p=function e(t){return t.map((function(t){return t.treeData?Object(Q.jsx)(ka,{title:t.title,dataRef:t,children:e(t.treeData)},t.key):Object(Q.jsx)(ka,Object(l.a)({},t))}))};return Object(Q.jsxs)(w.a,{style:{height:"100%"},children:[Object(Q.jsx)(xa,{width:340,className:"schema-sidebar",children:Object(Q.jsxs)(ja,{activeKey:d,onChange:function(t){return e.setState({activeTab:t})},tabBarExtraContent:Object(Q.jsx)(Y.a,{disabled:!c.length,type:"primary",onClick:function(){return e.generateSchema()},children:"Generate Schema"}),children:[Object(Q.jsx)(wa,{tab:"Tables",children:n?Object(Q.jsx)(dr,{}):r?Object(Q.jsx)(ar,{"data-testid":"schema-error",message:"Error while loading DB schema",description:r.toString(),type:"error"}):function(){return Object.keys(a||{}).length>0?Object(Q.jsx)(ya,{checkable:!0,onExpand:e.onExpand.bind(e),expandedKeys:o,autoExpandParent:s,onCheck:e.onCheck.bind(e),checkedKeys:c,onSelect:e.onSelect.bind(e),selectedKeys:u,children:p((t=a||{},Object.keys(t).map((function(e){return{title:e,key:e,treeData:Object.keys(t[e]).map((function(t){var n="".concat(e,".").concat(t);return Sa[n]=[e,t],{title:t,key:n}}))}}))))}):Object(Q.jsx)(ar,{message:"Empty DB Schema",description:"Please check connection settings",type:"warning"});var t}()},"schema"),Object(Q.jsx)(wa,{tab:"Files",children:this.renderFilesMenu()},"files")]})}),Object(Q.jsxs)(Oa,{style:{minHeight:280,padding:24},children:[i&&Object(Q.jsx)(ar,{message:b?Object(Q.jsxs)("span",{children:["Schema files are located and can be edited in the mount volume directory."," ",Object(Q.jsx)(V.a.Link,{href:"https://cube.dev/docs/getting-started-cubejs-schema",target:"_blank",children:"Learn more about working with Cube.js data schema in the docs"})]}):Object(Q.jsxs)("span",{children:["This file can be edited at\xa0",Object(Q.jsx)("b",{children:this.selectedFile().absPath})]}),type:"info",style:{paddingTop:10,paddingBottom:11}}),i?Object(Q.jsx)(Tr,{code:this.selectedFileContent(),style:{padding:0,marginTop:24}}):Object(Q.jsx)(sa.a,{style:{marginTop:50},description:"Select tables to generate Cube.js schema"}),Object(Q.jsx)(Dn,{onReady:function(t){var n=t.playgroundContext;return e.setState({isDocker:null===n||void 0===n?void 0:n.isDocker})}})]})]})}}]),n}(x.Component),Da=n(118),Ta=n(215),Ea=n(492),Ra=n(213),qa=n(861),Ma=n(862),Pa=n(495),Aa=n(863),La=n(864),Qa=n(473),Ia=(n(640),n(641),n(832)),za=n(490),Fa=n(833),Na=n(474),Ba=n.n(Na),_a=n(475),Ua=(n(57),n(359)),Va=n.n(Ua),Ya=Object(x.createContext)(null),Ja={reset:"orange",black:"black",red:"red",green:"green",yellow:"orange",blue:"blue",magenta:"magenta",cyan:"cyan",gray:"gray",lightgrey:"lightgrey",darkgrey:"darkgrey"},Ka={"ansi-bright-black":"black","ansi-bright-yellow":"yellow","ansi-yellow":"yellow","ansi-bright-green":"green","ansi-green":"green","ansi-bright-cyan":"cyan","ansi-cyan":"cyan","ansi-bright-red":"red","ansi-red":"red","ansi-bright-magenta":"magenta","ansi-magenta":"magenta","ansi-white":"darkgrey"};function Ha(e){for(var t=(new Ba.a).ansiToJson(Object(_a.encode)(e),{use_classes:!0}),n="",r=!1,a=0;a<t.length;++a)for(var i=t[a],o=i.content,s=i.fg,c=o.split("\n"),u=0;u<c.length;++u){r||(n+='<span data-ansi-line="true">',r=!0);var l=c[u].replace("\r",""),d=Ja[Ka[s]];null!=d?n+='<span style="color: '.concat(d,';">').concat(l,"</span>"):(null!=s&&console.log("Missing color mapping: ",s),n+="<span>".concat(l,"</span>")),u<c.length-1&&(n+="</span>",r=!1,n+="<br/>")}return r&&(n+="</span>"),n}function Wa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ga(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wa(Object(n),!0).forEach((function(t){Re()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $a(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xt()(e);if(t){var a=xt()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return yt()(this,n)}}var Za=function(e){vt()(n,e);var t=$a(n);function n(e){var r;return Ae()(this,n),(r=t.call(this,e)).state={},r.mutexObj={},r}return Qe()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.query,n=e.queries;t&&this.load(t),n&&this.loadQueries(n)}},{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,r=n.query,a=n.queries,i=n.render,o=n.cubejsApi,s=n.loadSql,c=n.updateOnlyOnStateChange;return!c||(!Object(Ge.a)(e.query,r)||!Object(Ge.a)(e.queries,a)||(null==e.render||null==i)&&e.render!==i||e.cubejsApi!==o||e.loadSql!==s||!Object(Ge.a)(t,this.state)||e.updateOnlyOnStateChange!==c)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.query,r=t.queries;Object(Ge.a)(e.query,n)||this.load(n),Object(Ge.a)(e.queries,r)||this.loadQueries(r)}},{key:"cubejsApi",value:function(){return this.props.cubejsApi||this.context&&this.context.cubejsApi}},{key:"load",value:function(e){var t=this,n=this.props.resetResultSetOnChange;this.setState(Ga({isLoading:!0,error:null,sqlQuery:null},n?{resultSet:null}:{}));var r=this.props.loadSql,a=this.cubejsApi();e&&qt(e)&&("only"===r?a.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}).then((function(e){return t.setState({sqlQuery:e,error:null,isLoading:!1})})).catch((function(e){return t.setState(Ga(Ga({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):r?Promise.all([a.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}),a.load(e,{mutexObj:this.mutexObj,mutexKey:"query"})]).then((function(e){var n=Ye()(e,2),r=n[0],a=n[1];return t.setState({sqlQuery:r,resultSet:a,error:null,isLoading:!1})})).catch((function(e){return t.setState(Ga(Ga({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):a.load(e,{mutexObj:this.mutexObj,mutexKey:"query"}).then((function(e){return t.setState({resultSet:e,error:null,isLoading:!1})})).catch((function(e){return t.setState(Ga(Ga({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})))}},{key:"loadQueries",value:function(e){var t=this,n=this.cubejsApi(),r=this.props.resetResultSetOnChange;this.setState(Ga(Ga({isLoading:!0},r?{resultSet:null}:{}),{},{error:null})),Promise.all(Object(Ia.a)(e).map((function(e){var r=Ye()(e,2),a=r[0],i=r[1];return n.load(i,{mutexObj:t.mutexObj,mutexKey:a}).then((function(e){return[a,e]}))}))).then((function(e){return t.setState({resultSet:Object(ct.a)(e),error:null,isLoading:!1})})).catch((function(e){return t.setState(Ga(Ga({},r?{resultSet:null}:{}),{},{error:e,isLoading:!1}))}))}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.queries,r=e.resultSet,a=e.isLoading,i=e.sqlQuery,o=this.props.render,s={error:t?new Error(Ha(t.message||t.toString())):null,resultSet:n?r||{}:r,loadingState:{isLoading:a},sqlQuery:i};return o?o(s):null}}],[{key:"isQueryPresent",value:function(e){return qt(e)}}]),n}(k.a.Component);Za.contextType=Ya,Za.defaultProps={cubejsApi:null,query:null,render:null,queries:null,loadSql:null,updateOnlyOnStateChange:!1,resetResultSetOnChange:!0};function Xa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xa(Object(n),!0).forEach((function(t){Re()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ti(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xt()(e);if(t){var a=xt()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return yt()(this,n)}}var ni=[{name:void 0,title:"w/o grouping"},{name:"second",title:"Second"},{name:"minute",title:"Minute"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"year",title:"Year"}],ri=function(e){vt()(n,e);var t=ti(n);function n(e){var r;return Ae()(this,n),r=t.call(this,e),Re()(Va()(r),"fetchMeta",Te()(ze.a.mark((function e(){var t,n;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.cubejsApi()){e.next=2;break}return e.abrupt("return");case 2:return n=null,e.prev=3,r.setState({isFetchingMeta:!0}),e.next=7,r.cubejsApi().meta();case 7:t=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),n=e.t0;case 13:r.setState({meta:t,metaError:n?new Error(Ha(n.message||n.toString())):null,isFetchingMeta:!1},(function(){r.updateQuery({})}));case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))),r.state=ei(ei({query:e.defaultQuery||e.query,chartType:e.defaultChartType,validatedQuery:e.query,missingMembers:[],isFetchingMeta:!0,dryRunResponse:null},e.vizState),e.initialVizState),r.mutexObj={},r.orderMembersOrderKeys=[],r}return Qe()(n,[{key:"componentDidMount",value:function(){var e=Te()(ze.a.mark((function e(){return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.prevContext=this.context,e.next=3,this.fetchMeta();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Te()(ze.a.mark((function e(t){var n,r,a,i,o,s,c,u=this;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props,i=a.schemaVersion,o=a.onSchemaChange,s=this.state.meta,(null===(n=this.prevContext)||void 0===n?void 0:n.cubejsApi)===(null===(r=this.context)||void 0===r?void 0:r.cubejsApi)){e.next=6;break}return this.prevContext=this.context,e.next=6,this.fetchMeta();case 6:if(t.schemaVersion===i){e.next=17;break}return e.prev=7,e.next=10,this.cubejsApi().meta();case 10:c=e.sent,Object(Ge.a)(c,s)||"function"!==typeof o||o({schemaVersion:i,refresh:function(){var e=Te()(ze.a.mark((function e(){return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.fetchMeta();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),this.setState({metaError:e.t0});case 17:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cubejsApi",value:function(){var e=this.props.cubejsApi;return e||this.context&&this.context.cubejsApi}},{key:"getMissingMembers",value:function(e,t){return t?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=["measures","dimensions","segments"],n=new Set;return t.forEach((function(t){return(e[t]||[]).forEach((function(e){return n.add(e)}))})),(e.timeDimensions||[]).forEach((function(e){return n.add(e.dimension)})),Pt(e.filters).forEach((function(e){return n.add(e.dimension||e.member)})),Ue()(n)}(e).map((function(e){return!!t.resolveMember(e,["measures","dimensions","segments"]).error&&e})).filter(Boolean):[]}},{key:"isQueryPresent",value:function(){var e=this.state.query;return Za.isQueryPresent(e)}},{key:"prepareRenderProps",value:function(e){var t=this,r=function(e){return e.name},a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;return{add:function(r){var a=t.state.query;t.updateQuery(Re()({},e,(a[e]||[]).concat(n(r))))},remove:function(n){var r=(t.state.query[e]||[]).concat([]);return r.splice(n.index,1),t.updateQuery(Re()({},e,r))},update:function(r,a){var i=(t.state.query[e]||[]).concat([]);return i.splice(r.index,1,n(a)),t.updateQuery(Re()({},e,i))}}},i=this.state,o=i.meta,s=i.metaError,c=i.query,u=i.queryError,l=i.chartType,d=i.pivotConfig,b=i.validatedQuery,p=i.missingMembers,h=i.isFetchingMeta,f=i.dryRunResponse,m=Object(za.a)((function(e){return"".concat(Object(Xe.a)("member",e)).concat(Object(Xe.a)("operator",e))}),Pt(o&&c.filters||[]).map((function(e){return ei(ei({},e),{},{member:e.member||e.dimension})}))).map((function(e,t){return ei(ei({},e),{},{dimension:o.resolveMember(e.member||e.dimension,["dimensions","measures"]),operators:o.filterOperatorsForMember(e.member||e.dimension,["dimensions","measures"]),index:t})})),j=n.resolveMember("measures",this.state),v=n.resolveMember("dimensions",this.state),g=n.resolveMember("timeDimensions",this.state),y=(o&&c.segments||[]).map((function(e,t){return ei({index:t},o.resolveMember(e,"segments"))})),O=[],x=[],k=[],w=[],S=(null===o||void 0===o?void 0:o.membersGroupedByCube())||{measures:[],dimensions:[],segments:[],timeDimensions:[]};if(o){O=o.membersForQuery(c,"measures"),x=o.membersForQuery(c,"dimensions"),k=o.membersForQuery(c,"segments");var C=Object(Ze.a)(Object(Xe.a)("cubeName"),S.measures),D=Object(Ze.a)(Object(Xe.a)("cubeName"),S.dimensions);w=Object(bt.a)([].concat(Ue()(Object.keys(C)),Ue()(Object.keys(D)))).sort().map((function(e){var t,n;return ei(ei({},C[e]||D[e]),{},{members:[].concat(Ue()(null===(t=C[e])||void 0===t?void 0:t.members),Ue()(null===(n=D[e])||void 0===n?void 0:n.members)).sort((function(e,t){return e.shortTitle>t.shortTitle?1:-1}))})}))}var T=Array.isArray(c.order)?Object.fromEntries(c.order):c.order,E=[].concat(Ue()(j),Ue()(v),Ue()(g.map((function(e){return e.dimension})))),R=Object(za.a)(Object(Xe.a)("id"),Ue()(E.map((function(e){var t=e.name;return{id:t,title:e.title,order:(null===T||void 0===T?void 0:T[t])||"none"}}))));return this.orderMembersOrderKeys.length!==R.length&&(this.orderMembersOrderKeys=R.map((function(e){return e.id}))),this.orderMembersOrderKeys.length&&(R=(this.orderMembersOrderKeys||[]).map((function(e){return R.find((function(t){return t.id===e}))}))),ei({meta:o,metaError:s,query:c,error:u,validatedQuery:b,isQueryPresent:this.isQueryPresent(),chartType:l,measures:j,dimensions:v,timeDimensions:g,segments:y,filters:m,orderMembers:R,availableMeasures:O,availableDimensions:x,availableTimeDimensions:x.filter((function(e){return"time"===e.type})),availableSegments:k,availableMembers:S,availableFilterMembers:w,updateQuery:function(e){return t.updateQuery(e)},updateMeasures:a("measures"),updateDimensions:a("dimensions"),updateSegments:a("segments"),updateTimeDimensions:a("timeDimensions",(function(e){var t=e.compareDateRange?{compareDateRange:e.compareDateRange}:{dateRange:e.dateRange};return ei({dimension:e.dimension.name,granularity:e.granularity},t)})),updateFilters:a("filters",(function(e){var t,n;return{member:(null===(t=e.member)||void 0===t?void 0:t.name)||(null===(n=e.dimension)||void 0===n?void 0:n.name),operator:e.operator,values:e.values}})),updateChartType:function(e){return t.updateVizState({chartType:e})},updateOrder:{set:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";t.updateQuery({order:R.map((function(t){return ei(ei({},t),{},{order:t.id===e?n:t.order})})).reduce((function(e,t){var n=t.id,r=t.order;return"none"!==r?[].concat(Ue()(e),[[n,r]]):e}),[])})},update:function(e){t.updateQuery({order:e})},reorder:function(e,n){if(null!=e&&null!=n){var r=function(e,t,n){var r=Ue()(e),a=r.splice(t,1),i=Ye()(a,1)[0];return r.splice(n,0,i),r}(R,e,n);t.orderMembersOrderKeys=r.map((function(e){return e.id})),t.updateQuery({order:r.reduce((function(e,t){var n=t.id,r=t.order;return"none"!==r?[].concat(Ue()(e),[[n,r]]):e}),[])})}}},pivotConfig:d,updatePivotConfig:{moveItem:function(e){var n=e.sourceIndex,r=e.destinationIndex,a=e.sourceAxis,i=e.destinationAxis;t.updateVizState({pivotConfig:Mt(d,n,r,a,i)})},update:function(e){var n=e.limit;t.updateVizState(ei({pivotConfig:ei(ei({},d),e)},n?{query:ei(ei({},c),{},{limit:n})}:null))}},missingMembers:p,refresh:this.fetchMeta,isFetchingMeta:h,dryRunResponse:f},e)}},{key:"updateQuery",value:function(e){var t=this.state.query;this.updateVizState({query:ei(ei({},t),e)})}},{key:"updateVizState",value:function(){var e=Te()(ze.a.mark((function e(t){var n,r,a,i,o,s,c,u,l,d,b,p,h,f=this;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.setQuery,a=n.setVizState,i=this.state,o=i.query,s=i.pivotConfig,c=i.chartType,u=i.meta,(l=this.applyStateChangeHeuristics(t)).query||(l.query=ei({},o)),d=null,b=function(e){var t=f.props.onVizStateChanged;if(t){var n=Object(Fa.a)(["chartType","pivotConfig","query"],e);d&&Object(Ge.a)(d,n)||(t(n),d=Object($e.a)(n))}},p=function(e){a&&a(Object(Fa.a)(["chartType","pivotConfig","query"],e)),e.query&&r&&r(e.query)},l.shouldApplyHeuristicOrder&&(l.query.order=Rt(l.query)),l.pivotConfig=Kt.getNormalizedPivotConfig(l.query,void 0!==l.pivotConfig?l.pivotConfig:s),l.missingMembers=this.getMissingMembers(l.query,u),l.chartType=l.chartType||t.chartType||c,p(ei(ei({},t),{},{query:l.query})),this.setState(ei(ei({},l),{},{queryError:null})),b(l),!!Object(Ge.a)(Object(Fa.a)(["measures","dimensions","timeDimensions"],o),Object(Fa.a)(["measures","dimensions","timeDimensions"],l.query))||!qt(l.query)||0!==l.missingMembers.length){e.next=30;break}return e.prev=16,e.next=19,this.cubejsApi().dryRun(l.query,{mutexObj:this.mutexObj});case 19:h=e.sent,l.shouldApplyHeuristicOrder&&(l.query.order=(h.queryOrder||[]).reduce((function(e,t){return ei(ei({},e),t)}),{})),l.pivotConfig=Kt.getNormalizedPivotConfig(h.pivotQuery,l.pivotConfig),l.validatedQuery=this.validatedQuery(l),l.dryRunResponse=h,qt(o)&&p(ei(ei({},this.state),l)),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(16),this.setState({queryError:new Error(Ha(e.t0.message||e.t0.toString()))});case 30:this.setState(l,(function(){return b(f.state)}));case 31:case"end":return e.stop()}}),e,this,[[16,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"validatedQuery",value:function(e){var t=(e||this.state).query;return ei(ei({},t),{},{filters:(t.filters||[]).filter((function(e){return e.operator}))})}},{key:"defaultHeuristics",value:function(e){var t=this.state,n=t.query,r=t.sessionGranularity;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=Object($e.a)(e),a=r.query,i=Be()(r,St),o=n.meta,s=n.sessionGranularity||"day",c=Dt({query:a},i),u=null;if(Et(a,t)||(u=a),Array.isArray(u)||Array.isArray(t))return e;if(u){if(1===(t.timeDimensions||[]).length&&1===(u.timeDimensions||[]).length&&u.timeDimensions[0].granularity&&t.timeDimensions[0].granularity!==u.timeDimensions[0].granularity&&(c=Dt(Dt({},c),{},{sessionGranularity:u.timeDimensions[0].granularity})),0===(t.measures||[]).length&&(u.measures||[]).length>0||1===(t.measures||[]).length&&1===(u.measures||[]).length&&t.measures[0]!==u.measures[0]){var l=u.timeDimensions||[],d=Ye()(l,1)[0],b=o.defaultTimeDimensionNameFor(u.measures[0]);return u=Dt(Dt({},u),{},{timeDimensions:b?[{dimension:b,granularity:d&&d.granularity||s,dateRange:d&&d.dateRange}]:[]}),Dt(Dt({},c),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,chartType:b?"line":"number"})}return 0===(t.dimensions||[]).length&&(u.dimensions||[]).length>0?(u=Dt(Dt({},u),{},{timeDimensions:(u.timeDimensions||[]).map((function(e){return Dt(Dt({},e),{},{granularity:void 0})}))}),Dt(Dt({},c),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,chartType:"table"})):(t.dimensions||[]).length>0&&0===(u.dimensions||[]).length?(u=Dt(Dt({},u),{},{timeDimensions:(u.timeDimensions||[]).map((function(e){return Dt(Dt({},e),{},{granularity:e.granularity||s})}))}),Dt(Dt({},c),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,chartType:(u.timeDimensions||[]).length?"line":"number"})):((t.dimensions||[]).length>0||(t.measures||[]).length>0)&&0===(u.dimensions||[]).length&&0===(u.measures||[]).length?(u=Dt(Dt({},u),{},{timeDimensions:[],filters:[]}),Dt(Dt({},c),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,sessionGranularity:null})):c}if(c.chartType){var p=c.chartType;if(("line"===p||"area"===p)&&1===(t.timeDimensions||[]).length&&!t.timeDimensions[0].granularity){var h=Ye()(t.timeDimensions,1)[0];return Dt(Dt({},c),{},{pivotConfig:null,query:Dt(Dt({},t),{},{timeDimensions:[Dt(Dt({},h),{},{granularity:s})]})})}if(("pie"===p||"table"===p||"number"===p)&&1===(t.timeDimensions||[]).length&&t.timeDimensions[0].granularity){var f=Ye()(t.timeDimensions,1)[0];return Dt(Dt({},c),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:Dt(Dt({},t),{},{timeDimensions:[Dt(Dt({},f),{},{granularity:void 0})]})})}}return c}(e,n,{meta:t.meta,sessionGranularity:r||"day"})}},{key:"applyStateChangeHeuristics",value:function(e){var t=this.props,n=t.stateChangeHeuristics;return t.disableHeuristics?e:n&&n(this.state,e)||this.defaultHeuristics(e)}},{key:"render",value:function(){var e=this,t=this.state.query,n=this.props,r=n.cubejsApi,a=n.render;return n.wrapWithQueryRenderer?k.a.createElement(Za,{query:t,cubejsApi:r,resetResultSetOnChange:!1,render:function(t){return a?a(e.prepareRenderProps(t)):null}}):a?a(this.prepareRenderProps()):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.query||e.vizState){var n=ei(ei({},t),e.vizState||{});if(Array.isArray(e.query))throw new Error("Array of queries is not supported.");return ei(ei({},n),{},{query:ei(ei({},n.query),e.query||{})})}return null}},{key:"resolveMember",value:function(e,t){var r=t.meta,a=t.query;return r?Array.isArray(a)?a.reduce((function(t,a){return t.concat(n.resolveMember(e,{meta:r,query:a}))}),[]):"timeDimensions"===e?(a.timeDimensions||[]).map((function(e,t){return ei(ei({},e),{},{dimension:ei(ei({},r.resolveMember(e.dimension,"dimensions")),{},{granularities:ni}),index:t})})):(a[e]||[]).map((function(t,n){return ei({index:n},r.resolveMember(t,e))})):[]}}]),n}(k.a.Component);function ai(e){var t=e.cubejsApi,n=e.children;return k.a.createElement(Ya.Provider,{value:{cubejsApi:t}},n)}Re()(ri,"contextType",Ya),ri.defaultProps={cubejsApi:null,stateChangeHeuristics:null,disableHeuristics:!1,render:null,wrapWithQueryRenderer:!0,defaultChartType:"line",defaultQuery:{},initialVizState:null,onVizStateChanged:null,query:null,setQuery:null,vizState:null,setVizState:null};var ii,oi=n(238),si=n(78),ci=n(835),ui=function(e){var t=e.query;return Object(Q.jsx)(Za,{loadSql:!0,query:Object(l.a)(Object(l.a)({},t),{},{renewQuery:!0}),render:function(e){var t,n=e.sqlQuery,r=e.resultSet,a=e.error;if(a)return Object(Q.jsx)(jr,{error:a});var i=(null===r||void 0===r?void 0:r.serialize())||{},o=null===n||void 0===n?void 0:n.rawQuery(),s=null===(t=i.loadResponse)||void 0===t?void 0:t.results[0];return Object(Q.jsxs)(Z.a,{defaultActiveKey:"refreshKeys",tabBarExtraContent:Object(Q.jsxs)("span",{children:["Last Refresh Time:\xa0",Object(Q.jsx)("b",{children:null===s||void 0===s?void 0:s.lastRefreshTime})]}),children:[Object(Q.jsx)(Z.a.TabPane,{tab:"Refresh Keys",children:Object(Q.jsx)(ci.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Refresh Key SQL",key:"refreshKey",render:function(e,t){return Object(Q.jsx)(Tr,{code:Object(oi.format)(t[0])})}},{title:"Value",key:"value",render:function(e,t){return Object(Q.jsx)(Tr,{code:(null===s||void 0===s?void 0:s.refreshKeyValues)&&o&&JSON.stringify(s.refreshKeyValues[o.cacheKeyQueries.indexOf(t)],null,2)})}}],dataSource:null===o||void 0===o?void 0:o.cacheKeyQueries})},"refreshKeys"),Object(Q.jsx)(Z.a.TabPane,{tab:"Pre-aggregations",children:Object(Q.jsx)(ci.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Table Name",key:"tableName",dataIndex:"tableName",render:function(e){return Object(Q.jsx)("b",{children:e})}},{title:"Refresh Key SQL",key:"refreshKey",dataIndex:"invalidateKeyQueries",render:function(e){return e.map((function(e){return Object(Q.jsx)(Tr,{code:Object(oi.format)(e[0])},e[0])}))}},{title:"Refresh Key Value",key:"value",render:function(e,t){var n,r,a,i=null===s||void 0===s||null===(n=s.usedPreAggregations)||void 0===n||null===(r=n[t.tableName])||void 0===r?void 0:r.refreshKeyValues;return Array.isArray(i)&&(i=i.reduce((function(e,t){return e.concat(t)}),[])),null===(a=i)||void 0===a?void 0:a.map((function(e){return Object(Q.jsx)(Tr,{code:JSON.stringify(e,null,2)},JSON.stringify(e))}))}}],dataSource:null===o||void 0===o?void 0:o.preAggregations})},"preAggregations"),Object(Q.jsx)(Z.a.TabPane,{tab:"Rollup Match Results",children:Object(Q.jsx)(ci.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Rollup Name",key:"name",dataIndex:"name",render:function(e){return Object(Q.jsx)("b",{children:e})}},{title:"Rollup Definition",key:"rollup",dataIndex:"references",render:function(e){return Object(Q.jsx)(Tr,{code:JSON.stringify(e,null,2)})}},{title:"Can Be Used",key:"canUsePreAggregation",dataIndex:"canUsePreAggregation",render:function(e){return e?Object(Q.jsx)(ie.a,{style:{color:"#52c41a",fontSize:"2em"}}):Object(Q.jsx)(si.a,{style:{color:"#c2371b",fontSize:"2em"}})}}],dataSource:null===o||void 0===o?void 0:o.rollupMatchResults})},"rollupMatchResults")]})}})},li={react:"create-react-app",angular:"angular-cli",vue:"vue-cli"},di=Object(D.b)(kr)(ii||(ii=Object(O.a)(["\n  .ant-card-head {\n    position: sticky;\n    top: 0;\n    z-index: 100;\n    background: white;\n  }\n\n  .ant-card-body {\n    max-width: 100%;\n    overflow: auto;\n    position: relative;\n  }\n"]))),bi=[{id:"react",title:"React",supported:!0,scaffoldingSupported:!0},{id:"angular",title:"Angular",supported:!0,scaffoldingSupported:!0},{id:"vue",title:"Vue",supported:!0,scaffoldingSupported:!0},{id:"vanilla",title:"Vanilla JavaScript",docsLink:"https://cube.dev/docs/@cubejs-client-core"}],pi=function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(j.a)(this,n),(r=t.call(this,e)).state={showCode:!1,chartRendererError:null},r}return Object(v.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.codeExample,r=t.codesandboxFiles,a=t.dependencies,i=t.redirectToDashboard,o=t.showCode,s=t.addingToDashboard,c=t.chartRendererError,b=this.props,p=b.isChartRendererReady,h=b.resultSet,m=b.error,j=b.render,v=b.dashboardSource,g=b.hideActions,y=b.query,O=b.chartingLibrary,x=b.setChartLibrary,k=b.chartLibraries,w=b.history,S=b.framework,C=b.setFramework,D=b.isFetchingMeta,T=b.onChartRendererReadyChange;if(i)return Object(Q.jsx)(f.a,{to:"/dashboard"});if(c)return Object(Q.jsx)("div",{children:c});var E,R=p?Object(Qa.getParameters)(function(e,t){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{files:Object(l.a)(Object(l.a)(Object(l.a)({},null===(n=le[e])||void 0===n?void 0:n.files),Object.entries(t).map((function(e){var t=Object(B.a)(e,2),n=t[0],r=t[1];return Object(oe.a)({},n,{content:r})})).reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),t)}),{})),{},{"package.json":{content:{dependencies:Object(l.a)(Object(l.a)({},null===(r=le[e])||void 0===r?void 0:r.dependencies),a.reduce((function(e,t){var n=Array.isArray(t)?t:[t,"latest"],r=Object(B.a)(n,2),a=r[0],i=r[1];return Object(l.a)(Object(l.a)({},e),{},Object(oe.a)({},a,i),de[a]?Object(oe.a)({},de[a],"latest"):null)}),{}))}}}),template:e}}(li[S],r,a)):null,q=(k[S]||[]).length>0?Object(Q.jsx)(P.a,{"data-testid":"charting-library-dropdown",onClick:function(e){Ur("Set Chart Library",{chartingLibrary:e.key}),x(e.key)},children:(k[S]||[]).map((function(e){return Object(Q.jsx)(P.a.Item,{children:e.title},e.value)}))}):null,A=Object(Q.jsx)(P.a,{"data-testid":"framework-dropdown",onClick:function(e){var t,n;e.key!==S&&(Ur("Set Framework",{framework:e.key}),C(e.key),T(!1),x((null===(t=k[e.key])||void 0===t||null===(n=t[0])||void 0===n?void 0:n.value)||null))},children:bi.map((function(e){return Object(Q.jsx)(P.a.Item,{children:e.title},e.id)}))}),L=(k[S]||[]).find((function(e){return e.value===O})),I=bi.find((function(e){return e.id===S})),z=Object(Q.jsxs)("form",{action:"https://codesandbox.io/api/v1/sandboxes/define",method:"POST",target:"_blank",children:[null!=R?Object(Q.jsx)("input",{type:"hidden",name:"parameters",value:R}):null,Object(Q.jsxs)(ua,{children:[Object(Q.jsxs)(gr.Group,{children:[Object(Q.jsx)(M.a,{overlay:A,disabled:D,children:Object(Q.jsxs)(gr,{"data-testid":"framework-btn",size:"small",children:[null===I||void 0===I?void 0:I.title,Object(Q.jsx)(Ra.a,{})]})}),q?Object(Q.jsx)(M.a,{overlay:q,disabled:!(null===I||void 0===I?void 0:I.supported)||D,children:Object(Q.jsxs)(gr,{"data-testid":"charting-library-btn",size:"small",children:[null===L||void 0===L?void 0:L.title,Object(Q.jsx)(Ra.a,{})]})}):null]}),Object(Q.jsxs)(gr.Group,{children:[Object(Q.jsx)(gr,{"data-testid":"chart-btn",size:"small",type:o?"default":"primary",disabled:!(null===I||void 0===I?void 0:I.supported)||D,onClick:function(){Ur("Show Chart"),e.setState({showCode:null})},children:"Chart"}),Object(Q.jsx)(gr,{"data-testid":"json-query-btn",icon:Object(Q.jsx)(qa.a,{}),size:"small",type:"query"===o?"primary":"default",disabled:!(null===I||void 0===I?void 0:I.supported)||D,onClick:function(){Ur("Show Query"),e.setState({showCode:"query"})},children:"JSON Query"}),Object(Q.jsx)(gr,{"data-testid":"code-btn",icon:Object(Q.jsx)(Ma.a,{}),size:"small",type:"code"===o?"primary":"default",disabled:!(null===I||void 0===I?void 0:I.supported)||D,onClick:function(){Ur("Show Code"),e.setState({showCode:"code"})},children:"Code"}),Object(Q.jsx)(gr,{"data-testid":"sql-btn",icon:Object(Q.jsx)(Pa.a,{}),size:"small",type:"sql"===o?"primary":"default",disabled:!(null===I||void 0===I?void 0:I.supported)||D,onClick:function(){Ur("Show SQL"),e.setState({showCode:"sql"})},children:"SQL"}),Object(Q.jsx)(gr,{"data-testid":"cache-btn",icon:Object(Q.jsx)(Aa.a,{}),size:"small",type:"cache"===o?"primary":"default",disabled:!(null===I||void 0===I?void 0:I.supported)||D,onClick:function(){Ur("Show Cache"),e.setState({showCode:"cache"})},children:"Cache"})]}),Object(Q.jsx)(gr,{"data-testid":"edit-btn",icon:Object(Q.jsx)(La.a,{}),size:"small",htmlType:"submit",disabled:!(null===I||void 0===I?void 0:I.supported)||D,onClick:function(){return Ur("Open Code Sandbox")},children:"Edit"}),v&&Object(Q.jsx)(gr,{"data-testid":"add-to-dashboard-btn",onClick:Object(d.a)(u.a.mark((function t(){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({addingToDashboard:!0}),t.next=3,v.canAddChart();case 3:if("boolean"!==typeof(r=t.sent)||!r){t.next=11;break}return Ur("Add to Dashboard"),t.next=8,v.addChart(n);case 8:e.setState({redirectToDashboard:!0,addingToDashboard:!1}),t.next=12;break;case 11:r?(e.setState({addingToDashboard:!1}),te.a.error({title:"There is an error loading your dashboard app",content:r,okText:"Fix",okCancel:!0,onOk:function(){w.push("/dashboard")}})):(e.setState({addingToDashboard:!1}),te.a.error({title:"Your dashboard app does not support adding of static charts",content:"Please use static dashboard template"}));case 12:case"end":return t.stop()}}),t)}))),icon:Object(Q.jsx)(Ea.a,{}),size:"small",loading:s,disabled:!(null===I||void 0===I?void 0:I.supported)||D,type:"primary",children:s?"Preparing dashboard app. It may take a while. Please check console for progress...":"Add to Dashboard"})]})]}),F=JSON.stringify(y,null,2);return E="code"===o?Object(Q.jsxs)(ua,{style:{alignItems:"center"},children:[Object(Q.jsx)("div",{children:"Code"}),Object(Q.jsx)(gr,{"data-testid":"copy-code-btn",icon:Object(Q.jsx)(ae.a,{}),size:"small",disabled:Boolean(m),onClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(n);case 2:Ur("Copy Code to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"})]}):"query"===o?Object(Q.jsxs)(ua,{children:[Object(Q.jsx)("div",{children:"Query"}),Object(Q.jsx)(gr,{"data-testid":"copy-cube-query-btn",icon:Object(Q.jsx)(ae.a,{}),size:"small",onClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(JSON.stringify(y,null,2));case 2:Ur("Copy Query to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"})]}):"sql"===o?"SQL":"cache"===o?"Cache":"Chart",g?j({resultSet:h,error:m}):Object(Q.jsx)(di,{title:E,style:{minHeight:420},extra:z,children:(null===I||void 0===I?void 0:I.supported)?"code"===o?m?Object(Q.jsx)(jr,{error:m}):Object(Q.jsx)(Tr,{code:n}):"query"===o?Object(Q.jsx)(Tr,{code:F}):"sql"===o?Object(Q.jsx)(Za,{loadSql:"only",query:y,render:function(e){var t=e.sqlQuery,n=e.error;if(n)return Object(Q.jsx)(jr,{error:n});var r=Array.isArray(t)?t:[t],a=Object(B.a)(r,1)[0];return Object(Q.jsx)(Tr,{code:a&&Object(oi.format)(a.sql())})}}):"cache"===o?Object(Q.jsx)(ui,{query:y}):j({framework:S,error:m}):Object(Q.jsxs)("h2",{style:{padding:24,textAlign:"center"},children:["We do not support\xa0",null===I||void 0===I?void 0:I.title,"\xa0code generation here yet.",Object(Q.jsx)("br",{}),"Please refer to\xa0",Object(Q.jsxs)("a",{href:null===I||void 0===I?void 0:I.docsLink,target:"_blank",rel:"noopener noreferrer",onClick:function(){return Ur("Unsupported Framework Docs",{framework:S})},children:[null===I||void 0===I?void 0:I.title,"\xa0docs"]}),"\xa0to see on how to use it with Cube.js."]})})}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.isChartRendererReady&&null!=e.iframeRef.current&&e.chartingLibrary){var n=e.iframeRef.current.contentWindow.__cubejsPlayground;if(!n)return Object(l.a)(Object(l.a)({},t),{},{chartRendererError:"The chart renderer failed to load"});var r=n.getCodesandboxFiles(e.chartingLibrary,{chartType:e.chartType,query:JSON.stringify(e.query,null,2),pivotConfig:JSON.stringify(e.pivotConfig,null,2),apiUrl:e.apiUrl,cubejsToken:e.cubejsToken}),a="";return"react"===e.framework?a=r["index.js"]:"angular"===e.framework?a=r["src/app/query-renderer/query-renderer.component.ts"]:"vue"===e.framework&&(a=r["src/components/ChartRenderer.vue"]),Object(l.a)(Object(l.a)({},t),{},{chartRendererError:null,dependencies:n.getDependencies(e.chartingLibrary),codeExample:a,codesandboxFiles:r})}return t}}]),n}(x.Component);pi.defaultProps={query:{},hideActions:!1};var hi,fi,mi,ji,vi,gi,yi=Object(f.g)(pi),Oi=n(496),xi=n(839),ki=n(856),wi=Object(D.b)(te.a)(hi||(hi=Object(O.a)(["\n  && {\n    .ant-modal-header {\n      border-bottom: none;\n      padding: 40px 32px 0 32px;\n\n      .ant-modal-title {\n        font-size: 20px;\n      }\n    }\n\n    .ant-modal-footer {\n      border-top: none;\n      padding: 0 32px 34px 32px;\n      text-align: left;\n    }\n  }\n"]))),Si=Object(D.b)(xi.a)(fi||(fi=Object(O.a)(["\n  && {\n    .ant-form-item-label {\n      line-height: 16px;\n      margin-bottom: 7px;\n      label {\n        font-weight: 500;\n        font-size: 12px;\n        line-height: 16px;\n      }\n    }\n\n    .ant-dropdown-trigger {\n      padding: 5px 12px;\n    }\n  }\n"]))),Ci=Object(D.b)(xi.a.Item)(mi||(mi=Object(O.a)(["\n  && {\n    &:not(:last-child) {\n      margin-bottom: 16px;\n    }\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n"]))),Di=function(){return Object(Q.jsx)(Oi.a,{style:{color:"#727290"}})},Ti=function(e){var t=e.visible,n=e.onOk,r=e.onCancel,a=e.onChange,i=e.chartLibraries,o=e.currentLibraryItem,s=e.frameworks,c=e.framework,u=e.frameworkItem,l=e.templatePackages,d=e.templatePackage,b=e.enableWebSocketTransport,p=Object(Q.jsx)(P.a,{onClick:function(e){Ur("Set Chart Library",{chartLibrary:e.key}),a("chartLibrary",e.key)},children:i.map((function(e){return Object(Q.jsx)(P.a.Item,{children:e.title},e.value)}))}),h=Object(Q.jsx)(P.a,{onClick:function(e){Ur("Set Framework",{framework:e.key}),a("framework",e.key)},children:s.map((function(e){return Object(Q.jsx)(P.a.Item,{children:e.title},e.id)}))}),f=Object(Q.jsx)(P.a,{onClick:function(e){Ur("Set Template Package",{templatePackageName:e.key}),a("templatePackageName",e.key)},children:(l||[]).map((function(e){return Object(Q.jsx)(P.a.Item,{children:e.description},e.name)}))});return Object(Q.jsx)(wi,{title:"Create your own Dashboard App",visible:t,onOk:n,onCancel:r,footer:[Object(Q.jsx)(gr,{type:"primary",onClick:n,children:"Ok"},"submit"),Object(Q.jsx)(gr,{onClick:r,children:"Cancel"},"back")],children:Object(Q.jsxs)(Si,{children:[Object(Q.jsx)(Ci,{label:"Framework",children:Object(Q.jsx)(M.a,{overlay:h,children:Object(Q.jsxs)(gr,{children:[u&&u.title,Object(Q.jsx)(Di,{})]})})}),!(null===u||void 0===u?void 0:u.scaffoldingSupported)&&Object(Q.jsx)(S.a,{style:{marginBottom:23},type:"info",message:Object(Q.jsxs)("span",{children:["We do not support\xa0",u.title,"\xa0dashboard scaffolding generation yet. Please refer to\xa0",Object(Q.jsxs)("a",{href:u.docsLink,target:"_blank",rel:"noopener noreferrer",onClick:function(){return Ur("Unsupported Dashboard Framework Docs",{framework:c})},children:[u.title,"\xa0docs"]}),"\xa0to see on how to use it with Cube.js."]})}),Object(Q.jsx)(Ci,{label:"Main Template",children:Object(Q.jsx)(M.a,{overlay:f,disabled:!u.scaffoldingSupported,children:Object(Q.jsxs)(gr,{children:[d&&d.description,Object(Q.jsx)(Di,{})]})})}),Object(Q.jsx)(Ci,{label:"Charting Library",children:Object(Q.jsx)(M.a,{overlay:p,disabled:!u.scaffoldingSupported,children:Object(Q.jsxs)(gr,{children:[o&&o.title,Object(Q.jsx)(Di,{})]})})}),Object(Q.jsx)(Ci,{label:"Web Socket Transport (Real-time)",children:Object(Q.jsx)(ki.a,{disabled:"react"!==c.toLowerCase(),checked:b,onChange:function(e){return a("enableWebSocketTransport",e)}})})]})})},Ei=n(482),Ri=n.n(Ei),qi=["overlay","disabled"],Mi=function(e){var t=e.overlay,n=e.disabled,r=void 0!==n&&n,a=Object(b.a)(e,qi);return Object(Q.jsx)(M.a,{disabled:r,overlay:t,placement:"bottomLeft",trigger:["click"],children:Object(Q.jsx)(gr,Object(l.a)(Object(l.a)({},a),{},{disabled:r}))})},Pi=["availableMembers","showNoMembersPlaceholder","onClick"],Ai=Object(D.b)(P.a)(ji||(ji=Object(O.a)(["\n  max-height: 320px;\n  overflow: hidden auto;\n  padding-top: 0;\n\n  li.ant-dropdown-menu-item-active {\n    background: #f3f3fb;\n  }\n"]))),Li=Object(D.b)(Ai.Item)(vi||(vi=Object(O.a)(["\n  position: sticky;\n  top: 0;\n  background: white;\n  padding-top: 10px;\n  padding-bottom: 0;\n  margin-bottom: 16px;\n\n  ::after {\n    display: block;\n    position: absolute;\n    content: '';\n    width: 100%;\n    left: 0;\n    bottom: -20px;\n    height: 20px;\n    background: linear-gradient(\n      to bottom,\n      rgba(255, 255, 255, 1),\n      rgba(255, 255, 255, 0)\n    );\n  }\n"])));function Qi(e){var t=e.availableMembers,n=e.showNoMembersPlaceholder,r=void 0===n||n,a=e.onClick,i=Object(b.a)(e,Pi),o=Object(x.useRef)(Ri.a.create({encode:"advanced"})),s=Object(x.useState)(""),c=Object(B.a)(s,2),p=c[0],h=c[1],f=Object(x.useState)([]),m=Object(B.a)(f,2),j=m[0],v=m[1],g=o.current,y=t.some((function(e){return e.members.length>0})),O=function(e,t){var n=Pn(t);return Object(x.useMemo)(e,n)}((function(){return hn(t).forEach((function(e){var t=Object(B.a)(e,2),n=t[0],r=t[1].title;return g.add(n,r)})),Object.fromEntries(hn(t))}),[t]);Object(x.useEffect)((function(){var e=p;return Object(d.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.search(p);case 2:if(n=t.sent,e===p){t.next=5;break}return t.abrupt("return");case 5:v(n);case 6:case"end":return t.stop()}}),t)})))(),function(){e=""}}),[g,p]);var k=p?function(e,t){var n=t.map((function(e){return e.split(".")[0]}));return e.filter((function(e){var t=e.cubeName;return n.includes(t)})).map((function(e){return Object(l.a)(Object(l.a)({},e),{},{members:e.members.filter((function(e){var n=e.name;return t.includes(n)}))})}))}(t,j):t;return Object(Q.jsx)(Mi,Object(l.a)(Object(l.a)({},i),{},{overlay:Object(Q.jsx)(Ai,{onClick:function(e){h(""),v([]),a(O[e.key])},children:y?Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Li,{disabled:!0,children:Object(Q.jsx)(X.a,{placeholder:"Search",autoFocus:!0,value:p,allowClear:!0,onKeyDown:function(e){["ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault()},onChange:function(e){h(e.target.value)}})}),k.map((function(e){return e.members.length>0?Object(Q.jsx)(Ai.ItemGroup,{title:e.cubeTitle,children:e.members.map((function(e){return Object(Q.jsx)(Ai.Item,{"data-testid":e.name,children:e.shortTitle},e.name)}))},e.cubeName):null}))]}):r?Object(Q.jsx)(Ai.Item,{disabled:!0,children:"No members found"}):null})}))}var Ii=["onRemoveClick","children"];function zi(e){return null==e.color?"primary":{primary:"primary",danger:"pink"}[e.color]}var Fi=Object(D.b)((function(e){var t=e.onRemoveClick,n=e.children,r=Object(b.a)(e,Ii);return Object(Q.jsxs)(gr.Group,Object(l.a)(Object(l.a)({},r),{},{children:[n,Object(Q.jsx)(gr,{ghost:!0,className:"remove-btn",disabled:r.disabled,onClick:t,children:Object(Q.jsx)(si.a,{})})]}))}))(gi||(gi=Object(O.a)(["\n  && {\n    border-radius: calc(var(--border-radius-base) + 1px);\n\n    .ant-btn {\n      border: none;\n\n      & + .ant-btn {\n        margin-left: 0;\n      }\n    }\n\n    .remove-btn {\n      padding: 8px;\n\n      .anticon {\n        height: 14px;\n        display: block;\n      }\n    }\n  }\n\n  &&:not(.disabled) {\n    border: 1px solid var(--","-color);\n    color: var(--","-color);\n\n    .ant-btn {\n      background-color: var(--","-9);\n      color: var(--","-color);\n\n      span {\n        color: var(--","-color);\n      }\n\n      &:hover {\n        background-color: var(--","-8);\n        border: none;\n        box-shadow: none;\n      }\n    }\n\n    .remove-btn {\n      background-color: white !important;\n      color: var(--","-color);\n\n      &:hover {\n        background-color: var(--","-8) !important;\n      }\n    }\n  }\n\n  &&.disabled {\n    border: 1px solid var(--disabled-color);\n    color: var(--disabled-color);\n\n    .ant-btn {\n      background-color: var(--disabled-bg);\n      color: var(--disabled-color);\n      border: none;\n\n      span {\n        color: var(--disabled-color);\n      }\n    }\n\n    .remove-btn {\n      color: var(--disabled-color);\n    }\n  }\n"])),zi,zi,zi,zi,zi,zi,zi,zi),Ni=n(92);function Bi(e){var t=e.children;return Object(Q.jsx)(Ni.a,{overlayClassName:"missing-member-tooltip",placement:"top",title:"This member was removed from the data schema",color:"var(--dark-01-color)",children:t})}function _i(e){var t=e.disabled,n=void 0!==t&&t,r=e.members,a=e.availableMembers,i=e.missingMembers,o=e.addMemberName,s=e.updateMethods,c=Object(x.useCallback)((function(e){return s.add(e)}),[]);return Object(Q.jsxs)(ua,{children:[r.map((function(e){var t=i.includes(e.title),r=Object(Q.jsx)(Fi,{disabled:n,className:n?"disabled":null,color:t?"danger":"primary",onRemoveClick:function(){return s.remove(e)},children:Object(Q.jsx)(Qi,{disabled:n,availableMembers:a,onClick:function(t){return s.update(e,t)},children:e.title})},e.index||e.name);return t?Object(Q.jsx)(Bi,{children:r},e.index||e.name):r})),Object(Q.jsx)(Qi,{"data-testid":o,disabled:n,availableMembers:a,type:"dashed",icon:Object(Q.jsx)(Ea.a,{}),onClick:c,children:r.length?null:o})]})}var Ui=n(483),Vi={string:function(e){var t=e.values,n=void 0===t?[]:t,r=e.disabled,a=e.onChange;return Object(Q.jsx)(da,{disabled:r,style:{width:300},mode:"tags",value:n,maxTagCount:"responsive",onChange:a},"input")},number:function(e){var t=e.values,n=void 0===t?[]:t,r=e.disabled,a=e.onChange;return Object(Q.jsx)(X.a,{disabled:r,style:{width:300},onChange:function(e){return a([e.target.value])},value:(null===n||void 0===n?void 0:n[0])||""},"input")}};function Yi(e){var t=e.member,n=e.disabled,r=void 0!==n&&n,a=e.updateMethods,i=Vi[t.dimension.type]||Vi.string,o=Object(x.useRef)(Object(Ui.a)(500,(function(e,t){a.update(e,Object(l.a)(Object(l.a)({},e),{},{values:t}))}))),s=Object(x.useState)(t.values),c=Object(B.a)(s,2),u=c[0],d=c[1];return Object(Q.jsx)(i,{disabled:r,values:u,onChange:function(e){d(e),o.current(t,e)}},"filter")}var Ji,Ki=function(e){var t=e.disabled,n=void 0!==t&&t,r=e.members,a=e.availableMembers,i=e.addMemberName,o=e.updateMethods,s=e.missingMembers;return Object(Q.jsxs)(ua,{children:[r.map((function(e){var t=s.includes(e.member),r=Object(Q.jsx)(Fi,{disabled:n,className:n?"disabled":null,color:t?"danger":"primary",onRemoveClick:function(){return o.remove(e)},children:Object(Q.jsx)(Qi,{disabled:n,availableMembers:a,style:{width:150,textOverflow:"ellipsis",overflow:"hidden"},onClick:function(t){return o.update(e,Object(l.a)(Object(l.a)({},e),{},{dimension:t}))},children:e.dimension.title})});return Object(Q.jsxs)(x.Fragment,{children:[t?Object(Q.jsx)(Bi,{children:r}):r,Object(Q.jsx)(da,{disabled:n,value:e.operator,style:{width:200},onChange:function(t){return o.update(e,Object(l.a)(Object(l.a)({},e),{},{operator:t}))},children:e.operators.map((function(e){return Object(Q.jsx)(da.Option,{value:e.name,children:e.title},e.name)}))}),Object(Q.jsx)(Yi,{disabled:n,member:e,updateMethods:o},"filterInput")]},e.index)})),Object(Q.jsx)(Qi,{availableMembers:a,type:"dashed",disabled:n,icon:Object(Q.jsx)(Ea.a,{}),onClick:function(e){return o.add({member:e})},children:r.length?null:i})]})},Hi=n(836),Wi=n(129),Gi=n.n(Wi),$i=D.b.div(Ji||(Ji=Object(O.a)(["\n  color: var(--dark-04-color);\n  line-height: 32px;\n"]))),Zi=Hi.a.RangePicker,Xi=[{title:"Custom",value:"custom"},{title:"All time",value:void 0},{value:"Today"},{value:"Yesterday"},{value:"This week"},{value:"This month"},{value:"This quarter"},{value:"This year"},{value:"Last 7 days"},{value:"Last 30 days"},{value:"Last week"},{value:"Last month"},{value:"Last quarter"},{value:"Last year"}],eo=function(e){var t,n=e.members,r=void 0===n?[]:n,a=e.disabled,i=void 0!==a&&a,o=e.availableMembers,s=e.missingMembers,c=e.addMemberName,u=e.updateMethods,d=e.parsedDateRange,b=Array.isArray(null===(t=r[0])||void 0===t?void 0:t.dateRange),p=Object(x.useState)(!1),h=Object(B.a)(p,2),f=h[0],m=h[1];return Object(Q.jsxs)(ua,{children:[r.map((function(e,t){var n,r,a,c=s.includes(e.dimension.title),p=Object(Q.jsx)(Fi,{disabled:i,className:i?"disabled":null,color:c?"danger":"primary",onRemoveClick:function(){return u.remove(e)},children:Object(Q.jsx)(Qi,{"data-testid":"TimeDimension",disabled:i,availableMembers:o,onClick:function(t){return u.update(e,Object(l.a)(Object(l.a)({},e),{},{dimension:t}))},children:e.dimension.title})});return Object(Q.jsxs)(x.Fragment,{children:[c?Object(Q.jsx)(Bi,{children:p}):p,Object(Q.jsx)($i,{children:"for"}),Object(Q.jsx)(Mi,{disabled:i,overlay:(a=function(t){"custom"===t.value?m(!0):(u.update(e,Object(l.a)(Object(l.a)({},e),{},{dateRange:t.value})),m(!1))},Object(Q.jsx)(P.a,{children:Xi.map((function(e){return Object(Q.jsx)(P.a.Item,{onClick:function(){return a(e)},children:e.title||e.value},e.title||e.value)}))})),children:f||b?"Custom":e.dateRange||"All time"}),f||b?Object(Q.jsx)(Zi,{disabled:i,format:"YYYY-MM-DD",defaultValue:(d||[]).map((function(e){return Gi()(e)})),onChange:function(t){return function(e,t){t&&!t.some((function(e){return!e}))&&u.update(e,Object(l.a)(Object(l.a)({},e),{},{dateRange:t.map((function(e){return e.format("YYYY-MM-DD")}))}))}(e,t)}}):null,Object(Q.jsx)($i,{children:"by"}),Object(Q.jsx)(Mi,{disabled:i,overlay:(n=e.dimension,r=function(t){return u.update(e,Object(l.a)(Object(l.a)({},e),{},{granularity:t.name}))},Object(Q.jsx)(P.a,{children:n.granularities.length?n.granularities.map((function(e){return Object(Q.jsx)(P.a.Item,{onClick:function(){return r(e)},children:e.title},e.title)})):Object(Q.jsx)(P.a.Item,{disabled:!0,children:"No members found"})})),children:e.dimension.granularities.find((function(t){return t.name===e.granularity}))&&e.dimension.granularities.find((function(t){return t.name===e.granularity})).title})]},t)})),!r.length&&Object(Q.jsx)(Qi,{"data-testid":"TimeDimension",disabled:i,availableMembers:o,type:"dashed",icon:Object(Q.jsx)(Ea.a,{}),onClick:function(e){return u.add({dimension:e,granularity:"day"})},children:c})]})},to=n(865),no=n(866),ro=n(867),ao=n(868),io=n(869),oo=n(209),so=[{name:"line",title:"Line",icon:Object(Q.jsx)(to.a,{})},{name:"area",title:"Area",icon:Object(Q.jsx)(no.a,{})},{name:"bar",title:"Bar",icon:Object(Q.jsx)(ro.a,{})},{name:"pie",title:"Pie",icon:Object(Q.jsx)(ao.a,{})},{name:"table",title:"Table",icon:Object(Q.jsx)(io.a,{})},{name:"number",title:"Number",icon:Object(Q.jsx)(oo.a,{})}],co=function(e){var t=e.chartType,n=e.updateChartType,r=Object(Q.jsx)(P.a,{"data-testid":"chart-type-dropdown",children:so.map((function(e){return Object(Q.jsxs)(P.a.Item,{onClick:function(){return n(e.name)},children:[e.icon," ",e.title]},e.title)}))}),a=so.find((function(e){return e.name===t}));return Object(Q.jsx)(Mi,{"data-testid":"chart-type-btn",overlay:r,icon:null===a||void 0===a?void 0:a.icon,style:{border:0},children:(null===a||void 0===a?void 0:a.title)||""})},uo=n(834),lo=n(844),bo=n(484),po=n.n(bo),ho=n(113),fo=n(870);function mo(e){var t=e.id,n=e.index;return Object(Q.jsx)(ho.b,{draggableId:t,index:n,children:function(e){var n=e.draggableProps,r=e.dragHandleProps,a=e.innerRef;return Object(Q.jsx)("div",Object(l.a)(Object(l.a)(Object(l.a)({ref:a},n),r),{},{style:Object(l.a)(Object(l.a)({},n.style),{},{border:"1px dashed var(--dark-05-color)",borderRadius:4,padding:"5px 12px",lineHeight:"22px"}),children:Object(Q.jsxs)(V.a.Text,{ellipsis:!0,style:{maxWidth:"100%"},children:[Object(Q.jsx)(fo.a,{style:{marginRight:8}}),t]})}))}})}function jo(e){var t=e.pivotConfig,n=e.axis;return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(V.a.Text,{strong:!0,style:{display:"flex",justifyContent:"center",padding:"8px 16px",background:"var(--light-5)",borderBottom:"1px solid var(--light-color)"},children:n}),Object(Q.jsx)("div",{"data-testid":"pivot-popover-".concat(n),style:{padding:"8px"},children:Object(Q.jsx)(ho.c,{droppableId:n,children:function(e){return Object(Q.jsxs)("div",Object(l.a)(Object(l.a)({ref:e.innerRef},e.droppableProps),{},{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr)",gap:"8px",height:"100%",minHeight:"32px"},children:[t[n].map((function(e,t){return Object(Q.jsx)(mo,{id:e,index:t},e)})),e.placeholder]}))}})})]})}var vo=["source","destination"];function go(e){var t=e.pivotConfig,n=e.onMove;return Object(Q.jsx)(ho.a,{onDragEnd:function(e){var t=e.source,r=e.destination;Object(b.a)(e,vo);r&&n({sourceIndex:t.index,destinationIndex:r.index,sourceAxis:t.droppableId,destinationAxis:r.droppableId})},children:Object(Q.jsxs)(Ta.a,{children:[Object(Q.jsx)(Da.a,{span:12,style:{minWidth:160},children:Object(Q.jsx)(jo,{pivotConfig:t,axis:"x"})}),Object(Q.jsx)(Da.a,{span:12,style:{minWidth:160},children:Object(Q.jsx)(jo,{pivotConfig:t,axis:"y"})})]})})}var yo=n(241);function Oo(e){var t=e.pivotConfig,n=e.onUpdate;return Object(Q.jsx)(yo.a,{checked:t.fillMissingDates,onChange:function(){return n({fillMissingDates:!t.fillMissingDates})},children:"Fill Missing Dates"})}var xo=n(295);function ko(e){var t=e.id,n=e.index,r=e.order,a=void 0===r?"none":r,i=e.children,o=e.onOrderChange;return Object(Q.jsx)(ho.b,{draggableId:t,index:n,children:function(e){var n=e.draggableProps,r=e.dragHandleProps,s=e.innerRef;return Object(Q.jsxs)("div",Object(l.a)(Object(l.a)(Object(l.a)({"data-testid":"order-item",ref:s},n),r),{},{style:Object(l.a)({display:"flex",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center",marginBottom:8},n.style),children:[Object(Q.jsx)(fo.a,{}),Object(Q.jsx)(V.a.Text,{ellipsis:!0,style:{margin:"0 auto 0 8px",padding:"5px 0"},children:i}),Object(Q.jsxs)(xo.a.Group,{onChange:function(e){return o(t,e.target.value)},defaultValue:a,size:"small",style:{marginLeft:"8px"},children:[Object(Q.jsx)(xo.a.Button,{value:"asc",children:"ASC"}),Object(Q.jsx)(xo.a.Button,{value:"desc",children:"DESC"}),Object(Q.jsx)(xo.a.Button,{value:"none",children:"NONE"})]})]}))}})}function wo(e){var t=e.orderMembers,n=e.onOrderChange,r=e.onReorder;return Object(Q.jsx)(ho.a,{onDragEnd:function(e){var t=e.source,n=e.destination;r(t&&t.index,n&&n.index)},children:Object(Q.jsx)(ho.c,{droppableId:"droppable",children:function(e){return Object(Q.jsxs)("div",Object(l.a)(Object(l.a)({"data-testid":"order-popover",ref:e.innerRef},e.droppableProps),{},{children:[t.map((function(e,t){var r=e.id,a=e.title,i=e.order;return Object(Q.jsx)(ko,{id:r,index:t,order:i,onOrderChange:n,children:a},r)})),e.placeholder]}))}})})}function So(e){var t=e.pivotConfig,n=e.orderMembers,r=e.limit,a=e.disabled,i=e.onMove,o=e.onUpdate,s=e.onReorder,c=e.onOrderChange,u=e.isQueryPresent,l=Object(x.useState)(r),d=Object(B.a)(l,2),b=d[0],p=d[1],h=Object(x.useState)(!1),f=Object(B.a)(h,2),m=f[0],j=f[1];return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(po.a,{style:{lineHeight:"32px"},children:"Settings:"}),Object(Q.jsx)(Sr,{content:null===t?Object(Q.jsx)(ea.a,{}):Object(Q.jsxs)("div",{"data-testid":"pivot-popover",children:[Object(Q.jsx)(go,{pivotConfig:t,onMove:i}),Object(Q.jsx)(uo.a,{style:{margin:0}}),Object(Q.jsx)("div",{style:{padding:"8px"},children:Object(Q.jsx)(Oo,{pivotConfig:t,onUpdate:o})})]}),placement:"bottomLeft",trigger:"click",children:Object(Q.jsx)(gr,{"data-testid":"pivot-btn",disabled:!u||a,style:{border:0},children:"Pivot"})}),Object(Q.jsx)(Sr,{content:Object(Q.jsx)("div",{style:{padding:"8px",paddingBottom:1},children:Object(Q.jsx)(wo,{orderMembers:n,onReorder:s,onOrderChange:c})}),placement:"bottomLeft",trigger:"click",children:Object(Q.jsx)(gr,{"data-testid":"order-btn",disabled:!u||a,style:{border:0},children:"Order"})}),Object(Q.jsx)(Sr,{visible:m,content:Object(Q.jsx)("div",{style:{padding:"8px"},children:Object(Q.jsxs)("label",{children:["Limit"," ",Object(Q.jsx)(lo.a,{prefix:"Limit",type:"number",value:b,step:500,onChange:p,onPressEnter:function(){o({limit:b}),j(!1)}})]})}),placement:"bottomLeft",trigger:"click",onVisibleChange:function(e){j(e),e||o({limit:b})},children:Object(Q.jsx)(gr,{"data-testid":"limit-btn",disabled:!u||a,style:{border:0},children:"Limit"})})]})}var Co,Do,To,Eo,Ro,qo=n(871),Mo=n(497),Po=Object(x.createContext)({});function Ao(e){var t=e.children,n=Object(x.useState)({}),r=Object(B.a)(n,2),a=r[0],i=r[1],o=Object(x.useState)({}),s=Object(B.a)(o,2),c=s[0],u=s[1],d=Object(x.useState)({}),b=Object(B.a)(d,2),p=b[0],h=b[1],f=Object(x.useState)({}),m=Object(B.a)(f,2),j=m[0],v=m[1],g=Object(x.useState)({}),y=Object(B.a)(g,2),O=y[0],k=y[1],w=Object(x.useState)({}),S=Object(B.a)(w,2),C=S[0],D=S[1],T=Object(x.useState)({}),E=Object(B.a)(T,2),R=E[0],q=E[1],M=Object(x.useState)({}),P=Object(B.a)(M,2),A=P[0],L=P[1];return Object(Q.jsx)(Po.Provider,{value:{chartRendererState:a,setChartRendererReady:function(e,t){i((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))},queryStatus:c,setQueryStatus:function(e,t){u((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))},resultSetExists:p,setResultSetExists:function(e,t){h((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))},isQueryLoading:j,setQueryLoading:function(e,t){v((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))},queryError:O,setQueryError:function(e,t){k((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))},isBuildInProgress:C,setBuildInProgress:function(e,t){D((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))},slowQuery:R,setSlowQuery:function(e,t){q((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))},slowQueryFromCache:A,setSlowQueryFromCache:function(e,t){L((function(n){return Object(l.a)(Object(l.a)({},n),{},Object(oe.a)({},e,t))}))}},children:t})}function Lo(e){var t=Object(x.useContext)(Po),n=t.chartRendererState,r=t.queryStatus,a=t.resultSetExists,i=t.isQueryLoading,o=t.queryError,s=t.isBuildInProgress,c=t.slowQuery,u=t.slowQueryFromCache;return{isChartRendererReady:Boolean(n[e]),queryStatus:r[e],resultSetExists:a[e],isQueryLoading:Boolean(i[e]),queryError:o[e]||null,isBuildInProgress:Boolean(s[e]),slowQuery:Boolean(c[e]),slowQueryFromCache:Boolean(u[e])}}function Qo(){var e=Object(x.useContext)(Po);return{setChartRendererReady:e.setChartRendererReady,setQueryStatus:e.setQueryStatus,setResultSetExists:e.setResultSetExists,setQueryLoading:e.setQueryLoading,setQueryError:e.setQueryError,setBuildInProgress:e.setBuildInProgress,setSlowQuery:e.setSlowQuery,setSlowQueryFromCache:e.setSlowQueryFromCache}}var Io=V.a.Text,zo=D.b.div(Co||(Co=Object(O.a)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n"]))),Fo=D.b.div(Do||(Do=Object(O.a)(["\n  visibility: ",";\n  min-height: 400px;\n\n  & > iframe {\n    width: 100%;\n    min-height: 400px;\n    border: none;\n  }\n"])),(function(e){return e.invisible?"hidden":"visible"})),No=D.b.div(To||(To=Object(O.a)(["\n  position: absolute;\n  width: 100%;\n  bottom: -4em;\n  animation: fadeIn 0.3s;\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n\n    to {\n      opacity: 1;\n    }\n  }\n"]))),Bo=D.b.div(Eo||(Eo=Object(O.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n"]))),_o=D.b.div(Ro||(Ro=Object(O.a)(["\n  position: relative;\n  width: 100%;\n  text-align: center;\n"])));function Uo(e){var t=e.queryId,n=e.areQueriesEqual,r=e.isFetchingMeta,a=e.iframeRef,i=e.framework,o=e.queryHasMissingMembers,s=e.onRunButtonClick,c=Object(x.useContext)(Ya).cubejsApi,l=Lo(t),b=l.isChartRendererReady,p=l.isQueryLoading,h=l.resultSetExists,f=l.queryError,m=l.isBuildInProgress,j=l.slowQuery,v=l.slowQueryFromCache,g=Qo(),y=g.setResultSetExists,O=g.setChartRendererReady,k=g.setQueryError,w=Object(x.useRef)(null);Object(Mo.a)("cmd+enter",(function(){var e;null===(e=w.current)||void 0===e||e.click()})),Object(x.useEffect)((function(){return function(){O(t,!1)}}),[]),Object(x.useEffect)((function(){!n&&f&&k(t,null)}),[t,n,f]),Object(x.useEffect)((function(){y(t,!1)}),[i]);var C=o||p||m||!c,D=!b||m||Boolean(f)||o||C||!n||!h,T=j?"This query takes more than 5 seconds to execute. Please consider using pre-aggregations to improve its performance. ":v?"This query takes more than 5 seconds to execute. It was served from the cache because Cube.js wasn't able to renew it in less than 5 seconds. Please consider using pre-aggregations to improve its performance. ":"";return Object(Q.jsxs)(Q.Fragment,{children:[(j||v)&&Object(Q.jsx)(S.a,{style:{marginBottom:24},message:T,type:"warning"}),f?Object(Q.jsx)(jr,{error:f}):o?Object(Q.jsx)("div",{children:"At least one of the query members is missing from your data schema. Please update your query or data schema."}):C?Object(Q.jsx)(zo,{children:Object(Q.jsx)(Bo,{children:Object(Q.jsxs)(_o,{children:[Object(Q.jsx)(dr,{full:!1}),m&&Object(Q.jsx)(No,{children:Object(Q.jsx)(Io,{strong:!0,style:{fontSize:18},children:"Building pre-aggregations..."})})]})})}):n&&h?null:Object(Q.jsx)(zo,{children:Object(Q.jsx)(Bo,{children:Object(Q.jsx)(gr,{"data-testid":"run-query-btn",ref:w,size:"large",type:"primary",loading:!b||r,icon:Object(Q.jsx)(qo.a,{}),onClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:case"end":return e.stop()}}),e)}))),children:"Run"})})}),Object(Q.jsx)(Fo,{invisible:D,children:c?Object(Q.jsx)("iframe",{id:"iframe-".concat(t),"data-testid":"chart-renderer",ref:a,title:"Chart renderer",src:"/chart-renderers/".concat(i,"/index.html#queryId=").concat(t)}):null})]})}var Vo=function(){return Object(Q.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 10 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(Q.jsx)("path",{d:"M0.138775 8.38607L4.57392 0.454234C5.0729 -0.438144 6.26792 0.087229 6.13217 1.13929L4.99992 9.91394H0.853913C0.177797 9.91394 -0.229263 9.04427 0.138775 8.38607Z",fill:"currentColor"}),Object(Q.jsx)("path",{d:"M9.86123 7.61393L5.42608 15.5458C4.9271 16.4381 3.73208 15.9128 3.86783 14.8607L5.00008 6.08606H9.14609C9.8222 6.08606 10.2293 6.95573 9.86123 7.61393Z",fill:"currentColor"})]})},Yo=Object(x.createContext)({});var Jo,Ko=P.a.SubMenu,Ho=["measures","dimensions","timeDimensions"];function Wo(e){var t=e.selectedKeys,n=e.membersByCube,r=e.onSelect,a=t.map((function(e){return e.split(".")[0]}));return Object(Q.jsx)(P.a,{style:{width:256},selectedKeys:t,defaultOpenKeys:a,mode:"inline",onClick:function(e){var t=e.domEvent.target.dataset.membertype;r(t,e.key.toString())},children:n.map((function(e){return Object(Q.jsx)(Ko,{title:e.cubeTitle,children:Ho.map((function(t){return Object(Q.jsx)(P.a.ItemGroup,{title:(n=t,n[0].toUpperCase()+n.slice(1)),children:e[t].filter((function(e){return!("dimensions"===t&&"time"===e.type)})).map((function(e){return Object(Q.jsx)(P.a.Item,{"data-membertype":t,children:e.title},e.name)}))},t);var n}))},e.cubeName)}))})}var Go,$o=D.b.div(Jo||(Jo=Object(O.a)(["\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n"])));function Zo(e){var t=e.title,n=e.members,r=e.onRemove;return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(V.a.Paragraph,{children:Object(Q.jsx)(V.a.Text,{children:t})}),Object(Q.jsx)($o,{children:n.map((function(e){return Object(Q.jsx)("div",{children:Object(Q.jsx)(Fi,{onRemoveClick:function(){return r(e.name)},children:Object(Q.jsx)(Qi,{showNoMembersPlaceholder:!1,availableMembers:[],onClick:function(){},children:e.title})},e.name)},e.name)}))})]})}var Xo=D.b.div(Go||(Go=Object(O.a)(["\n  display: flex;\n  gap: 16px;\n"])));function es(e){var t=e.member,n=e.granularity,r=e.onGranularityChange,a=e.onRemove;return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(V.a.Paragraph,{children:Object(Q.jsx)(V.a.Text,{children:"Time dimension"})}),Object(Q.jsxs)(Xo,{children:[Object(Q.jsx)(Fi,{onRemoveClick:function(){return a(t.name)},children:Object(Q.jsx)(Qi,{showNoMembersPlaceholder:!1,availableMembers:[],onClick:function(){},children:t.title})},t.name),n?Object(Q.jsx)(Mi,{overlay:Object(Q.jsx)(P.a,{children:Tt.map((function(e){var t=e.name,n=e.title;return Object(Q.jsx)(P.a.Item,{onClick:function(){return r(t)},children:n},n)}))}),children:n}):null]})]})}var ts=n(489);function ns(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main",n=[];if(e.measures.length&&n.push("  measures: [".concat(e.measures.map((function(e){return e})).join(", "),"]")),e.dimensions.length&&n.push("  dimensions: [".concat(e.dimensions.map((function(e){return e})).join(", "),"]")),e.timeDimensions.length){var r=e.timeDimensions[0],a=r.dimension,i=r.granularity;n.push("  timeDimension: ".concat(a)),i&&n.push("  granularity: `".concat(i,"`"))}var o="{\n".concat(n.join(",\n"),"\n}");return{code:"".concat(Object(ts.a)(t),": ").concat(o),value:o}}var rs,as,is=["isCloud"],os=["order","limit","filters"],ss=V.a.Paragraph,cs=V.a.Link,us=Z.a.TabPane,ls=D.b.div(rs||(rs=Object(O.a)(["\n  flex-grow: 1;\n  min-width: 0;\n"]))),ds=D.b.div(as||(as=Object(O.a)(["\n  max-width: 300px;\n"])));function bs(e){var t,n,r=e.apiUrl,a=e.defaultQuery,i=e.availableMembers,o=e.transformedQuery,s=Mn(),c=Tn().token,p=Object(x.useContext)(Yo),h=p.isCloud,f=Object(b.a)(p,is),m=o.leafMeasureAdditive&&!o.hasMultipliedMeasures,j=Object(x.useRef)(0),v=Object(x.useState)(!1),g=Object(B.a)(v,2),y=g[0],O=g[1],k=Object(x.useState)(!1),w=Object(B.a)(k,2),C=w[0],D=w[1],T=Object(x.useState)("main"),E=Object(B.a)(T,2),R=E[0],q=E[1],M=Ln(!m),P=Object(B.a)(M,2),A=P[0],L=P[1],I=(a.order,a.limit,a.filters,Object(b.a)(a,os)),z=Object(x.useState)(function(e){var t,n={measures:[],dimensions:[],timeDimensions:[]};if((null===e||void 0===e?void 0:e.leafMeasures.length)&&(n.measures=Object(bn.a)(e.leafMeasures)),(null===e||void 0===e?void 0:e.sortedDimensions.length)&&(n.dimensions=Object(bn.a)(e.sortedDimensions)),(null===e||void 0===e?void 0:e.sortedTimeDimensions.length)&&null!=(null===(t=e.sortedTimeDimensions[0])||void 0===t?void 0:t[1])){var r=Object(B.a)(e.sortedTimeDimensions[0],2),a=r[0],i=r[1];n.timeDimensions=[{dimension:a,granularity:i}]}return n}(o)),F=Object(B.a)(z,2),N=F[0],_=F[1],U=Object(x.useMemo)((function(){var e=[];return["measures","dimensions","timeDimensions"].map((function(t){if("timeDimensions"===t){var n,r=((null===(n=N[t])||void 0===n?void 0:n[0])||{}).dimension;r&&e.push(r)}else{var a;null===(a=N[t])||void 0===a||a.map((function(t){return e.push(t)}))}})),e}),[N]);An((function(){var e=j.current,t=N.measures,n=N.dimensions,a=N.timeDimensions;function i(){return(i=Object(d.a)(u.a.mark((function i(){var l,d;return u.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,jn("".concat(r,"/pre-aggregations/can-use"),"POST",{token:c,body:{transformedQuery:o,references:{measures:t,dimensions:n,timeDimensions:a}}});case 2:l=i.sent,d=l.json,s()&&e===j.current&&(O(d.canUsePreAggregationForTransformedQuery),j.current++);case 5:case"end":return i.stop()}}),i)})))).apply(this,arguments)}null!=c&&function(){i.apply(this,arguments)}()}),[s,N,c,j]);var V=o&&(o.leafMeasures[0]||o.sortedDimensions[0]||"your").split(".")[0],H=Object.fromEntries(hn([].concat(Object(bn.a)(i.measures),Object(bn.a)(i.dimensions),Object(bn.a)(i.timeDimensions))));function W(){return G.apply(this,arguments)}function G(){return(G=Object(d.a)(u.a.mark((function e(){var t,n,r,a,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(){se.a.success({message:"Pre-aggregation has been added to the ".concat(V," cube")})},t={preAggregationName:R,cubeName:V,code:ns(N,R).value},D(!0),h){e.next=10;break}return e.next=6,jn("/playground/schema/pre-aggregation","POST",{body:t});case 6:(r=e.sent).ok?n():(a=r.json.error,se.a.error({message:a})),e.next=17;break;case 10:if(null!=f.addPreAggregationToSchema){e.next=12;break}throw new Error("cloud.addPreAggregationToSchema is not defined");case 12:return e.next=14,f.addPreAggregationToSchema(t);case 14:i=e.sent,(o=i.error)?se.a.error({message:o}):n();case 17:D(!1);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e){return function(t){_(function(e,t,n){var r,a,i,o,s=JSON.parse(JSON.stringify(e));return"timeDimensions"===t?(null===(r=s.timeDimensions)||void 0===r||null===(a=r[0])||void 0===a?void 0:a.dimension)===n?s.timeDimensions=[]:s.timeDimensions=[Object(l.a)(Object(l.a)({granularity:"day"},null===(i=s.timeDimensions)||void 0===i?void 0:i[0]),{},{dimension:n})]:(null===(o=s[t])||void 0===o?void 0:o.includes(n))?s[t]=s[t].filter((function(e){return n!==e})):s[t]=[].concat(Object(bn.a)(s[t]||[]),[n]),s}(N,e,t))}}return Object(Q.jsxs)(J,{justifyContent:"space-between",gap:2,children:[A?null:Object(Q.jsx)("div",{children:Object(Q.jsx)(Wo,{selectedKeys:U,membersByCube:fn(i),onSelect:function(e,t){$(e)(t)}})}),Object(Q.jsx)(ls,{children:Object(Q.jsxs)(ne.b,{direction:"vertical",style:{width:"100%"},children:[!A&&Object(Q.jsx)(J,{justifyContent:"flex-end",children:Object(Q.jsx)(Y.a,{type:"primary",onClick:L,children:"Preview rollup definition"})}),Object(Q.jsxs)(J,{direction:"column",gap:2,children:[A?Object(Q.jsx)(X.a,{value:R,onChange:function(e){return q(e.target.value)}}):null,Object(Q.jsx)(K,{children:A?m?Object(Q.jsxs)("div",{children:[Object(Q.jsxs)(ss,{children:["Add the following pre-aggregation to the ",Object(Q.jsx)("b",{children:V})," cube."]}),Object(Q.jsx)(qr,{style:{marginBottom:16},code:ns(N,R).code}),Object(Q.jsxs)(J,{justifyContent:"flex-end",gap:2,children:[Object(Q.jsx)(Y.a,{onClick:L,children:"Back to editing"}),Object(Q.jsx)(Y.a,{type:"primary",loading:C,onClick:W,children:"Add to the Data Schema"})]})]}):Object(Q.jsxs)(ss,{children:[Object(Q.jsx)(cs,{href:"https://cube.dev/docs/caching/pre-aggregations/getting-started#ensuring-pre-aggregations-are-targeted-by-queries",target:"_blank",children:"Current query cannot be rolled up due to it is not additive"}),". Please consider removing not additive measures like `countDistinct` or `avg`. You can also try to use"," ",Object(Q.jsx)(cs,{href:"https://cube.dev/docs/pre-aggregations#parameters-type-originalsql",target:"_blank",children:"originalSql"})," ","pre-aggregation instead."]}):null})]}),A?null:Object(Q.jsx)(Z.a,{children:Object(Q.jsx)(us,{tab:"Members",children:Object(Q.jsxs)("div",{children:[(null===(t=N.measures)||void 0===t?void 0:t.length)?Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Zo,{title:"Measures",members:N.measures.map((function(e){return H[e]})),onRemove:$("measures")}),Object(Q.jsx)(uo.a,{})]}):null,(null===(n=N.dimensions)||void 0===n?void 0:n.length)?Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(Zo,{title:"Dimensions",members:N.dimensions.map((function(e){return H[e]})),onRemove:$("dimensions")}),Object(Q.jsx)(uo.a,{})]}):null,N.timeDimensions.length?Object(Q.jsx)(es,{member:H[N.timeDimensions[0].dimension],granularity:N.timeDimensions[0].granularity,onGranularityChange:function(e){_(Object(l.a)(Object(l.a)({},N),{},{timeDimensions:[Object(l.a)(Object(l.a)({},N.timeDimensions[0]||{}),e?{granularity:e}:null)]}))},onRemove:$("timeDimensions")}):null]})},"members")})]})}),Object(Q.jsx)(ds,{children:Object(Q.jsxs)(J,{direction:"column",gap:2,children:[m&&(y?Object(Q.jsx)(S.a,{message:"This pre-aggregation will match and accelerate this query:"}):Object(Q.jsx)(S.a,{type:"warning",message:"This pre-aggregation will not match this query:"})),Object(Q.jsx)(qr,{style:{marginBottom:16},code:JSON.stringify(I,null,2)})]})})]})}var ps,hs,fs,ms=["isAggregated","external","extDbType","preAggregationType"],js=V.a.Link,vs=D.b.div(ps||(ps=Object(O.a)(["\n  display: flex;\n  align-items: center;\n  padding: 2px 4px;\n  border-radius: 4px;\n  background: var(--warning-bg-color);\n"])));function gs(e){var t=e.isAggregated,n=e.external,r=e.extDbType,a=e.preAggregationType,i=Object(b.a)(e,ms),o=function(e){var t=En(),n=t.serverCoreVersion,r=void 0===n?"":n,a=t.coreServerVersion,i=void 0===a?"":a,o=!1;try{var s=(r||i).split(".").map(Number),c=Object(B.a)(s,3),u=c[1],l=c[2],d=e.split(".").map(Number),b=Object(B.a)(d,3),p=b[1],h=b[2];o=u>p||u===p&&l>=h}catch(f){}return o}("0.28.4"),s=Ln(),c=Object(B.a)(s,2),u=c[0],l=c[1];return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsxs)(ne.b,{style:{marginLeft:"auto"},children:[t&&Object(Q.jsx)(vs,{children:Object(Q.jsx)(ne.b,{size:4,children:Object(Q.jsx)(E.a,{style:{color:"var(--warning-color)"},component:function(){return Object(Q.jsx)(Vo,{})}})})}),t?Object(Q.jsx)(V.a.Text,{children:"Query was accelerated with pre-aggregation"}):o?Object(Q.jsxs)(Y.a,{type:"link",onClick:l,children:["Query was not accelerated with pre-aggregation ","->"]}):null,t&&n&&"cubestore"!==r?Object(Q.jsx)(S.a,{message:"Consider migrating your pre-aggregations to Cube Store for better performance with larger datasets",type:"warning"}):null,t&&!n&&"originalSql"!==a?Object(Q.jsx)(S.a,{message:Object(Q.jsxs)(Q.Fragment,{children:["For optimized performance, consider using ",Object(Q.jsx)("b",{children:"external"})," ",a," pre-aggregation, rather than the source database (internal)"]}),type:"warning"}):null]}),Object(Q.jsx)(te.a,{title:"Rollup Designer",visible:u,footer:Object(Q.jsx)(js,{style:{paddingTop:16},href:"https://cube.dev/docs/caching/pre-aggregations/getting-started",target:"_blank",children:"Further reading about pre-aggregations for reference."}),bodyStyle:{padding:16},width:1024,onCancel:l,children:i.transformedQuery?Object(Q.jsx)(bs,{apiUrl:i.apiUrl,defaultQuery:i.query,availableMembers:i.availableMembers,transformedQuery:i.transformedQuery}):null})]})}var ys,Os,xs,ks=D.b.div(hs||(hs=Object(O.a)(["\n  display: flex;\n  flex-flow: column;\n  margin-right: 24px;\n  margin-bottom: 16px;\n\n  > *:first-child {\n    margin-bottom: 8px;\n  }\n"]))),ws=D.b.div(fs||(fs=Object(O.a)(["\n  background-color: var(--layout-body-background);\n  padding-bottom: 16px;\n"]))),Ss={react:[{value:"chartjs",title:"Chart.js"},{value:"bizcharts",title:"Bizcharts"},{value:"recharts",title:"Recharts"},{value:"d3",title:"D3"}],angular:[{value:"angular-ng2-charts",title:"ng2"}],vue:[{value:"chartkick",title:"Chartkick"}]},Cs=function(e,t){return Object.keys(e).map((function(n){return Object(oe.a)({},n,(function(r,a){var i="".concat(n.split("").map((function(e,t){return 0===t?e.toUpperCase():e})).join("")," Member");(null===a||void 0===a?void 0:a.values)&&(i="Update Filter Values"),(null===a||void 0===a?void 0:a.dateRange)&&(i="Update Date Range"),(null===a||void 0===a?void 0:a.granularity)&&(i="Update Granularity"),Ur(i,{memberName:t});for(var o=arguments.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=arguments[c];return e[n].apply(null,[r,a].concat(s))}))})).reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),t)}),{})};function Ds(e){var t=e.iframeRef,n=e.pivotConfig,r=e.chartType;return An((function(){(null===t||void 0===t?void 0:t.current)&&["table","bar"].includes(r)&&be(t.current.contentDocument,"chart",{pivotConfig:n})}),[t,n]),null}function Ts(e){var t=e.query1,n=e.query2,r=e.onChange;return Object(x.useEffect)((function(){Et(t,n)||r()}),[Et(t,n)]),null}function Es(e){var t=e.apiUrl,n=e.cubejsToken,r=e.defaultQuery,a=e.queryId,i=e.dashboardSource,o=e.schemaVersion,s=void 0===o?0:o,c=e.initialVizState,b=e.onSchemaChange,p=e.onVizStateChanged,h=Mn(),f=Lo(a),m=f.isChartRendererReady,j=f.queryStatus,v=f.queryError,g=Qo(),y=g.setQueryStatus,O=g.setQueryLoading,k=g.setChartRendererReady,w=g.setQueryError,S=Ce().refreshToken,C=Object(x.useRef)(null),D=Object(x.useRef)(null),T=Object(x.useState)(!1),E=Object(B.a)(T,2),R=E[0],q=E[1],M=Object(x.useState)("react"),P=Object(B.a)(M,2),A=P[0],L=P[1],I=Object(x.useState)("chartjs"),z=Object(B.a)(I,2),F=z[0],N=z[1];function _(e){var t=e.query,n=e.pivotConfig,r=e.chartType;C.current&&(Et(t,D.current)?(be(C.current.contentDocument,"chart",{pivotConfig:n,query:t,chartType:r,chartingLibrary:F}),be(C.current.contentDocument,"refetch")):be(C.current.contentDocument,"chart",{pivotConfig:n,query:t,chartType:r,chartingLibrary:F})),w(a,null),D.current=t}return Object(x.useEffect)((function(){Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:h()&&q(!0);case 3:case"end":return e.stop()}}),e)})))()}),[h]),Object(x.useEffect)((function(){m&&C.current&&be(C.current.contentDocument,"credentials",{token:n,apiUrl:t})}),[C,n,t,m]),R?Object(Q.jsx)(ri,{defaultQuery:r,initialVizState:c,wrapWithQueryRenderer:!1,schemaVersion:s,onSchemaChange:b,onVizStateChanged:p,render:function(e){var r,o,s,c=e.query,b=e.error,p=e.metaError,h=e.isQueryPresent,f=e.chartType,g=e.updateChartType,x=e.measures,w=e.updateMeasures,T=e.dimensions,E=e.updateDimensions,R=e.segments,q=e.updateSegments,M=e.filters,P=e.updateFilters,I=e.timeDimensions,z=e.updateTimeDimensions,B=e.orderMembers,U=e.updateOrder,V=e.pivotConfig,Y=e.updatePivotConfig,J=e.missingMembers,K=e.isFetchingMeta,H=e.dryRunResponse,W=e.availableMembers,G=e.availableFilterMembers;if(H){var $,Z=(H.pivotQuery||{}).timeDimensions;s=null===($=(void 0===Z?[]:Z)[0])||void 0===$?void 0:$.dateRange}else Array.isArray(null===(r=c.timeDimensions)||void 0===r||null===(o=r[0])||void 0===o?void 0:o.dateRange)&&(s=c.timeDimensions[0].dateRange);return Object(Q.jsxs)(ws,{"data-testid":"query-builder-".concat(a),children:[Object(Q.jsx)(Ta.a,{justify:"space-around",align:"top",gutter:24,style:{marginBottom:12},children:Object(Q.jsxs)(Da.a,{span:24,children:[Object(Q.jsx)(kr,{bordered:!1,style:{borderRadius:0},children:Object(Q.jsxs)(Ta.a,{align:"top",gutter:0,style:{marginBottom:-12},children:[Object(Q.jsxs)(ks,{children:[Object(Q.jsx)(ca,{children:"Measures"}),Object(Q.jsx)(_i,{disabled:K,members:x,availableMembers:(null===W||void 0===W?void 0:W.measures)||[],missingMembers:J,addMemberName:"Measure",updateMethods:Cs(w,"Measure")})]}),Object(Q.jsxs)(ks,{children:[Object(Q.jsx)(ca,{children:"Dimensions"}),Object(Q.jsx)(_i,{disabled:K,members:T,availableMembers:(null===W||void 0===W?void 0:W.dimensions)||[],missingMembers:J,addMemberName:"Dimension",updateMethods:Cs(E,"Dimension")})]}),Object(Q.jsxs)(ks,{children:[Object(Q.jsx)(ca,{children:"Segment"}),Object(Q.jsx)(_i,{disabled:K,members:R,availableMembers:(null===W||void 0===W?void 0:W.segments)||[],missingMembers:J,addMemberName:"Segment",updateMethods:Cs(q,"Segment")})]}),Object(Q.jsxs)(ks,{children:[Object(Q.jsx)(ca,{children:"Time"}),Object(Q.jsx)(eo,{disabled:K,members:I,availableMembers:(null===W||void 0===W?void 0:W.timeDimensions)||[],missingMembers:J,addMemberName:"Time",updateMethods:Cs(z,"Time"),parsedDateRange:s})]}),Object(Q.jsxs)(ks,{children:[Object(Q.jsx)(ca,{children:"Filters"}),Object(Q.jsx)(Ki,{disabled:K,members:M,availableMembers:G,missingMembers:J,addMemberName:"Filter",updateMethods:Cs(P,"Filter")})]})]})}),Object(Q.jsxs)(ua,{style:{margin:16,marginBottom:0},children:[Object(Q.jsx)(co,{chartType:f||"line",updateChartType:function(e){Ur("Change Chart Type"),g(e),C.current&&be(C.current.contentDocument,"chart",{chartType:e,chartingLibrary:F})}}),Object(Q.jsx)(So,{isQueryPresent:h,limit:c.limit||5e3,pivotConfig:V,disabled:K,orderMembers:B,onReorder:U.reorder,onOrderChange:U.set,onMove:Y.moveItem,onUpdate:Y.update}),j?Object(Q.jsx)(gs,Object(l.a)({apiUrl:t,availableMembers:W,query:c},j)):null]})]})}),Object(Q.jsx)(Ta.a,{justify:"space-around",align:"top",gutter:32,style:{margin:0},children:Object(Q.jsxs)(Da.a,{span:24,children:[!h&&p?Object(Q.jsx)(kr,{children:Object(Q.jsx)(jr,{error:p})}):null,!h&&!p&&Object(Q.jsx)("h2",{style:{textAlign:"center"},children:"Choose a measure or dimension to get started"}),h&&Object(Q.jsx)(yi,{apiUrl:t,cubejsToken:n,iframeRef:C,isChartRendererReady:m,query:c,error:b,chartType:f||"line",pivotConfig:V,framework:A,chartingLibrary:F,dashboardSource:i,setFramework:function(e){e!==A&&(O(a,!1),L(e))},setChartLibrary:function(e){C.current&&be(C.current.contentDocument,"chart",{chartingLibrary:e}),N(e)},chartLibraries:Ss,isFetchingMeta:K,render:function(e){var t=e.framework;return p?Object(Q.jsx)(jr,{error:p}):Object(Q.jsx)(Uo,{queryId:a,areQueriesEqual:Et(c,D.current),isFetchingMeta:K,queryError:v,framework:t,chartType:f||"line",query:c,pivotConfig:V,iframeRef:C,queryHasMissingMembers:J.length>0,onRunButtonClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m||!C.current||0!==J.length){e.next=4;break}return e.next=3,S();case 3:_({query:c,pivotConfig:V,chartType:f||"line"});case 4:case"end":return e.stop()}}),e)})))})},onChartRendererReadyChange:function(e){return k(a,e)}})]})}),Object(Q.jsx)(Ds,{iframeRef:C,chartType:f||"line",pivotConfig:V}),Object(Q.jsx)(Ts,{query1:c,query2:D.current,onChange:function(){O(a,!1),y(a,null)}})]})}}):null}var Rs=function(e){var t=e.children;return Object(Q.jsx)("div",{style:{margin:25},children:t})},qs=D.b.div(ys||(ys=Object(O.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: auto;\n  max-width: 1024px;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: ",";\n"])),(function(e){return'url("'.concat(e.src,'")')})),Ms=Object(D.b)(kr)(Os||(Os=Object(O.a)(["\n  && {\n    border: none;\n    border-radius: 8px;\n    margin-bottom: 24px;\n    padding: 16px;\n    ","\n\n    &:hover {\n      padding: 16px;\n      ","\n    }\n\n    button {\n      display: none;\n      position: absolute;\n      margin-left: -64px;\n      top: 80px;\n      left: 50%;\n    }\n\n    svg path {\n      transition: stroke 0.25s ease;\n    }\n\n    && .ant-card-cover {\n      height: 168px;\n      border-radius: 8px 8px 0 0;\n      background: ",";\n      display: flex;\n      align-items: center;\n      position: relative;\n      margin: -16px -16px 0 -16px;\n      padding: 24px 24px 0 24px;\n\n      &::after {\n        content: '';\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n        background: rgba(81, 87, 125, 0.3);\n        opacity: 0;\n        transition: all 0.25s;\n        border-radius: 8px 8px 0 0;\n      }\n\n      div {\n        //box-shadow: 0 -1px 6px rgba(20, 20, 70, .06);\n        background-position: top;\n        border-radius: 4px 4px 0 0;\n      }\n    }\n\n    &&.ant-card-hoverable:hover {\n      box-shadow: 0 15px 20px rgba(67, 67, 107, 0.1);\n      button {\n        display: block;\n      }\n      &:hover .ant-card-cover:after {\n        opacity: ",";\n      }\n    }\n\n    svg path {\n      stroke: var(--primary-color);\n    }\n\n    && .ant-card-body {\n      min-height: 175px;\n      display: flex;\n      place-items: stretch;\n      place-content: start stretch;\n      text-align: left;\n      z-index: 1;\n      padding: 24px 0 16px;\n    }\n\n    && .ant-card-meta {\n      text-align: left;\n    }\n\n    && .ant-card-meta-title {\n      white-space: unset;\n      color: ",";\n      text-align: ",";\n      margin-bottom: 16px;\n    }\n\n    && .ant-card-meta-description {\n      color: ",";\n      opacity: ",";\n      font-size: 13px;\n      text-align: ",";\n      ","\n    }\n  }\n"])),(function(e){return e.createYourOwn?"\n      background: transparent;\n      border: 1px solid var(--purple-03-color);\n    ":""}),(function(e){return e.createYourOwn?"\n        border: 1px solid var(--purple-03-color);\n      ":"border: none;"}),(function(e){return e.createYourOwn?"transparent":"#DEDEF1"}),(function(e){return e.createYourOwn?"0":"1"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--text-color)"}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--dark-04-color)"}),(function(e){return e.createYourOwn?"0.8":1}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"padding: 0 32px;":""})),Ps=Object(D.b)(V.a.Text)(xs||(xs=Object(O.a)(["\n  display: block;\n  font-size: 16px;\n  margin-bottom: 24px;\n"]))),As=function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(e){var r;return Object(j.a)(this,n),(r=t.call(this,e)).dashboardSource=new na,r.state={chartLibrary:Ss.react[0].value,framework:"react",templatePackageName:"react-antd-dynamic",templates:null},r}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dashboardSource.load(!0);case 2:return e.t0=this,e.t1=this.dashboardSource.loadError,e.next=6,this.dashboardSource.templates();case 6:e.t2=e.sent,e.t3={loadError:e.t1,templates:e.t2},e.t0.setState.call(e.t0,e.t3);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n=this,r=this.state,a=r.loadError,i=r.templates;if(a&&-1===a.indexOf("Dashboard app not found"))return Object(Q.jsx)(f.a,{to:"/dashboard"});if(null==i)return Object(Q.jsx)(dr,{});var o=this.state,s=o.chartLibrary,c=o.framework,l=o.templatePackageName,b=o.createOwnModalVisible,p=o.enableWebSocketTransport,h=this.props.history,m=Ss[c].find((function(e){return e.value===s})),j=bi.find((function(e){return e.id===c})),v=null===(e=this.dashboardSource)||void 0===e?void 0:e.templatePackages(c).find((function(e){return e.name===l})),g=i.map((function(e){var t=e.name,r=e.description,a=e.coverUrl;return Object(Q.jsx)(Da.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},children:Object(Q.jsxs)(Ms,{hoverable:!0,bordered:!1,cover:Object(Q.jsx)(qs,{src:a}),children:[Object(Q.jsx)(kr.Meta,{title:t,description:r}),Object(Q.jsx)(gr,{type:"primary",onClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.dashboardSource.applyTemplatePackages(t);case 2:h.push("/dashboard");case 3:case"end":return e.stop()}}),e)}))),children:"Create App"})]})},t)})).concat([Object(Q.jsxs)(Da.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},children:[Object(Q.jsx)(Ms,{onClick:function(){return n.setState({createOwnModalVisible:!0})},hoverable:!0,createYourOwn:!0,bordered:!1,cover:Object(Q.jsx)(Ea.a,{style:{fontSize:60}}),children:Object(Q.jsx)(kr.Meta,{title:"Create your Own",description:"Mix different templates together to create your own dashboard application"})}),Object(Q.jsx)(Ti,{visible:b,onOk:Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n.setState({createOwnModalVisible:!1}),t="react"===c.toLowerCase()?["create-react-app",l,"".concat(s,"-charts"),"".concat(l.match(/^react-(\w+)/)[1],"-tables"),"react-credentials"].concat(p?["react-web-socket-transport"]:[]):"angular"===c.toLowerCase()?["create-ng-app",l,"ng2-charts","ng-credentials"]:["create-vue-app",l,"vue-chartkick-charts"],e.next=5,n.dashboardSource.applyTemplatePackages(t);case 5:h.push("/dashboard");case 6:case"end":return e.stop()}}),e)}))),onCancel:function(){return n.setState({createOwnModalVisible:!1})},onChange:function(e,t){if("framework"===e&&c!==t){var r,a,i,o=(null===(r=n.dashboardSource)||void 0===r?void 0:r.templatePackages(t))||[];n.setState({templatePackageName:null===(a=o[0])||void 0===a?void 0:a.name,chartLibrary:null===(i=Ss[t.toLowerCase()])||void 0===i?void 0:i[0].value})}n.setState(Object(oe.a)({},e,t))},chartLibraries:Ss[c],currentLibraryItem:m,frameworks:bi.filter((function(e){return"vanilla"!==e.id})),framework:c,frameworkItem:j,templatePackages:(null===(t=this.dashboardSource)||void 0===t?void 0:t.templatePackages(c))||[],templatePackage:v,enableWebSocketTransport:p&&"angular"!==c.toLowerCase()})]},"own")]);return Object(Q.jsxs)(Rs,{children:[Object(Q.jsxs)(Ps,{children:["Build your app from one the popular templates below or"," ",Object(Q.jsx)("a",{onClick:function(){return n.setState({createOwnModalVisible:!0})},children:"create your own"})]}),Object(Q.jsx)(Ta.a,{gutter:24,children:g})]})}}]),n}(x.Component),Ls=Object(f.g)(As),Qs=n.p+"static/media/postgres.e67db92e.svg",Is=n.p+"static/media/mysql.376b985e.svg",zs=n.p+"static/media/athena.3d08e54a.svg",Fs=n.p+"static/media/clickhouse.15d7a0f1.svg",Ns=n.p+"static/media/hive.b33891fc.svg",Bs=n.p+"static/media/redshift.b80154fa.svg",_s=n.p+"static/media/presto.bf9e7a80.svg",Us=n.p+"static/media/snowflake.7e110f33.svg",Vs=n.p+"static/media/oracle.e2b7363b.svg",Ys=n.p+"static/media/mssql.7dc54d0e.svg",Js=n.p+"static/media/bigquery.47cbd6db.svg",Ks=n.p+"static/media/mongodb.23376a66.svg",Hs=n.p+"static/media/druid.7ac8cbb7.svg",Ws=[{env:"CUBEJS_DB_HOST",title:"Hostname"},{env:"CUBEJS_DB_PORT",title:"Port"}],Gs=[{env:"CUBEJS_DB_USER",title:"Username"},{env:"CUBEJS_DB_PASS",title:"Password"}],$s={env:"CUBEJS_DB_NAME",title:"Database"},Zs=[{databases:[{title:"PostgreSQL",driver:"postgres",logo:Qs},{title:"MySQL",driver:"mysql",logo:Is},{title:"AWS Redshift",driver:"redshift",logo:Bs},{title:"ClickHouse",driver:"clickhouse",logo:Fs},{title:"Hive/SparkSQL",driver:"hive",logo:Ns},{title:"Oracle",driver:"oracle",logo:Vs}],settings:[].concat(Ws,[$s],Gs)},{databases:[{title:"MS SQL",driver:"mssql",logo:Ys}],settings:[].concat(Ws,Gs,[$s,{env:"CUBEJS_DB_DOMAIN",title:"Domain Name"}])},{databases:[{title:"AWS Athena",driver:"athena",logo:zs,instructions:'\nSpecify the AWS access and secret keys with the <a href="https://docs.aws.amazon.com/athena/latest/ug/security-iam-athena.html" target="_blank">access necessary to run Athena queries</a>, \nand the target AWS region and <a href="https://docs.aws.amazon.com/athena/latest/ug/querying.html" target="_blank">S3 output location</a> where query results are stored.\n    '}],settings:[{env:"CUBEJS_AWS_KEY",title:"AWS Access Key ID"},{env:"CUBEJS_AWS_SECRET",title:"AWS Secret Access Key"},{env:"CUBEJS_AWS_REGION",title:"AWS Region"},{env:"CUBEJS_AWS_S3_OUTPUT_LOCATION",title:"S3 Output Location"}]},{databases:[{title:"Google Bigquery",driver:"bigquery",logo:Js,instructions:"\nUpload a service account JSON keyfile to connect to BigQuery.<br/>Alternatively, you can encode the key file with base64 and specify it manually.\n    "}],settings:[{env:"CUBEJS_DB_BQ_KEY_FILE",title:"Upload a Service Account JSON file",type:"base64upload",uploadTarget:"CUBEJS_DB_BQ_CREDENTIALS",extractField:{jsonField:"project_id",formField:"CUBEJS_DB_BQ_PROJECT_ID"}},{env:"CUBEJS_DB_BQ_PROJECT_ID",title:"Project ID"},{env:"CUBEJS_DB_BQ_CREDENTIALS",title:"Encoded Key File"}]},{databases:[{title:"MongoDB",driver:"mongobi",logo:Ks}],settings:[].concat(Ws,Gs,[$s])},{databases:[{title:"Snowflake",driver:"snowflake",logo:Us}],settings:[].concat(Gs,[$s,{env:"CUBEJS_DB_SNOWFLAKE_ACCOUNT",title:"Account"},{env:"CUBEJS_DB_SNOWFLAKE_REGION",title:"Region"},{env:"CUBEJS_DB_SNOWFLAKE_WAREHOUSE",title:"Warehouse"},{env:"CUBEJS_DB_SNOWFLAKE_ROLE",title:"Role"}])},{databases:[{title:"Presto",driver:"prestodb",logo:_s}],settings:[].concat(Ws,Gs,[{env:"CUBEJS_DB_CATALOG",title:"Catalog"},{env:"CUBEJS_DB_SCHEMA",title:"Schema"}])},{databases:[{title:"Druid",driver:"druid",logo:Hs}],settings:[{env:"CUBEJS_DB_URL",title:"URL"}].concat(Gs)}],Xs=n(154);function ec(e){var t=e.loading,n=e.result;return t?Object(Q.jsxs)(ne.b,{align:"center",size:"middle",children:[Object(Q.jsx)(ea.a,{"data-testid":"wizard-test-connection-spinner"}),Object(Q.jsx)(V.a.Text,{children:"Testing database connection"})]}):(null===n||void 0===n?void 0:n.success)?Object(Q.jsxs)(V.a.Text,{type:"success",children:[Object(Q.jsx)(Xs.a,{}),"\xa0\xa0Connection successful"]}):(null===n||void 0===n?void 0:n.error)?Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(V.a.Text,{type:"danger",children:"We couldn\u2019t connect. Please double check the provided data and try again"}),Object(Q.jsx)(S.a,{"data-testid":"wizard-connection-error",style:{marginTop:20},message:"Runtime Error",type:"error",description:Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)("p",{style:{paddingLeft:20},children:"Cube.js was unable to connect to the specified database."}),Object(Q.jsx)("p",{style:{paddingLeft:20},children:"The database returned the following error:"}),Object(Q.jsx)("br",{}),Object(Q.jsx)("p",{style:{paddingLeft:40},children:">Database Error"}),Object(Q.jsx)("p",{style:{paddingLeft:40},children:n.error.toString()}),Object(Q.jsx)("br",{}),Object(Q.jsx)("p",{children:"Check your database credentials and try again. For more information, visit:"}),Object(Q.jsx)("a",{href:"https://cube.dev/docs/connecting-to-the-database",target:"_blank",children:"https://cube.dev/docs/connecting-to-the-database"})]})})]}):null}var tc,nc=n(838);function rc(e){var t=e.db;return Object(Q.jsx)(U.a,{"data-testid":"wizard-db-card",children:Object(Q.jsxs)(Ta.a,{align:"middle",justify:"space-between",children:[Object(Q.jsx)(Da.a,{flex:"40px",children:Object(Q.jsx)(nc.a,{src:t.logo,preview:!1})}),Object(Q.jsx)(Da.a,{children:Object(Q.jsx)(V.a.Text,{strong:!0,children:t.title})})]})})}var ac=D.b.div(tc||(tc=Object(O.a)(["\n  background-color: #f8f8f9;\n  padding: 15px 20px;\n  border-radius: 4px;\n"])));function ic(e){var t=e.db;return Object(Q.jsx)(ac,{children:Object(Q.jsxs)(Ta.a,{align:"middle",justify:"space-between",children:[Object(Q.jsx)(Da.a,{flex:"40px",children:Object(Q.jsx)(nc.a,{src:t.logo,preview:!1})}),Object(Q.jsx)(Da.a,{children:Object(Q.jsx)(V.a.Text,{strong:!0,children:t.title})})]})})}var oc,sc,cc=n(837),uc=n(872),lc=["onInput"],dc=V.a.Text;function bc(e){var t=e.onInput,n=(Object(b.a)(e,lc),Object(x.useState)("")),r=Object(B.a)(n,2),a=r[0],i=r[1],o=Object(x.useState)(""),s=Object(B.a)(o,2),c=s[0],u=s[1],d={name:"file",headers:{authorization:"authorization-text"},accept:"application/json, .json",beforeUpload:function(e){var n=new FileReader;return n.onload=function(e){var n="",r=e.target.result.toString();try{JSON.parse(r),n=btoa(r)}catch(a){u("Invalid JSON file"),console.error(a)}t&&t({encoded:n,raw:JSON.parse(r)})},n.readAsText(e),!1},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?i(e.file.name):"error"===e.file.status&&(console.log("".concat(e.file.name," file upload failed.")),u("Invalid file"))},onRemove:function(){u("")}};return Object(Q.jsxs)(ne.b,{direction:"vertical",children:[Object(Q.jsx)(cc.a,Object(l.a)(Object(l.a)({},d),{},{children:Object(Q.jsx)(Y.a,{icon:Object(Q.jsx)(uc.a,{}),children:"Choose file"})})),a||c?null:Object(Q.jsx)(dc,{type:"secondary",children:"No file selected"}),c&&Object(Q.jsx)(dc,{type:"danger",children:c})]})}function pc(e){var t=e.db,n=e.deployment,r=e.loading,a=void 0!==r&&r,i=e.disabled,o=void 0!==i&&i,s=e.hostname,c=void 0===s?"":s,u=e.onSubmit,l=ee.a.useForm(),d=Object(B.a)(l,1)[0];Object(x.useEffect)((function(){d.setFieldsValue({CUBEJS_DB_HOST:c})}),[c]);var b=(n.envVariables||[]).reduce((function(e,t){return e[t.name]=t.value,e}),{});return Object(Q.jsxs)(ee.a,{"data-testid":"wizard-db-form",form:d,layout:"vertical",onFinish:function(e){e.CUBEJS_DB_TYPE=t.driver,u(e)},initialValues:b,children:[t.settings.map((function(e){return"base64upload"===e.type?Object(Q.jsx)(bc,{onInput:function(t){var n=t.raw,r=t.encoded;e.uploadTarget&&d.setFieldsValue(Object(oe.a)({},e.uploadTarget,r)),e.extractField&&d.setFieldsValue(Object(oe.a)({},e.extractField.formField,n[e.extractField.jsonField]))}}):Object(Q.jsx)(ee.a.Item,{label:e.title||e.env,name:e.env,children:e.title?"CUBEJS_DB_PASS"===e.env?Object(Q.jsx)(X.a.Password,{"data-testid":e.env}):Object(Q.jsx)(X.a,{"data-testid":e.env}):Object(Q.jsx)(X.a.TextArea,{"data-testid":e.env,rows:1,style:{overflow:"hidden",resize:"none"}})},e.env)})),Object(Q.jsx)(Y.a,{"data-testid":"wizard-form-submit-btn",type:"primary",htmlType:"submit",loading:a,disabled:o,children:"Apply"})]})}var hc,fc,mc=Object(D.b)(S.a)(oc||(oc=Object(O.a)(["\n  border: none;\n  padding: 16px;\n"]))),jc=Object(D.b)(ee.a)(sc||(sc=Object(O.a)(["\n  .ant-form-item {\n    margin-bottom: 20px;\n  }\n\n  .ant-form-item:last-child {\n    margin-bottom: 0;\n  }\n\n  .ant-form-item-label {\n    padding-bottom: 4px;\n  }\n"])));function vc(e){var t=e.onHostnameCopy;return Object(Q.jsx)(mc,{"data-testid":"wizard-localhost-tipbox",type:"warning",message:Object(Q.jsxs)(ne.b,{direction:"vertical",size:"middle",children:[Object(Q.jsxs)(V.a.Text,{children:["To connect to the database running on the localhost use the following ",Object(Q.jsx)("b",{children:"hostname"})," value"]}),Object(Q.jsxs)(jc,{children:[Object(Q.jsx)(Fn,{label:"Mac",value:"host.docker.internal",onCopyClick:t}),Object(Q.jsx)(Fn,{label:"Windows",value:"host.docker.internal",onCopyClick:t}),Object(Q.jsx)(Fn,{label:"Linux",value:"localhost",onCopyClick:t}),Object(Q.jsxs)(ne.b,{direction:"vertical",size:"middle",children:[Object(Q.jsxs)(V.a.Text,{children:["Please note, for Linux, you need to run Cube.js Docker container in the"," ",Object(Q.jsx)(V.a.Link,{href:"https://docs.docker.com/network/host/",target:"_blank",children:'network mode "host"'})," ","to be able to connect to the database running on localhost."]}),Object(Q.jsx)(Fn,{value:"docker run --network host",onCopyClick:function(e){return he(e)}})]})]})]})})}var gc=V.a.Title,yc=V.a.Paragraph,Oc="installing",xc="installed",kc=D.b.div(hc||(hc=Object(O.a)(["\n  cursor: pointer;\n"]))),wc=D.b.div(fc||(fc=Object(O.a)(["\n  width: auto;\n  min-height: 100vh;\n  max-width: 960px;\n  padding: 48px 24px;\n  margin: 0 auto;\n  background-color: #fff;\n"]))),Sc=Zs.reduce((function(e,t){var n=t.databases,r=t.settings;return[].concat(Object(bn.a)(e),Object(bn.a)(n.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{settings:r})}))))}),[]);function Cc(e){return Dc.apply(this,arguments)}function Dc(){return(Dc=Object(d.a)(u.a.mark((function e(t){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe("/playground/test-connection",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:t})},5e3);case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,!(a=r.error)){e.next=9;break}throw new Error(a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tc(e){return Ec.apply(this,arguments)}function Ec(){return(Ec=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/env",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:t})});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rc(e){var t=e.history,n=En(),r=Object(x.useState)(""),a=Object(B.a)(r,2),i=a[0],o=a[1],s=Object(x.useState)(!1),c=Object(B.a)(s,2),l=c[0],b=c[1],p=Object(x.useState)(!1),h=Object(B.a)(p,2),f=h[0],m=h[1],j=Object(x.useState)(null),v=Object(B.a)(j,2),g=v[0],y=v[1],O=Object(x.useState)(null),k=Object(B.a)(O,2),w=k[0],C=k[1],D=Object(x.useState)(!1),T=Object(B.a)(D,2),E=T[0],R=T[1],q=Object(x.useState)(null),M=Object(B.a)(q,2),P=M[0],A=M[1],L=Object(x.useState)(null),I=Object(B.a)(L,2),z=I[0],F=I[1];function N(e){return Object(d.a)(u.a.mark((function t(){var r,a,i,o,s,c,l,d;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null===n||void 0===n?void 0:n.isDocker)){t.next=2;break}return t.abrupt("return",C(e));case 2:return t.next=4,fetch("/playground/driver?driver=".concat(e.driver||""));case 4:return r=t.sent,t.next=7,r.json();case 7:if(a=t.sent,i=a.status,o=a.error,!r.ok){t.next=18;break}if(i!==xc){t.next=15;break}return t.abrupt("return",C(e));case 15:i===Oc&&(R(!0),C(e));case 16:t.next=19;break;case 18:F(o);case 19:return t.next=21,fetch("/playground/driver",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({driver:e.driver})});case 21:return s=t.sent,t.next=24,s.json();case 24:c=t.sent,l=c.dependency,d=c.error,s.ok?(A(l),R(!0),C(e)):F(d);case 28:case"end":return t.stop()}}),t)})))}return Object(x.useEffect)((function(){Ur("connection_wizard_open")}),[]),Object(x.useLayoutEffect)((function(){(null===n||void 0===n?void 0:n.dbType)&&!(null===n||void 0===n?void 0:n.isDocker)&&C(Sc.find((function(e){return e.driver.toLowerCase()===n.dbType}))||null)}),[n]),Object(x.useEffect)((function(){var e;return E&&w&&(e=function(e,t,n,r){var a=0,i=!1;function o(){i=!0}function s(){return c.apply(this,arguments)}function c(){return(c=Object(d.a)(u.a.mark((function c(){var l;return u.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ue()(e,r);case 2:l=c.sent,i||(n({response:l,cancel:o,retries:a}),setTimeout(s,t)),a++;case 5:case"end":return c.stop()}}),c)})))).apply(this,arguments)}return s(),{cancel:o,retries:a}}("/playground/driver?driver=".concat(w.driver),1e3,function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r,a,i,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.response,r=t.cancel,e.next=3,n.json();case 3:a=e.sent,i=a.status,o=a.error,n.ok&&i===xc&&(r(),R(!1)),n.ok||(r(),R(!1),F(o));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),function(){var t;w&&(null===(t=e)||void 0===t||t.cancel())}}),[w,E]),Object(x.useEffect)((function(){m(!1),y(null),F(null),o("")}),[null===w||void 0===w?void 0:w.driver]),z?Object(Q.jsx)(wc,{children:Object(Q.jsx)(jr,{error:z})}):E&&P?Object(Q.jsxs)(wc,{children:[Object(Q.jsx)(gc,{children:"Set Up a Database connection"}),Object(Q.jsxs)(ne.b,{align:"center",size:"middle",children:[Object(Q.jsx)(ea.a,{}),Object(Q.jsxs)(V.a.Text,{children:["Installing ",Object(Q.jsx)("b",{children:P})]})]})]}):Object(Q.jsxs)(wc,{children:[Object(Q.jsx)(gc,{children:"Set Up a Database connection"}),w?Object(Q.jsx)(Q.Fragment,{children:Object(Q.jsxs)(ne.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(Q.jsxs)(ne.b,{size:"middle",children:[Object(Q.jsx)(ic,{db:w}),Object(Q.jsx)(gr,{"data-testid":"wizard-change-db-btn",type:"link",onClick:function(){return C(null)},children:"Change"})]}),Object(Q.jsxs)(V.a,{children:[w.instructions?Object(Q.jsx)("div",{dangerouslySetInnerHTML:{__html:w.instructions}}):Object(Q.jsxs)(V.a.Paragraph,{children:["Enter database credentials to connect to your database. ",Object(Q.jsx)("br",{}),"Cube.js will store your credentials into the ",Object(Q.jsx)("code",{children:".env"})," ","file for future use."]}),Object(Q.jsx)(S.a,{type:"info",message:Object(Q.jsxs)(Q.Fragment,{children:["For advanced configuration, use the ",Object(Q.jsx)("b",{children:"cube.js"})," or"," ",Object(Q.jsx)("b",{children:".env"})," configuration files in your cube.js project. Note these files are on the mount volume if you are running Docker.",Object(Q.jsx)("br",{}),Object(Q.jsx)(V.a.Link,{href:"https://cube.dev/docs/connecting-to-the-database",target:"_blank",children:"Learn more about connecting to databases in the documentation."})]})}),"MongoDB"===w.title?Object(Q.jsx)(S.a,{message:"The MongoDB Connector for BI is required to connect to MongoDB.",type:"info"}):null]}),Object(Q.jsxs)(Ta.a,{gutter:[40,12],children:[Object(Q.jsx)(Da.a,{span:12,children:Object(Q.jsxs)(ne.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(Q.jsx)(pc,{db:w,deployment:{},loading:l,disabled:f,hostname:i,onSubmit:function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y(null),m(!0),e.next=5,Cc(n);case 5:return y({success:!0}),b(!0),e.next=9,Tc(n);case 9:b(!1),_r("test_database_connection_success:frontend",{database:w.title}),t.push("/schema"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),y({success:!1,error:e.t0}),_r("test_database_connection_error:frontend",{error:e.t0.message||e.t0.toString(),database:w.title});case 18:m(!1);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}()}),Object(Q.jsx)(ec,{loading:f,result:g})]})}),["MySQL","PostgreSQL","Druid","ClickHouse"].includes((null===w||void 0===w?void 0:w.title)||"")&&(null===n||void 0===n?void 0:n.isDocker)?Object(Q.jsx)(Da.a,{span:12,children:Object(Q.jsx)(vc,{onHostnameCopy:o})}):null]})]})}):Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(yc,{children:"Select a database type"}),Object(Q.jsx)(Ta.a,{gutter:[12,12],children:Sc.map((function(e){return Object(Q.jsx)(Da.a,{xl:8,lg:8,md:12,sm:24,xs:24,children:Object(Q.jsx)(kc,{onClick:N(e),children:Object(Q.jsx)(rc,{db:e})})},e.title)}))})]})]})}var qc,Mc=n(873),Pc=Z.a.TabPane,Ac=Object(D.b)(Z.a)(qc||(qc=Object(O.a)(["\n  & .ant-tabs-nav {\n    background: #fff;\n    padding: 12px 16px 0;\n    margin: 0;\n  }\n\n  & .ant-tabs-extra-content {\n    margin-left: 32px;\n  }\n"])));function Lc(e){var t=e.query,n=e.children,r=e.sidebar,a=void 0===r?null:r,i=e.onTabChange,o=Qo(),s=o.setChartRendererReady,c=o.setQueryStatus,u=o.setQueryError,d=o.setResultSetExists,b=o.setQueryLoading,p=o.setBuildInProgress,h=o.setSlowQuery,f=o.setSlowQueryFromCache,m=Object(x.useState)(!1),j=Object(B.a)(m,2),v=j[0],g=j[1],y=qn("queryTabs",{activeId:"1",tabs:[{id:"1",query:t||{}}]}),O=Object(B.a)(y,2),k=O[0],w=O[1];Object(x.useEffect)((function(){!k.activeId&&k.length>0&&w({activeId:k[0].id,tabs:k})}),[k]),Object(x.useEffect)((function(){window.__cubejsPlayground=Object(l.a)(Object(l.a)({},window.__cubejsPlayground),{},{forQuery:function(e){return{onChartRendererReady:function(){s(e,!0)},onQueryStart:function(){b(e,!0)},onQueryLoad:function(t){var n,r=t.resultSet,a=t.error;if(r){var i,o=r.serialize().loadResponse,s=o.results[0]||{},p=s.external,m=s.dbType,j=s.extDbType,v=s.usedPreAggregations,g=void 0===v?{}:v;f(e,Boolean(o.slowQuery)),Boolean(o.slowQuery)&&h(e,!1),d(e,!0),n=Object.keys(g).length>0,_r(n?"load_request_success_aggregated:frontend":"load_request_success:frontend",Object(l.a)(Object(l.a)({dbType:m},n?{external:p}:null),p?{extDbType:j}:null));var y=r.serialize(),O=Object(B.a)(y.loadResponse.results,1)[0],x=null===(i=Object.values(O.usedPreAggregations||{})[0])||void 0===i?void 0:i.type,k=O.transformedQuery;c(e,{resultSet:r,error:a,isAggregated:n,preAggregationType:x,transformedQuery:k,extDbType:j,external:p})}a&&(c(e,null),u(e,a)),(r||a)&&b(e,!1)},onQueryProgress:function(t){var n,r;p(e,Boolean(null===t||void 0===t||null===(n=t.stage)||void 0===n?void 0:n.stage.includes("pre-aggregation")));var a=(null===t||void 0===t||null===(r=t.stage)||void 0===r?void 0:r.stage.includes("Executing query"))&&(t.stage.timeElapsed||0)>=5e3;h(e,a),a&&f(e,!1)}}}})}),[]),Object(x.useEffect)((function(){if(!v){var e=k.tabs.find((function(e){return e.id===k.activeId}));if(t&&!W()(null===e||void 0===e?void 0:e.query,t)){var n=D();w({activeId:n,tabs:[].concat(Object(bn.a)(k.tabs),[{id:n,query:t}])})}g(!0)}}),[v]),Object(x.useEffect)((function(){if(v&&k.activeId){var e=k.tabs.find((function(e){return e.id===k.activeId}));e&&(null===i||void 0===i||i(e))}}),[v,k.activeId]);var S=k.activeId,C=k.tabs;function D(){for(var e=C.map((function(e){return e.id})),t=1;t<=C.length+1;t++)if(!e.includes(t.toString()))return t.toString();return(C.length+1).toString()}function T(e){w(Object(l.a)(Object(l.a)({},k),{},{tabs:C.map((function(t){return S===t.id?Object(l.a)(Object(l.a)({},t),e):t}))}))}return v&&k.activeId?Object(Q.jsx)(Ac,{"data-testid":"query-tabs",activeKey:S,type:"editable-card",tabBarExtraContent:{right:a},hideAdd:!1,onChange:function(e){w({activeId:e,tabs:C})},onEdit:function(e){if("string"===typeof e){var t=Number.MAX_VALUE,n=C.filter((function(n,r){var a=n.id;return a===e&&(t=r),a!==e}));w({activeId:n[Math.min(t,n.length-1)].id,tabs:n})}else{var r=D();w({activeId:r,tabs:[].concat(Object(bn.a)(C),[{id:r,query:{}}])})}},children:C.map((function(e){return Object(Q.jsx)(Pc,{"data-testid":"query-tab-".concat(e.id),tab:"Query ".concat(e.id),closable:C.length>1,children:n(e,T)},e.id)}))}):null}var Qc,Ic=["apiUrl","token","dashboardSource"],zc=Object(D.b)(U.a)(Qc||(Qc=Object(O.a)(["\n  border-radius: 0;\n  border-bottom: 1px;\n  min-height: 100%;\n  background: var(--layout-body-background);\n\n  & .ant-card-body {\n    padding: 0;\n  }\n"])));function Fc(e){var t=e.apiUrl,n=e.token,r=e.dashboardSource,a=Object(b.a)(e,Ic),i=Object(f.f)(),o=i.location,s=i.push,c=new URLSearchParams(o.search),u=JSON.parse(c.get("query")||"null"),d=Ce(),p=d.token,h=d.setIsModalOpen,m=(xn(),p||n);Object(x.useLayoutEffect)((function(){t&&m&&(window.__cubejsPlayground=Object(l.a)(Object(l.a)({},window.__cubejsPlayground),{},{apiUrl:t,token:m}))}),[t,m]);var j=function(e,t){return Object(x.useMemo)((function(){return t&&e&&"undefined"!==t?dn(t,{apiUrl:e}):null}),[e,t])}(t,m);return Object(Q.jsx)(ai,{cubejsApi:j,children:Object(Q.jsx)(Ao,{children:Object(Q.jsx)(zc,{bordered:!1,children:Object(Q.jsx)(Lc,{query:u,sidebar:Object(Q.jsx)(ne.b,{direction:"horizontal",children:Object(Q.jsxs)(gr,{"data-testid":"security-context-btn",icon:Object(Q.jsx)(Mc.a,{}),size:"small",type:p?"primary":"default",onClick:function(){return h(!0)},children:[p?"Edit":"Add"," Security Context"]})}),onTabChange:function(e){var t=e.query;window.location.hash.includes("/build")&&s({search:"?query=".concat(JSON.stringify(t))})},children:function(e,n){var i=e.id,o=e.query,s=e.chartType;return Object(Q.jsx)(Es,{queryId:i,apiUrl:t,cubejsToken:m,initialVizState:{query:o,chartType:s},dashboardSource:r,schemaVersion:a.schemaVersion,onVizStateChanged:function(e){var t;n({query:e.query||{},chartType:e.chartType}),null===(t=a.onVizStateChanged)||void 0===t||t.call(a,e)}})}})})})})}function Nc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/cubejs-api";return"".concat(e).concat(t,"/v1")}function Bc(){var e=Object(f.f)().push,t=Object(x.useMemo)((function(){return new na}),[]),n=xn(),r=Tn(),a=r.apiUrl,i=r.token,o=r.schemaVersion,s=r.setContext,c=r.playgroundContext,u=Ce().token,l=c.basePath,d=c.cubejsToken;return An((function(){if(!l||null!==n&&n.statusLivePreview.active){if((null===n||void 0===n?void 0:n.statusLivePreview.active)&&n.credentials){var e=n.credentials,t=e.token,r=e.apiUrl;s({apiUrl:Nc(r,l),token:t})}}else s({token:u||d,apiUrl:Nc(window.location.href.split("#")[0].replace(/\/$/,""),l)})}),[l,n,d,u]),Object(Q.jsx)(Fc,{apiUrl:a,token:i,schemaVersion:o,dashboardSource:t,onVizStateChanged:function(t){var n=t.query;e("/build?query=".concat(JSON.stringify(n)))}})}var _c=["search"],Uc=Object(m.b)();function Vc(e,t){return Yc.apply(this,arguments)}function Yc(){return(Yc=Object(d.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=2;break}return e.abrupt("return",n);case 2:return e.next=4,fetch("/playground/token",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:t})});case 4:return r=e.sent,e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",a.token);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Uc.listen((function(e){e.search;!function(e){var t;null===(t=Fr)||void 0===t||t(Object(l.a)({event:"page"},e),Mr)}(Object(b.a)(e,_c))})),"3080"===window.location.port&&window.location.pathname.includes("/playground/live-preview/start")&&fetch(window.location.pathname).then((function(){return window.close()})),h.a.render(Object(Q.jsx)(f.c,{history:Uc,children:Object(Q.jsx)(Cn,{playgroundContext:{isCloud:!1},children:Object(Q.jsxs)(Xr,{children:[Object(Q.jsx)(f.b,{exact:!0,path:"/",component:function(){var e=Object(f.f)().push,t=Mn(),n=En(),r=Object(x.useState)(null),a=Object(B.a)(r,2),i=a[0],o=a[1];return Object(x.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.a)("/playground/files");case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,t()&&o(r.files);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(x.useLayoutEffect)((function(){n&&null!=i&&(n.shouldStartConnectionWizardFlow?e("/connection"):!i.length||1===i.length&&"Orders.js"===i[0].fileName?e("/schema"):e("/build"))}),[n,i]),null}},"index"),Object(Q.jsx)(f.b,{path:"/build",component:function(e){return Object(Q.jsx)(Se,{onTokenPayloadChange:Vc,children:Object(Q.jsx)(Bc,Object(l.a)({},e))})}},"build"),Object(Q.jsx)(f.b,{path:"/schema",component:Ca},"schema"),Object(Q.jsx)(f.b,{path:"/connection",component:function(){return Object(Q.jsx)(Rc,{history:Uc})}},"connection"),Object(Q.jsx)(f.b,{path:"/dashboard",component:oa},"dashboard"),Object(Q.jsx)(f.b,{path:"/template-gallery",component:Ls},"template-gallery")]})})}),document.getElementById("playground-root"))}},[[819,1,2]]]);